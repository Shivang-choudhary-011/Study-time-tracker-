<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sambhav's Personal Study Tracker - Judiciary Exam Preparation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Lato:ital,wght@0,400;0,700;1,400&family=Playfair+Display:ital@1&family=Raleway:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  --color-bg-1: rgba(59, 130, 246, 0.08);
  --color-bg-2: rgba(245, 158, 11, 0.08);
  --color-bg-3: rgba(34, 197, 94, 0.08);
  --color-bg-4: rgba(239, 68, 68, 0.08);
  --color-bg-5: rgba(147, 51, 234, 0.08);
  --color-bg-6: rgba(249, 115, 22, 0.08);
  --color-bg-7: rgba(236, 72, 153, 0.08);
  --color-bg-8: rgba(6, 182, 212, 0.08);

  --color-background: #E3F2FD;
  --color-surface: #FFFFFF;
  --color-text: #333333;
  --color-text-secondary: #666666;
  --color-primary: #2196F3;
  --color-primary-hover: #1976D2;
  --color-primary-active: #1565C0;
  --color-secondary: #F0F8FF;
  --color-secondary-hover: #E1F5FE;
  --color-secondary-active: #B3E5FC;
  --color-border: rgba(33, 150, 243, 0.3);
  --color-btn-primary-text: #FFFFFF;
  --color-card-border: rgba(0, 0, 0, 0.1);
  --color-card-border-inner: rgba(0, 0, 0, 0.05);
  --color-error: #F44336;
  --color-success: #4CAF50;
  --color-warning: #FF9800;
  --color-info: #2196F3;
  --color-focus-ring: rgba(33, 150, 243, 0.3);

  --font-family-base: 'Lato', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-family-heading: 'Poppins', sans-serif;
  --font-family-decorative: 'Playfair Display', serif;
  --font-family-accent: 'Raleway', sans-serif;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;

  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-10: 10px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);

  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: var(--font-family-base);
    background: linear-gradient(135deg, #E3F2FD 0%, #F3E5F5 100%);
    color: var(--color-text);
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: var(--space-16);
    position: relative;
    z-index: 1;
}

.page {
    display: none;
}

.page.active {
    display: block;
    animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.header {
    text-align: center;
    padding: var(--space-24) var(--space-16);
    background: var(--color-surface);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-card-border);
    margin-bottom: var(--space-24);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.header h1 {
    font-size: var(--font-size-4xl);
    font-weight: 700;
    color: var(--color-primary);
    margin-bottom: var(--space-8);
    font-family: var(--font-family-heading);
}

.datetime {
    font-size: var(--font-size-lg);
    color: var(--color-text-secondary);
    margin-top: var(--space-8);
}

.premium-card {
    background: var(--color-surface);
    padding: 28px;
    border-radius: 16px;
    border: 1px solid var(--color-card-border);
    min-height: 180px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.premium-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
}

.quote-card {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(147, 51, 234, 0.08) 100%);
}

.shloka-card {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.08) 0%, rgba(249, 115, 22, 0.08) 100%);
}

.funfact-card {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(6, 182, 212, 0.08) 100%);
}

.card-glow {
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.6s ease;
    pointer-events: none;
}

.premium-card:hover .card-glow {
    opacity: 1;
}

.quote-section {
    background: var(--color-surface);
    padding: var(--space-20);
    border-radius: var(--radius-md);
    border: 1px solid var(--color-card-border);
    margin-bottom: var(--space-20);
    min-height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transition: opacity 0.5s ease-in-out;
}

.quote-text {
    font-size: var(--font-size-xl);
    font-style: italic;
    color: var(--color-text);
    line-height: 1.6;
}

@keyframes flowerBurst {
    0% {
        opacity: 0;
        transform: translate(0, 0) scale(0.5);
    }
    50% {
        opacity: 1;
    }
    100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(1.2) rotate(360deg);
    }
}

.flower-petal {
    position: fixed;
    width: 20px;
    height: 20px;
    border-radius: 50% 0;
    pointer-events: none;
    z-index: 10000;
    animation: flowerBurst 2s ease-out forwards;
}

@keyframes fadeOut {
    from { opacity: 1; transform: scale(1); }
    to { opacity: 0; transform: scale(0.95); }
}

@keyframes fadeIn {
    from { opacity: 0; transform: scale(1.05); }
    to { opacity: 1; transform: scale(1); }
}

.fade-out {
    animation: fadeOut 0.8s ease-out forwards;
}

.fade-in {
    animation: fadeIn 0.8s ease-out forwards;
}

.shloka-text {
    font-size: var(--font-size-lg);
    color: var(--color-warning);
    margin-bottom: var(--space-8);
    font-weight: var(--font-weight-medium);
}

.shloka-translation {
    font-size: var(--font-size-base);
    color: var(--color-text-secondary);
    font-style: italic;
}

.nav-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--space-16);
    margin-top: var(--space-24);
}

.nav-button {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-md);
    padding: var(--space-24);
    cursor: pointer;
    transition: all 0.6s ease-out;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.nav-button:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 16px rgba(33, 150, 243, 0.2);
    border-color: var(--color-primary);
    background: var(--color-secondary);
}

.nav-button h3 {
    font-size: var(--font-size-2xl);
    color: var(--color-primary);
    margin-bottom: var(--space-8);
    font-family: var(--font-family-heading);
    font-weight: 700;
}

.nav-button p {
    color: var(--color-text-secondary);
    font-size: var(--font-size-base);
}

.btn {
    padding: var(--space-12) var(--space-24);
    border: none;
    border-radius: var(--radius-base);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all 0.6s ease-out;
    display: inline-flex;
    align-items: center;
    gap: var(--space-8);
}

.btn-primary {
    background: var(--color-primary);
    color: var(--color-btn-primary-text);
}

.btn-primary:hover {
    background: var(--color-primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
}

.btn-secondary {
    background: var(--color-secondary);
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.btn-secondary:hover {
    background: var(--color-secondary-hover);
    transform: translateY(-1px);
}

.btn-back {
    margin-bottom: var(--space-20);
}

.subject-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--space-16);
    margin-top: var(--space-20);
}

.subject-card {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-lg);
    padding: var(--space-20);
    cursor: pointer;
    transition: all 0.6s ease-out;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.subject-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 16px rgba(33, 150, 243, 0.2);
    border-color: var(--color-primary);
}

.subject-name-editable:hover {
    background: var(--color-secondary);
    outline: 2px dashed var(--color-primary);
    outline-offset: 2px;
}

.subject-card h3 {
    color: var(--color-primary);
    margin-bottom: var(--space-12);
    font-size: var(--font-size-xl);
    font-family: var(--font-family-heading);
    font-weight: 700;
}

.subject-info {
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    margin-bottom: var(--space-8);
}

.progress-bar-container {
    margin-top: var(--space-16);
    background: rgba(0, 0, 0, 0.3);
    border-radius: var(--radius-full);
    height: 24px;
    overflow: hidden;
    border: 1px solid var(--color-border);
    position: relative;
}

.progress-bar {
    height: 100%;
    border-radius: var(--radius-full);
    transition: all 0.8s ease-out;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-bold);
    position: relative;
    overflow: visible;
}

.progress-bar.high {
    background: linear-gradient(90deg, #4CAF50 0%, #66BB6A 100%);
    box-shadow: 0 0 15px rgba(76, 175, 80, 0.8), 0 0 30px rgba(76, 175, 80, 0.6);
}

.progress-bar.medium {
    background: linear-gradient(90deg, #FFC107 0%, #FFD54F 100%);
    box-shadow: 0 0 15px rgba(255, 193, 7, 0.8), 0 0 30px rgba(255, 193, 7, 0.6);
}

.progress-bar.low {
    background: linear-gradient(90deg, #F44336 0%, #EF5350 100%);
    box-shadow: 0 0 15px rgba(244, 67, 54, 0.8), 0 0 30px rgba(244, 67, 54, 0.6);
}

.progress-bar.animating {
    animation: waterSplash 0.8s ease-out;
}

@keyframes waterSplash {
    0% { opacity: 0.7; box-shadow: 0 0 10px rgba(76, 175, 80, 0.4); }
    50% { opacity: 1; transform: scaleY(1.05); box-shadow: 0 0 25px rgba(76, 175, 80, 0.8), 0 0 40px rgba(76, 175, 80, 0.6); }
    100% { opacity: 1; transform: scaleY(1); box-shadow: 0 0 15px rgba(76, 175, 80, 0.6), 0 0 30px rgba(76, 175, 80, 0.4); }
}

.firecracker {
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 1000;
}

@keyframes explode {
    0% {
        opacity: 1;
        transform: translate(0, 0) scale(1);
    }
    100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(0.3);
    }
}

.progress-text {
    position: absolute;
    width: 100%;
    text-align: center;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    z-index: 2;
}

.chapter-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-12);
    margin-top: var(--space-20);
}

.chapter-item {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-md);
    padding: var(--space-16);
    transition: all 0.6s ease-out;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
    margin-bottom: var(--space-12);
}

.chapter-item.completed {
    background: rgba(76, 175, 80, 0.1);
    border-color: rgba(76, 175, 80, 0.3);
}

.chapter-header {
    display: flex;
    align-items: center;
    gap: var(--space-12);
    margin-bottom: var(--space-12);
}

.chapter-checkbox {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.chapter-name {
    flex: 1;
    font-size: var(--font-size-base);
    color: var(--color-text);
    font-weight: var(--font-weight-medium);
}

.chapter-date {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.chapter-notes {
    width: 100%;
    padding: var(--space-8);
    background: var(--color-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    color: var(--color-text);
    font-size: var(--font-size-sm);
    resize: vertical;
    min-height: 60px;
    font-family: var(--font-family-base);
}

.action-buttons {
    display: flex;
    gap: var(--space-8);
    margin-top: var(--space-12);
    flex-wrap: wrap;
}

.journal-entry {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-md);
    padding: var(--space-16);
    margin-bottom: var(--space-16);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.chapter-input {
    display: flex;
    align-items: center;
    gap: var(--space-12);
    margin-bottom: var(--space-8);
}

.chapter-number {
    min-width: 40px;
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
}

.chapter-name-input {
    flex: 1;
    padding: var(--space-8);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: var(--color-secondary);
    color: var(--color-text);
    font-size: var(--font-size-sm);
}

.add-chapter-section {
    background: var(--color-secondary);
    padding: var(--space-16);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-20);
    border: 1px dashed var(--color-border);
}

.add-chapter-section input {
    padding: var(--space-8) var(--space-12);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-base);
    margin-right: var(--space-8);
    background: var(--color-surface);
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}

.modal.active {
    display: flex;
}

.modal-content {
    background: var(--color-surface);
    border-radius: var(--radius-lg);
    padding: var(--space-24);
    max-width: 500px;
    width: 90%;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
}

.modal-content h2 {
    color: var(--color-primary);
    margin-bottom: var(--space-16);
}

.form-control {
    width: 100%;
    padding: var(--space-12);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-base);
    margin-bottom: var(--space-12);
    background: var(--color-secondary);
    color: var(--color-text);
}

.delete-subject-btn {
    background: var(--color-error);
    color: white;
    padding: var(--space-4) var(--space-12);
    border: none;
    border-radius: var(--radius-sm);
    font-size: var(--font-size-sm);
    cursor: pointer;
    margin-left: var(--space-8);
}

.journal-textarea {
    width: 100%;
    min-height: 150px;
    padding: var(--space-12);
    background: var(--color-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-base);
    color: var(--color-text);
    font-size: var(--font-size-base);
    font-family: var(--font-family-base);
    resize: vertical;
}

.analytics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-20);
    margin-top: var(--space-20);
}

.analytics-card {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-lg);
    padding: var(--space-20);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.analytics-card h3 {
    color: var(--color-primary);
    margin-bottom: var(--space-16);
    font-size: var(--font-size-xl);
    font-family: var(--font-family-heading);
    font-weight: 700;
}

.stat-value {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-success);
    margin-bottom: var(--space-8);
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: var(--space-4);
    margin-top: var(--space-12);
}

.calendar-day {
    aspect-ratio: 1;
    background: var(--color-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.calendar-day.studied {
    border-color: rgba(76, 175, 80, 0.5);
    color: var(--color-success);
    font-weight: var(--font-weight-bold);
    cursor: pointer;
}

.calendar-day.today {
    border-color: var(--color-primary);
    border-width: 2px;
}

.revision-item {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-md);
    padding: var(--space-16);
    margin-bottom: var(--space-12);
    display: flex;
    align-items: center;
    gap: var(--space-12);
    transition: all var(--duration-normal) var(--ease-standard);
}

.revision-item.completed {
    background: rgba(76, 175, 80, 0.1);
    border-color: rgba(76, 175, 80, 0.3);
    opacity: 0.7;
}

.revision-checkbox {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.revision-content {
    flex: 1;
}

.revision-topic {
    font-size: var(--font-size-base);
    color: var(--color-text);
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-4);
}

.revision-date {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.section-title {
    font-size: var(--font-size-2xl);
    color: var(--color-primary);
    margin-bottom: var(--space-16);
    padding-bottom: var(--space-12);
    border-bottom: 2px solid var(--color-border);
    font-family: var(--font-family-heading);
    font-weight: 700;
}

.empty-state {
    text-align: center;
    padding: var(--space-32);
    color: var(--color-text-secondary);
    font-size: var(--font-size-lg);
}

@media (max-width: 768px) {
    .nav-grid {
        grid-template-columns: 1fr;
    }
    
    .subject-grid {
        grid-template-columns: 1fr;
    }
    
    .analytics-grid {
        grid-template-columns: 1fr;
    }
    
    .header h1 {
        font-size: var(--font-size-3xl);
    }
}
    </style>
</head>
<body>
    <div class="container">
        <!-- HOME PAGE -->
        <div id="home-page" class="page active">
            <div class="header">
                <h1>üìö Sambhav's Personal Study Tracker</h1>
                <p>Your Journey to Judiciary Excellence</p>
                <div id="greeting-time" style="font-size: 18px; color: var(--color-primary); margin: 16px 0; font-weight: 600;"></div>
                <div id="attractive-clock" style="font-size: 64px; font-weight: 700; background: linear-gradient(135deg, #2196F3 0%, #9C27B0 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-shadow: 0 0 30px rgba(33, 150, 243, 0.3); margin: 12px 0;"></div>
                <div id="attractive-date" style="font-size: 20px; color: var(--color-text-secondary); font-weight: 500; margin-bottom: 8px;"></div>
            </div>

            <div class="quote-section">
                <p class="quote-text" id="quote-text"></p>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 32px;" id="three-column-grid">
                <div class="premium-card quote-card" onclick="rotateQuotesManual()">
                    <div class="card-glow"></div>
                    <p class="quote-text" id="quote-text-main" style="font-size: 18px; font-family: var(--font-family-base); line-height: 1.6; font-weight: 400;"></p>
                    <div class="quote-author" id="quote-author-main" style="font-size: 14px; font-family: var(--font-family-decorative); margin-top: 12px; font-style: italic;"></div>
                    <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 12px; opacity: 0.7;">üí¨ Click to change ‚Ä¢ Auto-rotates</div>
                </div>
                <div class="premium-card shloka-card" id="shloka-section">
                    <div class="card-glow"></div>
                    <div class="shloka-text" id="shloka-text" style="font-size: 19px; font-weight: 600; font-family: var(--font-family-heading);"></div>
                    <div class="shloka-translation" id="shloka-translation" style="font-size: 15px; font-family: var(--font-family-base); margin-top: 12px;"></div>
                    <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 12px; opacity: 0.7;">üïâÔ∏è Click to change</div>
                </div>
                <div class="premium-card funfact-card" onclick="rotateFunFacts()">
                    <div class="card-glow"></div>
                    <div style="font-size: 24px; margin-bottom: 12px;">üìö</div>
                    <p class="quote-text" id="fun-fact-text" style="font-size: 17px; font-family: var(--font-family-base); line-height: 1.6; font-weight: 500;"></p>
                    <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 12px; opacity: 0.7;">üí° Fun Fact ‚Ä¢ Click to change</div>
                </div>
            </div>

            <!-- POMODORO ON HOME -->
            <div class="analytics-card" style="margin-bottom: 20px;" id="home-pomodoro-section">
                <h3 style="margin-bottom: 12px;">‚è±Ô∏è Pomodoro Timer</h3>
                <div id="home-pomodoro-display" style="font-size: 48px; font-weight: bold; color: var(--color-primary); text-align: center; margin: 16px 0;">25:00</div>
                <div id="home-pomodoro-status" style="text-align: center; color: var(--color-text-secondary); margin-bottom: 16px;">Ready to focus</div>
                <div style="display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="startPomodoroHome()" id="home-pomodoro-start">‚ñ∂Ô∏è Start</button>
                    <button class="btn btn-secondary" onclick="pausePomodoroHome()" id="home-pomodoro-pause" disabled>‚è∏Ô∏è Pause</button>
                    <button class="btn btn-secondary" onclick="resetPomodoroHome()">üîÑ Reset</button>
                    <button class="btn btn-secondary" onclick="navigateTo('pomodoro')">‚öôÔ∏è Settings</button>
                </div>
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--color-border);">
                    <h4 style="color: var(--color-primary); margin-bottom: 12px;">üìä Daily Study Time</h4>
                    <div style="font-size: 28px; font-weight: bold; color: var(--color-success); text-align: center; margin-bottom: 12px;" id="daily-study-display">0 hrs 0 mins</div>
                    <div style="background: var(--color-bg-2); padding: 12px; border-radius: 8px; margin-bottom: 12px; border: 1px solid var(--color-border);">
                        <div style="font-size: 12px; color: var(--color-text-secondary); margin-bottom: 8px; font-weight: 600;">‚ö° Quick Adjust Time:</div>
                        <input type="text" id="quick-time-adjust" class="form-control" placeholder="Type +50 or -50 (minutes) or +2h / -1h" style="margin-bottom: 8px;">
                        <button class="btn btn-primary" onclick="quickAdjustStudyTime()" style="width: 100%; font-size: 13px;">‚ö° Update Time</button>
                        <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 8px; line-height: 1.4;">
                            üí° Examples: +50 (add 50 min), -30 (reduce 30 min), +2h (add 2 hrs), -1h (reduce 1 hr)
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                        <input type="number" id="manual-study-minutes" class="form-control" placeholder="Minutes" min="1" style="flex: 1;">
                        <select id="manual-study-subject" class="form-control" style="flex: 1;"></select>
                    </div>
                    <button class="btn btn-primary" onclick="addManualStudyTime()" style="width: 100%;">‚ûï Add Study Time</button>
                </div>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h3 style="margin-bottom: 8px;">üî• Study Streak</h3>
                        <div class="stat-value" id="home-streak-display" style="font-size: 32px;">0 days</div>
                        <div style="color: var(--color-text-secondary); font-size: 12px;">Best: <span id="home-best-streak">0</span> days</div>
                    </div>
                    <div style="text-align: right;">
                        <button class="btn btn-secondary" onclick="toggleDarkMode()" style="margin-bottom: 8px;">üåì Toggle Dark Mode</button>
                    </div>
                </div>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3 style="margin-bottom: 12px;">üèÜ Badges</h3>
                <div id="home-badges-display" style="display: flex; gap: 12px; flex-wrap: wrap;"></div>
            </div>

            <div class="nav-grid">
                <div class="nav-button" onclick="navigateTo('chapter-tracking')">
                    <h3>üìñ Chapter Tracking</h3>
                    <p>Track your progress across all subjects</p>
                </div>
                <div class="nav-button" onclick="navigateTo('revision')">
                    <h3>üîÑ Revision Planner</h3>
                    <p>Review and revise completed topics</p>
                </div>
                <div class="nav-button" onclick="navigateTo('analytics')">
                    <h3>üìä Analytics</h3>
                    <p>View your study consistency &amp; progress</p>
                </div>
                <div class="nav-button" onclick="navigateTo('journal')">
                    <h3>üìù Daily Journal</h3>
                    <p>Document your daily study journey</p>
                </div>

                <div class="nav-button" onclick="navigateTo('pomodoro')">
                    <h3>‚è±Ô∏è Pomodoro Timer</h3>
                    <p>Focus sessions with breaks</p>
                </div>
                <div class="nav-button" onclick="navigateTo('habits')">
                    <h3>‚úÖ Daily Habits</h3>
                    <p>Track your daily study habits</p>
                </div>
                <div class="nav-button" onclick="navigateTo('flashcards')">
                    <h3>üìá Quick Notes</h3>
                    <p>Save important study notes</p>
                </div>
                <div class="nav-button" onclick="navigateTo('goals')">
                    <h3>üéØ Study Goals</h3>
                    <p>Set and track your targets</p>
                </div>
                <div class="nav-button" onclick="navigateTo('settings')">
                    <h3>‚öôÔ∏è Settings</h3>
                    <p>Customize your experience</p>
                </div>
                <div class="nav-button" onclick="navigateTo('syllabus')">
                    <h3>üìö Syllabus Tracker</h3>
                    <p>Track your complete exam syllabus</p>
                </div>
            </div>
        </div>

        <!-- CHAPTER TRACKING PAGE -->
        <div id="chapter-tracking-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>üìñ Chapter Tracking</h1>
                <p>Track your progress across all subjects</p>
            </div>

            <div id="subject-list" class="subject-grid"></div>
        </div>

        <!-- SUBJECT DETAIL PAGE -->
        <div id="subject-detail-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateTo('chapter-tracking')">‚Üê Back to Subjects</button>
            <div class="header">
                <h1 id="subject-title" style="font-family: var(--font-family-heading); font-weight: 700;"></h1>
                <div class="progress-bar-container">
                    <div class="progress-bar low" id="subject-progress-bar" style="width: 0%;"></div>
                    <div class="progress-text" id="subject-progress-text">0%</div>
                </div>
            </div>
            <div class="add-chapter-section">
                <h3 style="color: var(--color-primary); margin-bottom: 12px; font-family: var(--font-family-heading); font-weight: 700;">Add Chapters</h3>
                <input type="number" id="num-chapters" placeholder="Enter number of chapters" min="1" style="width: 200px;">
                <button class="btn btn-primary" onclick="addBulkChapters()">Add Multiple Chapters</button>
                <button class="btn btn-secondary" onclick="addSingleChapter()" style="margin-left: 8px;">Add One Chapter</button>
            </div>
            <div id="chapter-list" class="chapter-list"></div>
        </div>



        <!-- REVISION PAGE -->
        <div id="revision-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>üîÑ Revision Planner</h1>
                <p>Review your completed topics</p>
                <div class="progress-bar-container" style="margin-top: 16px;">
                    <div class="progress-bar" id="revision-progress-bar" style="width: 0%;"></div>
                    <div class="progress-text" id="revision-progress-text">0%</div>
                </div>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px; background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <div>
                        <h3 style="font-family: var(--font-family-heading); font-weight: 700; font-size: 20px; margin: 0;">üìù Daily Revision Tasks</h3>
                        <div style="font-size: 14px; color: var(--color-text-secondary); margin-top: 4px;"><span id="revision-tasks-completed">0</span> of 5 Tasks Completed Today ‚Ä¢ <span id="revision-tasks-percentage">0%</span></div>
                    </div>
                    <button class="btn btn-secondary" onclick="resetRevisionTasks()" style="padding: 8px 16px; font-size: 13px;">üîÑ Reset All</button>
                </div>
                <div class="progress-bar-container" style="margin-bottom: 20px; height: 28px;">
                    <div class="progress-bar" id="revision-tasks-progress-bar" style="width: 0%;"></div>
                    <div class="progress-text" id="revision-tasks-progress-text" style="font-size: 14px;">0%</div>
                </div>
                <div id="demo-revision-tasks-list" style="margin-top: 12px;"></div>
                <div style="margin-top: 16px; padding: 12px; background: var(--color-bg-1); border-radius: 8px; border: 1px solid var(--color-border);">
                    <div style="font-size: 12px; color: var(--color-text-secondary); line-height: 1.6;">
                        üí° <strong>Tips:</strong> Double-click task name to edit ‚Ä¢ Check to mark complete ‚Ä¢ Tasks auto-reset daily at midnight
                    </div>
                </div>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px; background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(147, 51, 234, 0.05) 100%);">
                <h3 style="font-family: var(--font-family-heading); font-weight: 700; font-size: 20px;">üìÖ What to Revise Today</h3>
                <div id="today-revision-list"></div>
            </div>

            <div class="analytics-card" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, rgba(6, 182, 212, 0.05) 100%);">
                <h3 style="font-family: var(--font-family-heading); font-weight: 700; font-size: 20px;">üìö All Topics for Revision</h3>
                <div id="all-revision-list"></div>
            </div>
        </div>

        <!-- ANALYTICS PAGE -->
        <div id="analytics-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>üìä Analytics &amp; Progress</h1>
                <p>Track your consistency and achievements</p>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3 style="font-family: var(--font-family-heading); font-weight: 700;">‚ú® Weekly Progress Visualization</h3>
                <div id="weekly-visualization" style="margin-top: 20px;"></div>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3>üéØ Subject Distribution</h3>
                <canvas id="subject-pie-chart" style="max-height: 300px;"></canvas>
            </div>

            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3>Today's Progress</h3>
                    <div class="stat-value" id="today-progress">0%</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="today-progress-bar" style="width: 0%;"></div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3>Study Streak</h3>
                    <div class="stat-value" id="study-streak">0 days</div>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm);">Keep up the momentum!</p>
                </div>

                <div class="analytics-card">
                    <h3>Total Completed</h3>
                    <div class="stat-value" id="total-completed">0</div>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm);">Chapters/Parts covered</p>
                </div>
            </div>

            <div class="analytics-card" style="margin-top: 20px;">
                <h3>üìÖ Monthly Study Calendar (Heat Map)</h3>
                <div id="calendar-container" class="calendar-grid"></div>
            </div>

            <div class="analytics-card" style="margin-top: 20px;">
                <h3>üéØ Study Efficiency Rating</h3>
                <div id="efficiency-rating" style="margin-top: 16px;"></div>
            </div>

            <div class="analytics-card" style="margin-top: 20px;">
                <h3>‚è∞ Most Productive Hours</h3>
                <div id="productive-hours" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- JOURNAL PAGE -->
        <div id="journal-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>üìù Daily Journal</h1>
                <p>Document your study journey</p>
            </div>

            <div class="journal-entry" style="box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);">
                <h3 style="color: var(--color-primary); margin-bottom: 16px; font-family: var(--font-family-heading); font-weight: 700; font-size: 20px;">‚úçÔ∏è Today's Entry</h3>
                <div style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: 12px; font-family: var(--font-family-decorative);" id="journal-date"></div>
                <div style="margin-bottom: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
                    <select id="journal-font-select" class="form-control" style="flex: 1; min-width: 150px;" onchange="changeJournalFont()">
                        <option value="Lato">Lato</option>
                        <option value="Poppins">Poppins</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Courier New">Courier</option>
                    </select>
                    <button class="btn btn-secondary" onclick="formatJournalText('bold')" style="padding: 8px 12px;"><b>B</b></button>
                    <button class="btn btn-secondary" onclick="formatJournalText('italic')" style="padding: 8px 12px;"><i>I</i></button>
                    <button class="btn btn-secondary" onclick="formatJournalText('underline')" style="padding: 8px 12px;"><u>U</u></button>
                </div>
                <textarea class="journal-textarea" id="journal-textarea" placeholder="Write about your study session, challenges, insights..." style="font-family: 'Lato', sans-serif;" oninput="updateCharCount()"></textarea>
                <div style="text-align: right; font-size: 12px; color: var(--color-text-secondary); margin-top: 8px;">
                    <span id="char-count">0</span> characters
                </div>
                <div class="action-buttons" style="margin-top: 12px;">
                    <button class="btn btn-primary" onclick="saveJournal()">üíæ Save Entry</button>
                    <button class="btn btn-secondary" onclick="clearJournal()">üóëÔ∏è Clear</button>
                </div>
            </div>

            <div class="analytics-card" style="margin-top: 20px; background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, rgba(6, 182, 212, 0.05) 100%);">
                <h3 style="font-family: var(--font-family-heading); font-weight: 700; margin-bottom: 16px; font-size: 20px;">üìä Journal Statistics</h3>
                <div id="journal-stats"></div>
            </div>
            
            <div class="analytics-card" style="margin-top: 20px; background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(249, 115, 22, 0.05) 100%);">
                <h3 style="font-family: var(--font-family-heading); font-weight: 700; font-size: 20px;">üìú Recent Entries</h3>
                <div id="recent-journals" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- POMODORO PAGE -->
        <div id="pomodoro-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>‚è±Ô∏è Pomodoro Timer</h1>
                <p>Focus sessions with breaks</p>
            </div>

            <div class="analytics-card" style="text-align: center;">
                <div id="pomodoro-display" style="font-size: 72px; font-weight: bold; color: var(--color-primary); margin: 20px 0;">25:00</div>
                <div id="pomodoro-status" style="font-size: 18px; color: var(--color-text-secondary); margin-bottom: 20px;">Ready to focus</div>
                <div class="action-buttons" style="justify-content: center;">
                    <button class="btn btn-primary" onclick="startPomodoro()" id="pomodoro-start">‚ñ∂Ô∏è Start</button>
                    <button class="btn btn-secondary" onclick="pausePomodoro()" id="pomodoro-pause" disabled>‚è∏Ô∏è Pause</button>
                    <button class="btn btn-secondary" onclick="resetPomodoro()">üîÑ Reset</button>
                </div>
            </div>

            <div class="analytics-card" style="margin-top: 20px;">
                <h3>Settings</h3>
                <div style="margin-top: 12px;">
                    <label class="form-label">Work Time (minutes):</label>
                    <input type="number" id="work-time-input" class="form-control" min="1" max="60" value="25" onchange="updatePomodoroSettings()">
                </div>
                <div style="margin-top: 12px;">
                    <label class="form-label">Break Time (minutes):</label>
                    <input type="number" id="break-time-input" class="form-control" min="1" max="30" value="5" onchange="updatePomodoroSettings()">
                </div>
            </div>

            <div class="analytics-card" style="margin-top: 20px;">
                <h3>üìä Study Session History</h3>
                <div id="session-history" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- HABITS PAGE -->
        <div id="habits-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>‚úÖ Daily Habits Challenge</h1>
                <p id="habit-motivational-message" style="font-size: 16px; color: var(--color-primary); font-weight: 600; margin-top: 8px;"></p>
            </div>

            <div class="analytics-card" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(147, 51, 234, 0.1) 100%); border: 2px solid var(--color-primary); margin-bottom: 20px;">
                <div style="text-align: center;">
                    <h3 style="margin-bottom: 12px; font-size: 24px;">üéØ Today's Challenge</h3>
                    <div id="habit-date" style="font-size: 16px; color: var(--color-text-secondary); margin-bottom: 12px;"></div>
                    <div style="font-size: 64px; font-weight: 700; color: var(--color-primary); margin: 16px 0;" id="overall-completion-display">0%</div>
                    <div style="font-size: 14px; color: var(--color-text-secondary); margin-bottom: 16px;">Overall Completion</div>
                    <div class="progress-bar-container" style="height: 32px;">
                        <div class="progress-bar" id="habit-progress-bar" style="width: 0%;"></div>
                        <div class="progress-text" id="habit-progress-text" style="font-size: 16px;">0%</div>
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;" id="habits-stats"></div>

            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3 style="margin-bottom: 16px; font-size: 20px;">üìä 7-Day Progress Chart</h3>
                <canvas id="habits-chart" style="max-height: 250px;"></canvas>
            </div>

            <div class="analytics-card">
                <h3 style="margin-bottom: 16px; font-size: 20px;">‚ú® Today's Habits</h3>
                <div id="habits-list" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- FLASHCARDS PAGE -->
        <div id="flashcards-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>üìá Quick Notes</h1>
                <p>Save important study notes</p>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px; background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);">
                <h3 style="margin-bottom: 12px;">üé¥ Flashcard Maker</h3>
                <div style="background: var(--color-bg-2); padding: 12px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid var(--color-warning);">
                    <div style="font-size: 12px; color: var(--color-text-secondary); margin-bottom: 4px;">üìù Format Example:</div>
                    <div style="font-size: 13px; font-family: monospace;">Front: [Term/Question]<br>Back: [Definition/Answer]</div>
                </div>
                <label class="form-label">Front (Question/Term):</label>
                <input type="text" id="flashcard-front" class="form-control" placeholder="Enter question or term" style="margin-bottom: 12px;">
                <label class="form-label">Back (Answer/Definition):</label>
                <textarea id="flashcard-back" class="journal-textarea" placeholder="Enter answer or definition" style="min-height: 80px; margin-bottom: 12px;"></textarea>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                    <div>
                        <label class="form-label">Category:</label>
                        <select id="flashcard-category" class="form-control"></select>
                    </div>
                    <div>
                        <label class="form-label">Card Color:</label>
                        <select id="flashcard-color" class="form-control">
                            <option value="#FF6B6B">Red</option>
                            <option value="#4ECDC4">Cyan</option>
                            <option value="#FFE66D">Yellow</option>
                            <option value="#95E1D3">Mint</option>
                            <option value="#F38181">Pink</option>
                            <option value="#AA96DA">Purple</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="createFlashcard()" style="width: 100%;">‚ú® Create Flashcard</button>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h3 style="margin: 0;">üìö My Flashcards</h3>
                    <button class="btn btn-secondary" onclick="studyModeFlashcards()" style="padding: 6px 12px; font-size: 13px;">üéØ Study Mode</button>
                </div>
                <div id="flashcards-display" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 16px;"></div>
            </div>

            <div class="analytics-card">
                <h3>üìù Quick Notes</h3>
                <input type="text" id="note-title" class="form-control" placeholder="Note title" style="margin-bottom: 12px;">
                <textarea id="note-content" class="journal-textarea" placeholder="Note content..." style="min-height: 100px;"></textarea>
                <div style="margin-top: 12px;">
                    <label class="form-label">Color:</label>
                    <select id="note-color" class="form-control" style="margin-bottom: 12px;">
                        <option value="#E3F2FD">Blue</option>
                        <option value="#FFF9C4">Yellow</option>
                        <option value="#C8E6C9">Green</option>
                        <option value="#FFCCBC">Orange</option>
                        <option value="#F8BBD0">Pink</option>
                        <option value="#E1BEE7">Purple</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="addQuickNote()">üíæ Save Note</button>
            </div>

            <div class="analytics-card">
                <h3>Your Quick Notes</h3>
                <div id="quick-notes-list" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- SYLLABUS TRACKER PAGE -->
        <div id="syllabus-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>üìö Syllabus Tracker</h1>
                <p>Track your complete exam syllabus</p>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px; background: linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(147, 51, 234, 0.08) 100%);">
                <h3 style="margin-bottom: 16px;">‚ûï Add Syllabus Topics</h3>
                <div style="margin-bottom: 12px;">
                    <label class="form-label">Select Subject:</label>
                    <select id="syllabus-subject-select" class="form-control"></select>
                </div>
                <div style="margin-bottom: 12px; padding: 12px; background: var(--color-bg-2); border-radius: 8px; border-left: 4px solid var(--color-warning);">
                    <div style="font-size: 12px; font-weight: 600; color: var(--color-text); margin-bottom: 8px;">üìù Format Example:</div>
                    <div style="font-family: monospace; font-size: 13px; line-height: 1.8; color: var(--color-text-secondary);">
                        Topic 1: Constitutional Law Basics<br>
                        Topic 2: Fundamental Rights<br>
                        Topic 3: Directive Principles<br>
                        Topic 4: Union and States<br>
                        Topic 5: Judiciary System
                    </div>
                </div>
                <div style="margin-bottom: 12px;">
                    <label class="form-label">Enter Topics (one per line):</label>
                    <textarea id="syllabus-topics-input" class="journal-textarea" placeholder="Topic 1: Your first topic&#10;Topic 2: Your second topic&#10;Topic 3: Your third topic" style="min-height: 120px;"></textarea>
                </div>
                <button class="btn btn-primary" onclick="addSyllabus()" style="width: 100%;">‚ú® Add Syllabus</button>
            </div>

            <div id="syllabus-display-container"></div>
        </div>

        <!-- SETTINGS PAGE -->
        <div id="settings-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>‚öôÔ∏è Settings</h1>
                <p>Customize Sambhav's Personal Study Tracker</p>
            </div>

            <!-- USER PROFILE -->
            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3 style="margin-bottom: 16px;">üë§ User Profile</h3>
                <div class="form-group">
                    <label class="form-label">Name:</label>
                    <input type="text" id="settings-username" class="form-control" value="Sambhav" onchange="saveSettings()">
                </div>
                <div class="form-group">
                    <label class="form-label">Email/Contact:</label>
                    <input type="email" id="settings-email" class="form-control" placeholder="your@email.com" onchange="saveSettings()">
                </div>
                <div class="form-group">
                    <label class="form-label">About Me / Study Goal:</label>
                    <textarea id="settings-about" class="form-control" style="min-height: 80px;" placeholder="Tell us about your study journey..." onchange="saveSettings()"></textarea>
                </div>
            </div>

            <!-- APPEARANCE -->
            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3 style="margin-bottom: 16px;">üé® Appearance</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                    <div>
                        <label class="form-label">Dark Mode:</label>
                        <button class="btn btn-primary" onclick="toggleDarkMode()" style="width: 100%;">üåì Toggle Theme</button>
                    </div>
                    <div>
                        <label class="form-label">Font Size:</label>
                        <select id="settings-fontsize" class="form-control" onchange="applyFontSize()">
                            <option value="small">Small</option>
                            <option value="normal" selected>Normal</option>
                            <option value="large">Large</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">Time Format:</label>
                        <select id="settings-timeformat" class="form-control" onchange="saveSettings()">
                            <option value="12" selected>12-hour (AM/PM)</option>
                            <option value="24">24-hour</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- DATA MANAGEMENT -->
            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3 style="margin-bottom: 16px;">üíæ Data Management</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                    <button class="btn btn-primary" onclick="exportAllData()">üì• Export All Data</button>
                    <button class="btn btn-secondary" onclick="importData()">üì§ Import Data</button>
                    <button class="btn btn-secondary" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
                    <button class="btn" style="background: var(--color-error); color: white;" onclick="factoryReset()">‚ö†Ô∏è Factory Reset</button>
                </div>
                <div style="margin-top: 16px; padding: 12px; background: var(--color-bg-1); border-radius: 8px;">
                    <div style="font-size: 12px; color: var(--color-text-secondary);">Data Storage: In-Memory (Session-based)</div>
                </div>
            </div>

            <!-- STUDY PREFERENCES -->
            <div class="analytics-card" style="margin-bottom: 20px;">
                <h3 style="margin-bottom: 16px;">üìö Study Preferences</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                    <div>
                        <label class="form-label">Daily Goal (hours):</label>
                        <input type="number" id="settings-daily-goal" class="form-control" min="1" value="3" onchange="saveSettings()">
                    </div>
                    <div>
                        <label class="form-label">Pomodoro Duration (min):</label>
                        <input type="number" id="settings-pomodoro" class="form-control" min="1" value="25" onchange="saveSettings()">
                    </div>
                    <div>
                        <label class="form-label">Break Duration (min):</label>
                        <input type="number" id="settings-break" class="form-control" min="1" value="5" onchange="saveSettings()">
                    </div>
                </div>
            </div>

            <!-- ABOUT -->
            <div class="analytics-card">
                <h3 style="margin-bottom: 16px;">‚ÑπÔ∏è About</h3>
                <div style="padding: 12px; background: var(--color-bg-5); border-radius: 8px; line-height: 1.8;">
                    <div style="font-weight: bold; margin-bottom: 8px;">Sambhav's Personal Study Tracker</div>
                    <div style="font-size: 14px; color: var(--color-text-secondary);">Version 1.0</div>
                    <div style="font-size: 14px; color: var(--color-text-secondary); margin-top: 8px;">A comprehensive study management system designed for judiciary exam preparation.</div>
                    <div style="margin-top: 16px; font-size: 13px;">
                        <div>üìß Contact: support@studytracker.com</div>
                        <div>üîí Privacy Policy | üìú Terms of Service</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GOALS PAGE -->
        <div id="goals-page" class="page">
            <button class="btn btn-secondary btn-back" onclick="navigateHome()">‚Üê Back to Home</button>
            <div class="header">
                <h1>üéØ Study Goals</h1>
                <p>Set and track your study targets</p>
            </div>

            <div class="analytics-card" style="margin-bottom: 20px; background: linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(147, 51, 234, 0.08) 100%);">
                <h3 style="margin-bottom: 16px;">üéØ Quick Goal Templates</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                    <button class="btn btn-secondary" onclick="setGoalTemplate('beginner')" style="padding: 12px;">üå± Beginner<br><span style="font-size: 11px;">2h/14h/60h</span></button>
                    <button class="btn btn-secondary" onclick="setGoalTemplate('intermediate')" style="padding: 12px;">üìö Intermediate<br><span style="font-size: 11px;">4h/28h/120h</span></button>
                    <button class="btn btn-secondary" onclick="setGoalTemplate('advanced')" style="padding: 12px;">üöÄ Advanced<br><span style="font-size: 11px;">6h/42h/180h</span></button>
                </div>
            </div>

            <div class="analytics-grid">
                <div class="analytics-card" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, rgba(6, 182, 212, 0.05) 100%);">
                    <h3 style="font-family: var(--font-family-heading); font-weight: 700;">üìÖ Daily Goal</h3>
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                        <input type="number" id="daily-goal" class="form-control" min="1" placeholder="Hours" style="flex: 1;" onchange="updateGoals()">
                        <span style="color: var(--color-text-secondary); font-size: 14px;">hours</span>
                    </div>
                    <div class="stat-value" id="daily-progress-display" style="font-size: 48px; margin: 16px 0;">0%</div>
                    <div class="progress-bar-container" style="height: 32px;">
                        <div class="progress-bar" id="daily-goal-bar" style="width: 0%;"></div>
                    </div>
                    <div id="daily-motivational" style="margin-top: 12px; font-size: 13px; color: var(--color-text-secondary); text-align: center; font-style: italic;"></div>
                </div>

                <div class="analytics-card" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(249, 115, 22, 0.05) 100%);">
                    <h3 style="font-family: var(--font-family-heading); font-weight: 700;">üìä Weekly Goal</h3>
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                        <input type="number" id="weekly-goal" class="form-control" min="1" placeholder="Hours" style="flex: 1;" onchange="updateGoals()">
                        <span style="color: var(--color-text-secondary); font-size: 14px;">hours</span>
                    </div>
                    <div class="stat-value" id="weekly-progress-display" style="font-size: 48px; margin: 16px 0; color: var(--color-warning);">0%</div>
                    <div class="progress-bar-container" style="height: 32px;">
                        <div class="progress-bar" id="weekly-goal-bar" style="width: 0%;"></div>
                    </div>
                    <div id="weekly-countdown" style="margin-top: 12px; font-size: 13px; color: var(--color-text-secondary); text-align: center;"></div>
                </div>

                <div class="analytics-card" style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);">
                    <h3 style="font-family: var(--font-family-heading); font-weight: 700;">üìà Monthly Goal</h3>
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                        <input type="number" id="monthly-goal" class="form-control" min="1" placeholder="Hours" style="flex: 1;" onchange="updateGoals()">
                        <span style="color: var(--color-text-secondary); font-size: 14px;">hours</span>
                    </div>
                    <div class="stat-value" id="monthly-progress-display" style="font-size: 48px; margin: 16px 0; color: #9C27B0;">0%</div>
                    <div class="progress-bar-container" style="height: 32px;">
                        <div class="progress-bar" id="monthly-goal-bar" style="width: 0%;"></div>
                    </div>
                    <div id="monthly-streak" style="margin-top: 12px; font-size: 13px; color: var(--color-text-secondary); text-align: center;"></div>
                </div>
            </div>

            <div class="analytics-card" style="margin-top: 20px; background: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, rgba(234, 179, 8, 0.05) 100%);">
                <h3 style="margin-bottom: 16px;">üèÜ Goal Achievement History</h3>
                <div id="goal-achievement-chart" style="margin-top: 16px;">
                    <canvas id="goals-line-chart" style="max-height: 250px;"></canvas>
                </div>
            </div>

            <div class="analytics-card" style="margin-top: 20px;">
                <h3>Weekly Progress Report</h3>
                <div id="weekly-report" style="margin-top: 16px;"></div>
                <button class="btn btn-secondary" onclick="downloadWeeklyReport()" style="margin-top: 12px;">üì• Download Report</button>
            </div>
        </div>
    </div>

    <div id="success-toasts-container" style="position: fixed; top: 20px; right: 20px; z-index: 10000; display: flex; flex-direction: column; gap: 12px; pointer-events: none;"></div>

    <!-- Confirmation Modal -->
    <div id="delete-confirmation-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <h2 style="color: var(--color-error); margin-bottom: 16px;">‚ö†Ô∏è Confirm Delete</h2>
            <p id="delete-confirmation-message" style="margin-bottom: 24px; font-size: 16px; line-height: 1.6;"></p>
            <div style="display: flex; gap: 12px; justify-content: center;">
                <button class="btn btn-secondary" onclick="closeDeleteModal()" style="flex: 1;">Cancel</button>
                <button class="btn" id="confirm-delete-btn" style="flex: 1; background: var(--color-error); color: white;">Delete</button>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu" class="context-menu"></div>

    <div id="flashcard-study-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h2 style="margin-bottom: 16px;">üéØ Study Mode</h2>
            <div id="flashcard-study-content" style="min-height: 300px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <div id="flashcard-display" style="width: 100%; height: 250px; background: var(--color-secondary); border-radius: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 2px solid var(--color-border); transition: transform 0.3s ease;" onclick="flipFlashcard()">
                    <div id="flashcard-text" style="font-size: 24px; font-weight: 600; text-align: center; padding: 20px;"></div>
                </div>
                <div style="margin-top: 20px; font-size: 14px; color: var(--color-text-secondary);">Click card to flip ‚Ä¢ <span id="flashcard-counter">1/1</span></div>
            </div>
            <div style="display: flex; gap: 12px; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="previousFlashcard()" style="flex: 1;">‚¨ÖÔ∏è Previous</button>
                <button class="btn btn-secondary" onclick="closeStudyMode()" style="flex: 1;">‚ùå Close</button>
                <button class="btn btn-secondary" onclick="nextFlashcard()" style="flex: 1;">‚û°Ô∏è Next</button>
            </div>
        </div>
    </div>

    <script>
        // CRITICAL: Using in-memory storage only (no localStorage due to sandbox restrictions)
        // Data
const quotes = [
    "All our dreams can come true if we have the courage to pursue them. - Walt Disney",
    "Success is walking from failure to failure with no loss of enthusiasm. - Winston Churchill",
    "Whether you think you can or you think you can't, you're right. - Henry Ford",
    "A dream doesn't become reality through magic; it takes sweat, determination, and hard work. - Colin Powell",
    "Success is the sum of small efforts, repeated day-in and day-out. - Robert Collier",
    "Do not follow where the path may lead. Go instead where there is no path and leave a trail. - Ralph Waldo Emerson",
    "Courage is what it takes to stand up and speak; courage is also what it takes to sit down and listen. - Winston Churchill",
    "Life is either a daring adventure or nothing at all. - Helen Keller",
    "The purpose of our lives is to be happy. - Dalai Lama",
    "Life isn't about finding yourself. It's about creating yourself. - George Bernard Shaw",
    "Do not dwell in the past, do not dream of the future, concentrate the mind on the present moment. - Buddha",
    "The only way to do great work is to love what you do. - Steve Jobs",
    "Believe you can and you're halfway there. - Theodore Roosevelt",
    "Your time is limited, so don't waste it living someone else's life. - Steve Jobs",
    "It always seems impossible until it's done. - Nelson Mandela",
    "Don't watch the clock; do what it does. Keep going. - Sam Levenson",
    "The future belongs to those who believe in the beauty of their dreams. - Eleanor Roosevelt",
    "Don't be pushed around by the fears in your mind. Be led by the dreams in your heart. - Roy T. Bennett",
    "Success is the sum of details‚Äîmaster the small things and big wins will follow. - Harvey S. Firestone",
    "Dream big and dare to fail. - Norman Vaughan",
    "The harder you work for something, the greater you'll feel when you achieve it. - Unknown",
    "What you get by achieving your goals is not as important as what you become by achieving your goals. - Zig Ziglar",
    "Wake up with determination. Go to bed with satisfaction. - George Lorimer",
    "It does not matter how slowly you go as long as you do not stop. - Confucius",
    "Great things never come from comfort zones. - Unknown",
    "Success usually comes to those who are too busy to be looking for it. - Henry David Thoreau",
    "Action is the foundational key to all success. - Pablo Picasso",
    "Work gives you meaning and purpose and life is empty without it. - Stephen Hawking",
    "If you spend too much time thinking about a thing, you'll never get it done. - Bruce Lee",
    "Do the hard jobs first. The easy jobs will take care of themselves. - Dale Carnegie",
    "Discipline is the bridge between goals and accomplishment. - Jim Rohn",
    "You can do anything, but not everything. - David Allen",
    "Do not wait; the time will never be 'just right.' - Napoleon Hill",
    "The two most powerful warriors are patience and time. - Leo Tolstoy",
    "Time is the most valuable thing a man can spend. - Theophrastus",
    "They always say time changes things, but you actually have to change them yourself. - Andy Warhol",
    "A man who dares to waste one hour of time has not discovered the value of life. - Charles Darwin",
    "Time stays long enough for anyone who will use it. - Leonardo da Vinci",
    "The way we spend our time defines who we are. - Jonathan Estrin",
    "Tough times never last, but tough people do. - Robert H. Schuller",
    "Success is not in what you have, but who you are. - Bo Bennett",
    "The harder the battle, the sweeter the victory. - Les Brown",
    "Do not be embarrassed by your failures, learn from them and start again. - Richard Branson",
    "Work like there is someone working 24 hours a day to take it away from you. - Mark Cuban",
    "Imagination is more important than knowledge. - Albert Einstein",
    "The greatest glory in living lies not in never falling, but in rising every time we fall. - Nelson Mandela",
    "Do what you can, with what you have, where you are. - Theodore Roosevelt",
    "The best way to predict the future is to create it. - Peter Drucker",
    "I have not failed. I've just found 10,000 ways that won't work. - Thomas Edison",
    "Peace begins with a smile. - Mother Teresa",
    "Discipline is the soul of an army. - George Washington",
    "You must be the master of your own destiny. - Napoleon Bonaparte",
    "Never, never, never give up. - Winston Churchill",
    "Innovation distinguishes between a leader and a follower. - Steve Jobs",
    "Life is what happens when you're busy making other plans. - John Lennon",
    "It is during our darkest moments that we must focus to see the light. - Aristotle",
    "The only impossible journey is the one you never begin. - Tony Robbins",
    "Success is not final, failure is not fatal. - Winston Churchill",
    "Believe in yourself and all that you are. - Christian D. Larson",
    "You miss 100% of the shots you don't take. - Wayne Gretzky",
    "The best time to plant a tree was 20 years ago. The second best time is now. - Chinese Proverb",
    "If you are not willing to risk the usual, you will have to settle for the ordinary. - Jim Rohn",
    "Successful people do what unsuccessful people are not willing to do. - Jim Rohn",
    "No one is going to hit as hard as life but it ain't about how hard you hit. - Rocky Balboa",
    "Only a life lived for others is a life worthwhile. - Albert Einstein",
    "The purpose of life is not to be happy. It is to be useful. - Ralph Waldo Emerson",
    "Health is wealth. - Proverb",
    "An investment in knowledge pays the best interest. - Benjamin Franklin",
    "The biggest risk is not taking any risk. - Mark Zuckerberg",
    "Life is not about having all the answers. It's about asking the right questions. - Unknown",
    "Don't just read the easy stuff. You have to keep challenging yourself. - Muhammad Ali",
    "Somebody has to do something, and it's just incredibly pathetic that it has to be us. - Jerry Garcia",
    "Quality is not an act, it is a habit. - Aristotle",
    "Either you run the day or the day runs you. - Jim Rohn",
    "Energy and persistence conquer all things. - Benjamin Franklin",
    "The way to get started is to quit talking and begin doing. - Walt Disney",
    "Don't be afraid to give up the good to go for the great. - John D. Rockefeller",
    "I have nothing to declare except my genius. - Oscar Wilde",
    "Entrepreneurship is about turning a problem into an opportunity. - Jonathan Mead",
    "Mistakes are the portals of discovery. - James Joyce",
    "It's not whether you get knocked down, it's whether you get up. - Vince Lombardi",
    "Don't let yesterday use up too much of today. - Will Rogers",
    "Do something today your future self will thank you for. - Unknown",
    "If you don't design your own life plan, chances are you'll fall into someone else's plan. - Jim Rohn",
    "The Pessimist Sees Difficulty In Every Opportunity. The Optimist Sees Opportunity In Every Difficulty. - Walt Disney",
    "The question isn't who is going to let me. It's who is going to stop me? - Ayn Rand",
    "The person who says it cannot be done should not interrupt the person doing it. - Chinese Proverb",
    "Your limitation‚Äîit's only your imagination. - Unknown",
    "Keep your eyes on the stars, and your feet on the ground. - Theodore Roosevelt",
    "The man who moves a mountain begins by carrying away small stones. - Confucius",
    "Great minds discuss ideas; average minds discuss events; small minds discuss people. - Eleanor Roosevelt",
    "Be the change you wish to see in the world. - Gandhi",
    "Comparison is the thief of joy. - Theodore Roosevelt",
    "You can't use up creativity. The more you use, the more you have. - Maya Angelou",
    "One's mind, once stretched by a new idea, never regains its original dimension. - Oliver Wendell Holmes",
    "Everything has beauty, but not everyone can see. - Confucius",
    "The only limit to our realization of tomorrow is our doubts of today. - Franklin D. Roosevelt",
    "Start where you are. Use what you have. Do what you can. - Arthur Ashe",
    "The secret of getting ahead is getting started. - Mark Twain",
    "Don't limit yourself. - Mary Kay Ash",
    "Push yourself, because no one else is going to do it for you. - Unknown",
    "Sometimes later becomes never. Do it now. - Unknown",
    "One day or day one. You decide. - Unknown",
    "It's going to be hard, but hard does not mean impossible. - Unknown",
    "Don't stop when you're tired. Stop when you're done. - Unknown",
    "Wake up with determination. Go to bed with satisfaction. - Unknown",
    "Do something today that your future self will thank you for. - Sean Patrick Flanery",
    "Little things make big days. - Unknown",
    "It's okay to not be perfect. - Unknown",
    "Hard work beats talent when talent doesn't work hard. - Tim Notke",
    "Strive for progress, not perfection. - Unknown",
    "Don't wish for it. Work for it. - Unknown",
    "Success doesn't just find you. You have to go out and get it. - Unknown",
    "The key to success is to focus on goals, not obstacles. - Unknown",
    "Dream it. Wish it. Do it. - Unknown",
    "Success is what comes after you stop making excuses. - Luis Galarza",
    "Don't wait for opportunity. Create it. - Unknown",
    "Sometimes we're tested not to show our weaknesses, but to discover our strengths. - Unknown",
    "The harder you work for something, the greater you'll feel when you achieve it. - Unknown",
    "Dream bigger. Do bigger. - Unknown",
    "Don't stop until you're proud. - Unknown",
    "Work hard in silence. Let success make the noise. - Unknown",
    "Study while others are sleeping; work while others are loafing. - William A. Ward",
    "The expert in anything was once a beginner. - Helen Hayes",
    "The struggle you're in today is developing the strength you need tomorrow. - Robert Tew",
    "Don't downgrade your dream just to fit your reality. Upgrade your conviction to match your destiny. - Unknown",
    "You are never too old to set another goal or to dream a new dream. - C.S. Lewis",
    "At the end of the day, let there be no excuses, no explanations, no regrets. - Steve Maraboli",
    "You don't have to be great to start, but you have to start to be great. - Zig Ziglar",
    "A goal without a plan is just a wish. - Antoine de Saint-Exup√©ry",
    "It is never too late to be what you might have been. - George Eliot",
    "Twenty years from now you will be more disappointed by the things that you didn't do. - Mark Twain",
    "The only person you are destined to become is the person you decide to be. - Ralph Waldo Emerson",
    "I find that the harder I work, the more luck I seem to have. - Thomas Jefferson",
    "Success is stumbling from failure to failure with no loss of enthusiasm. - Winston Churchill",
    "Just when the caterpillar thought the world was ending, he turned into a butterfly. - Proverb",
    "Opportunities don't happen. You create them. - Chris Grosser",
    "Try not to become a person of success, but rather try to become a person of value. - Albert Einstein",
    "It is not the strongest of the species that survives, but the one most responsive to change. - Charles Darwin",
    "Great minds discuss ideas; average minds discuss events; small minds discuss people. - Eleanor Roosevelt",
    "I have not failed. I've just found 10,000 ways that won't work. - Thomas A. Edison",
    "A person who never made a mistake never tried anything new. - Albert Einstein",
    "The person who says it cannot be done should not interrupt the person who is doing it. - Chinese Proverb",
    "There are no traffic jams along the extra mile. - Roger Staubach",
    "It is never too late to be what you might have been. - George Eliot",
    "You become what you believe. - Oprah Winfrey",
    "I would rather die of passion than of boredom. - Vincent van Gogh",
    "A truly rich man is one whose children run into his arms when his hands are empty. - Unknown",
    "It is not what you do for your children, but what you have taught them to do for themselves. - Ann Landers",
    "The battles that count aren't the ones for gold medals. The struggles within yourself are the toughest. - Jesse Owens",
    "Education costs money. But then so does ignorance. - Sir Claus Moser",
    "I learned that courage was not the absence of fear, but the triumph over it. - Nelson Mandela",
    "Change your thoughts and you change your world. - Norman Vincent Peale",
    "Either write something worth reading or do something worth writing. - Benjamin Franklin",
    "Nothing is impossible, the word itself says, 'I'm possible!' - Audrey Hepburn",
    "The only way to do great work is to love what you do. - Steve Jobs",
    "If you can dream it, you can achieve it. - Zig Ziglar"
];

const shlokas = [
    { text: "‡§ú‡•Ä‡§µ‡§§‡•á ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§è‡§µ ‡§Ø‡§É ‡§∏‡§∞‡•ç‡§µ‡§§‡•ç‡§∞ ‡§∏‡§Æ‡§¶‡§∞‡•ç‡§∂‡•Ä‡•§", translation: "When one is free within, one is always free." },
    { text: "‡§ï‡§∞‡•ç‡§Æ‡§£‡•ç‡§Ø‡•á‡§µ‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡§∏‡•ç‡§§‡•á ‡§Æ‡§æ ‡§´‡§≤‡•á‡§∑‡•Å ‡§ï‡§¶‡§æ‡§ö‡§®‡•§", translation: "You have the right to work only, but not to its fruits." },
    { text: "‡§Ø‡•ã‡§ó: ‡§ï‡§∞‡•ç‡§Æ‡§∏‡•Å ‡§ï‡•å‡§∂‡§≤‡§Æ‡•ç‡•§", translation: "Yoga is skill in action." },
    { text: "‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Ø‡•Å‡§ï‡•ç‡§§‡•ã ‡§ú‡§π‡§æ‡§§‡•Ä‡§π ‡§â‡§≠‡•á ‡§∏‡•Å‡§ï‡•É‡§§‡§¶‡•Å‡§∑‡•ç‡§ï‡•É‡§§‡•á‡•§", translation: "The wise one transcends both good and evil deeds." },
    { text: "‡§Ü‡§§‡•ç‡§Æ‡•à‡§µ ‡§Ü‡§§‡•ç‡§Æ‡§®‡•ã ‡§¨‡§®‡•ç‡§ß‡•Å‡§É ‡§Ü‡§§‡•ç‡§Æ‡•à‡§µ ‡§∞‡§ø‡§™‡•Å‡§É ‡§Ü‡§§‡•ç‡§Æ‡§®‡§É‡•§", translation: "One is one's own friend and one's own enemy." },
    { text: "‡§∏‡§∞‡•ç‡§µ‡§∏‡•ç‡§Ø ‡§ö‡§æ‡§π‡§Ç ‡§π‡•É‡§¶‡§ø ‡§∏‡§Ç‡§®‡§ø‡§µ‡§ø‡§∑‡•ç‡§ü‡§É‡•§", translation: "I am seated in everyone's heart." },
    { text: "‡§∏‡§∞‡•ç‡§µ ‡§ß‡§∞‡•ç‡§Æ‡§æ‡§®‡•ç ‡§™‡§∞‡§ø‡§§‡•ç‡§Ø‡§ú‡•ç‡§Ø ‡§Æ‡§æ‡§Æ‡•á‡§ï‡§Ç ‡§∂‡§∞‡§£‡§Ç ‡§µ‡•ç‡§∞‡§ú‡•§", translation: "Abandon all dharmas and surrender to me alone." },
    { text: "‡§®‡•à‡§µ ‡§§‡§∏‡•ç‡§Ø ‡§ï‡•É‡§§‡•á‡§®‡§æ‡§∞‡•ç‡§•‡•ã ‡§®‡§æ‡§ï‡•É‡§§‡•á‡§®‡•á‡§π ‡§ï‡§∂‡•ç‡§ö‡§®‡•§", translation: "He has no purpose to fulfill, nor does he benefit from inaction." },
    { text: "‡§ß‡•ç‡§Ø‡§æ‡§®‡§æ‡§≠‡•ç‡§Ø‡§æ‡§∏‡•á‡§® ‡§§‡§®‡•ç‡§Æ‡§®‡§É‡•§", translation: "Through meditation, the mind becomes focused." },
    { text: "‡§Ö‡§π‡§ô‡•ç‡§ï‡§æ‡§∞‡§Æ‡§Æ ‡§Ø‡•Å‡§ï‡•ç‡§§‡§∏‡•ç‡§Ø ‡§® ‡§ï‡§∞‡•ç‡§§‡§µ‡•ç‡§Ø‡§Ç ‡§Æ‡§§‡§Ç ‡§Æ‡§Æ‡•§", translation: "The ego-less one is not a doer, in my view." },
    { text: "‡§∏‡•ç‡§µ‡§∏‡•ç‡§•‡•ã ‡§≠‡§µ ‡§™‡§∞‡§ø‡§§‡§æ‡§™‡•Ä‡§Æ‡§æ‡§®‡•ç‡•§", translation: "Be cheerful in the face of sorrow." },
    { text: "‡§Ø‡•ã‡§ó‡§∏‡•ç‡§•‡§É ‡§ï‡•Å‡§∞‡•Å ‡§ï‡§∞‡•ç‡§Æ‡§æ‡§£‡§ø ‡§∏‡§ô‡•ç‡§ó‡§Ç ‡§§‡•ç‡§Ø‡§ï‡•ç‡§§‡•ç‡§µ‡§æ ‡§ß‡§®‡§û‡•ç‡§ú‡§Ø‡•§", translation: "Perform your duties with steadfastness while abandoning attachment." },
    { text: "‡§¶‡•ç‡§µ‡•å ‡§á‡§Æ‡•å ‡§™‡•Å‡§∞‡•Å‡§∑‡•å ‡§≤‡•ã‡§ï‡•á ‡§ï‡•ç‡§∑‡§∞‡§∂‡•ç‡§ö‡§æ‡§ï‡•ç‡§∑‡§∞ ‡§è‡§µ ‡§ö‡•§", translation: "There are two kinds of beings in this world - the perishable and imperishable." },
    { text: "‡§Ü‡§§‡•ç‡§Æ‡§æ ‡§π‡•Ä ‡§Ü‡§§‡•ç‡§Æ‡§®‡•ã ‡§ó‡§§‡§ø‡§É‡•§", translation: "The self is the refuge of the self." },
    { text: "‡§∏‡§Æ‡§Ç ‡§Æ‡•à‡§§‡•ç‡§∞‡•Ä‡§Ç ‡§ï‡§∞‡•ã‡§Æ‡§ø ‡§∏‡§∞‡•ç‡§µ‡•á‡§∑‡•Å ‡§≠‡•Ç‡§§‡•á‡§∑‡•Å‡•§", translation: "I maintain equal friendship with all beings." },
    { text: "‡§Ö‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§Ø‡§æ‡§Æ‡§®‡•ç‡§§‡§∞‡•á ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§®‡§æ‡§É ‡§∏‡•ç‡§µ‡§Ø‡§Ç ‡§ß‡•Ä‡§∞‡§æ‡§É‡•§", translation: "Those dwelling in ignorance, yet think themselves wise." },
    { text: "‡§ï‡§∞‡•ç‡§Æ‡§£‡•ç‡§Ø‡•á ‡§µ‡•ã‡§™‡§®‡§ø‡§∑‡§¶‡§ø‡§Ç ‡§™‡§æ‡§∞‡§Æ‡•á‡§∂‡•ç‡§µ‡§∞‡§Æ‡•ç‡•§", translation: "In karma yoga lies the supreme truth." },
    { text: "‡§≠‡•ç‡§∞‡§æ‡§Æ‡§Ø‡§®‡•ç‡§§‡•á ‡§∏‡§∞‡•ç‡§µ‡§≠‡•Ç‡§§‡§æ‡§®‡§ø ‡§Ø‡§®‡•ç‡§§‡•ç‡§∞‡§æ‡§∞‡•Ç‡§¢‡§æ‡§®‡§ø ‡§Æ‡§æ‡§Ø‡§Ø‡§æ‡•§", translation: "All beings are deluded by the three gunas of maya." },
    { text: "‡§Ø‡§∏‡•ç‡§Æ‡§æ‡§¶‡•Å‡§§‡•ç‡§§‡§∞‡§§‡§∞‡§Ç ‡§®‡§æ‡§®‡•ç‡§Ø‡§§‡•ç‡§ï‡§ø‡§û‡•ç‡§ö‡§ø‡§§‡•ç ‡§ï‡§•‡§û‡•ç‡§ö‡§®‡•§", translation: "Nothing whatsoever is higher than I." },
    { text: "‡§∏‡§∞‡•ç‡§µ‡§∏‡•ç‡§Ø ‡§™‡•ç‡§∞‡§≠‡•Å‡§∞‡•ç‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§æ ‡§µ‡§ø‡§∑‡•ç‡§£‡•Å‡§∞‡•ç‡§Æ‡§π‡•á‡§∂‡•ç‡§µ‡§∞‡§É‡•§", translation: "Brahma, Vishnu, and Shiva are all manifestations of the supreme." },
    { text: "‡§® ‡§π‡§ø ‡§ú‡•ç‡§û‡§æ‡§®‡•á‡§® ‡§∏‡§¶‡•É‡§∂‡§Ç ‡§™‡§µ‡§ø‡§§‡•ç‡§∞‡§Æ‡§ø‡§π ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§§‡•á‡•§", translation: "Nothing in this world is as pure as knowledge." },
    { text: "‡§ï‡•ç‡§∞‡•ã‡§ß‡§æ‡§¶‡•ç‡§≠‡§µ‡§§‡§ø ‡§∏‡§Æ‡•ç‡§Æ‡•ã‡§π‡§É ‡§∏‡§Æ‡•ç‡§Æ‡•ã‡§π‡§æ‡§¶‡•ç‡§≠‡§µ‡§§‡§ø ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø‡§µ‡§ø‡§≠‡•ç‡§∞‡§Æ‡§É‡•§", translation: "From anger comes delusion, from delusion comes loss of memory." },
    { text: "‡§§‡•É‡§∑‡•ç‡§£‡§æ ‡§¶‡•ç‡§µ‡•á‡§∑‡§æ‡§≠‡•ç‡§Ø‡§æ‡§Ç ‡§µ‡§ø‡§Æ‡•Å‡§ï‡•ç‡§§‡§É ‡§∏‡•Å‡§ñ‡•Ä ‡§≠‡§µ‡§§‡§ø‡•§", translation: "One who is free from desire and aversion becomes happy." },
    { text: "‡§ï‡§æ‡§Æ‡§æ‡§ó‡•ç‡§®‡•á‡§É ‡§ú‡§®‡•ç‡§Æ ‡§∏‡§Æ‡•ç‡§≠‡§µ‡§É‡•§", translation: "Desire is the cause of birth." },
    { text: "‡§µ‡•á‡§¶‡§æ‡§π‡§Ç ‡§∏‡§Æ‡§§‡•Ä‡§§‡•ç‡§Ø ‡§∏‡§∞‡•ç‡§µ‡§æ‡§£‡§ø ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§≠‡•Ç‡§Ø‡§æ‡§Ø ‡§ï‡§≤‡•ç‡§™‡§§‡•á‡•§", translation: "By transcending all the Vedas, one becomes Brahman." },
    { text: "‡§Ø‡•ã‡§ó‡•Ä ‡§Ø‡§§‡§ø ‡§§‡§¶‡§æ ‡§™‡•ç‡§∞‡•ã‡§ï‡•ç‡§§‡§É ‡§Ø‡§¶‡§æ ‡§®‡•ã‡§¶‡§µ‡§ø‡§ú‡•É‡§Æ‡•ç‡§≠‡§§‡•á‡•§", translation: "A yogi is he who neither exults nor grieves." },
    { text: "‡§Ü‡§§‡•ç‡§Æ‡§®‡•ç ‡§Ü‡§§‡•ç‡§Æ‡§®‡§Æ‡§æ‡§§‡•ç‡§Æ‡§®‡§æ ‡§∏‡§®‡•ç‡§§‡•Å‡§∑‡•ç‡§ü‡•ã ‡§Ø‡§¶‡§ø ‡§µ‡§∞‡•ç‡§§‡§§‡•á‡•§", translation: "The self-satisfied one dwelling in the self is content." },
    { text: "‡§™‡•ç‡§∞‡§ú‡•ç‡§û‡§æ‡§®‡§Ç ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ ‡§ú‡§æ‡§®‡•Ä‡§π‡§ø‡•§", translation: "Know that consciousness is Brahman." },
    { text: "‡§® ‡§ò‡•ç‡§∞‡•á‡§Ø‡•ã‡§Ω‡§∏‡•ç‡§§‡§ø ‡§® ‡§™‡§∞‡§Ç ‡§§‡§µ ‡§∂‡•Å‡§≠‡•ç‡§∞‡§§‡§∞‡§Æ‡•ç‡•§", translation: "There is nothing higher or more auspicious than you." },
    { text: "‡§∏‡§∞‡•ç‡§µ‡§§‡•ç‡§∞ ‡§∏‡§Æ‡§¶‡§∞‡•ç‡§∂‡•Ä ‡§ú‡§æ‡§®‡•Ä‡§Ø‡§æ‡§§‡•ç‡•§", translation: "One who sees the same in all is wise." },
    { text: "‡§Ö‡§®‡§®‡•ç‡§§‡•ç‡§Ø‡§Ç ‡§Ö‡§Æ‡§∞‡§§‡•ç‡§µ‡§Ç ‡§™‡§∞‡§Ç ‡§™‡§¶‡§Æ‡•ç‡•§", translation: "Infinity and immortality are the supreme state." },
    { text: "‡§Ø‡§∏‡•ç‡§Ø ‡§∏‡§∞‡•ç‡§µ‡•á ‡§∏‡§Æ‡§æ‡§∞‡§Æ‡•ç‡§≠‡§æ‡§É ‡§ï‡§æ‡§Æ‡§∏‡§ô‡•ç‡§ï‡§≤‡•ç‡§™‡§µ‡§∞‡•ç‡§ú‡§ø‡§§‡§æ‡§É‡•§", translation: "He whose all undertakings are free from desire." },
    { text: "‡§∂‡§æ‡§®‡•ç‡§§‡§ø‡§É ‡§∂‡§æ‡§®‡•ç‡§§‡§ø‡§É ‡§∂‡§æ‡§®‡•ç‡§§‡§ø‡§É‡•§", translation: "Peace, peace, peace." },
    { text: "‡§Ø‡§¶‡§æ ‡§∏‡§∞‡•ç‡§µ‡•á ‡§™‡•ç‡§∞‡§≠‡§µ‡§®‡•ç‡§§‡§ø ‡§≠‡•Ç‡§§‡§É‡•§", translation: "From which all beings are born." },
    { text: "‡§Ü‡§§‡•ç‡§Æ‡§®‡•ç ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§Ø‡•à ‡§∏‡§∞‡•ç‡§µ‡§§‡•ç‡§∞ ‡§∏‡§Æ‡§¶‡§∞‡•ç‡§∂‡§®‡§Æ‡•ç‡•§", translation: "In knowledge of the self, equal vision is everywhere." },
    { text: "‡§§‡§¶‡§æ ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§Ç ‡§§‡§¶‡§æ ‡§ï‡§≤‡•ç‡§™‡§Ø‡§®‡•ç‡§§‡§ø ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§£‡§ø‡•§", translation: "Then they think of themselves as established in Brahman." },
    { text: "‡§∏‡§∞‡•ç‡§µ‡§≠‡•Ç‡§§‡•á‡§∑‡•Å ‡§ö‡§æ‡§§‡•ç‡§Æ‡§æ‡§®‡§Ç ‡§∏‡§∞‡•ç‡§µ‡§≠‡•Ç‡§§‡§æ‡§®‡§ø ‡§ö‡§æ‡§§‡•ç‡§Æ‡§®‡§ø‡•§", translation: "The self in all beings and all beings in the self." },
    { text: "‡§∂‡§∞‡•Ä‡§∞‡§Ç ‡§Ø‡§®‡•ç‡§§‡•ç‡§∞‡§Ç ‡§Æ‡§®‡•ã‡§Ω‡§ß‡•ç‡§µ‡§∞‡•ç‡§Ø‡•Å‡•§", translation: "The body is the instrument, the mind is the priest." },
    { text: "‡§Ø‡•ã‡§ó ‡§è‡§µ ‡§ï‡§∞‡•ç‡§Æ‡§∏‡•Å ‡§ï‡•å‡§∂‡§≤‡§Æ‡•ç‡•§", translation: "Skill in action is yoga." },
    { text: "‡§® ‡§π‡§ø ‡§ú‡•ç‡§û‡§æ‡§®‡•á‡§® ‡§∏‡§¶‡•É‡§∂‡§Ç ‡§™‡§µ‡§ø‡§§‡•ç‡§∞‡§Æ‡•ç‡•§", translation: "Nothing equals knowledge in purity." },
    { text: "‡§§‡§∏‡•ç‡§Æ‡§æ‡§¶‡•Å‡§§‡•ç‡§§‡§∞‡§§‡§∞‡§Ç ‡§®‡§æ‡§®‡•ç‡§Ø‡§§‡•ç‡§ï‡§ø‡§û‡•ç‡§ö‡§ø‡§§‡•ç‡•§", translation: "Nothing is higher than the self." },
    { text: "‡§Ü‡§§‡•ç‡§Æ‡•à‡§µ ‡§Ü‡§§‡•ç‡§Æ‡§®‡•ã ‡§¨‡§®‡•ç‡§ß‡•Å‡§∞‡•ç‡§Ü‡§§‡•ç‡§Æ‡•à‡§µ ‡§∞‡§ø‡§™‡•Å‡§É‡•§", translation: "One's self is one's friend or enemy." },
    { text: "‡§Ø‡§∏‡•ç‡§Ø ‡§®‡§æ‡§π‡§ô‡•ç‡§ï‡•É‡§§‡•ã ‡§≠‡§æ‡§µ‡•ã ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§∞‡•ç‡§Ø‡§∏‡•ç‡§Ø ‡§® ‡§≤‡§ø‡§™‡•ç‡§Ø‡§§‡•á‡•§", translation: "Whose ego is not prominent and whose intellect is untainted." },
    { text: "‡§ß‡•ç‡§Ø‡§æ‡§®‡§Ç ‡§∏‡§∞‡•ç‡§µ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§†‡§Æ‡•ç‡•§", translation: "Meditation is the highest practice." },
    { text: "‡§Ø‡§ú‡•ç‡§û‡•ã ‡§µ‡§ø‡§∑‡•ç‡§£‡•Å ‡§≠‡•Ç‡§Ø‡§§‡•á‡•§", translation: "Sacrifice is Vishnu." },
    { text: "‡§™‡•ç‡§∞‡§ú‡•ç‡§û‡§æ ‡§§‡•Å ‡§∏‡§∞‡•ç‡§µ‡§ú‡•ç‡§û‡§§‡§æ‡•§", translation: "Wisdom is all-knowing." },
    { text: "‡§®‡§æ‡§Ø‡§Æ‡§æ‡§§‡•ç‡§Æ‡§æ ‡§¨‡§≤‡§π‡•Ä‡§®‡•á‡§® ‡§≤‡§≠‡•ç‡§Ø‡§É‡•§", translation: "The self cannot be attained by the weak." },
    { text: "‡§∏‡§§‡•ç‡§Ø‡§Ç ‡§∂‡§ø‡§µ‡§Æ‡•ç‡•§", translation: "Truth is auspicious." },
    { text: "‡§Ö‡§Æ‡•É‡§§‡§Ç ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ ‡§™‡§∞‡§Æ‡•ç‡•§", translation: "Brahman is the supreme immortal." },
    { text: "‡§Æ‡§® ‡§è‡§µ ‡§Æ‡§®‡•Å‡§∑‡•ç‡§Ø‡§æ‡§®‡§æ‡§Ç ‡§ï‡§æ‡§∞‡§£‡§Ç ‡§¨‡§®‡•ç‡§ß‡§Æ‡•ã‡§ï‡•ç‡§∑‡§Ø‡•ã‡§É‡•§", translation: "The mind is the cause of bondage and liberation." },
    { text: "‡§∏‡§Æ‡§§‡•ç‡§µ‡§Ç ‡§Ø‡•ã‡§ó ‡§â‡§ö‡•ç‡§Ø‡§§‡•á‡•§", translation: "Equanimity is called yoga." },
    { text: "‡§§‡§∏‡•ç‡§Æ‡§æ‡§¶‡§Ø‡•ã‡§ó‡•Ä ‡§≠‡§µ‡§æ‡§∞‡•ç‡§ú‡•Å‡§®‡•§", translation: "Therefore be a yogi, O Arjuna." },
    { text: "‡§∂‡•Å‡§≠‡§æ‡§∂‡•Å‡§≠‡•á ‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡•ç‡§Ø‡•§", translation: "Looking equally on good and evil." },
    { text: "‡§ú‡•ç‡§û‡§æ‡§®‡•á‡§® ‡§§‡•Å ‡§§‡§¶‡§ú‡•ç‡§û‡§æ‡§®‡§Æ‡•ç‡•§", translation: "Through knowledge, that ignorance is destroyed." },
    { text: "‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§®‡§ø‡§∞‡•ç‡§µ‡§æ‡§£‡§Ç ‡§ó‡§ö‡•ç‡§õ‡§®‡•ç‡§§‡§ø‡•§", translation: "They attain Brahman-bliss." },
    { text: "‡§ï‡§∞‡•ç‡§Æ‡•à‡§µ ‡§π‡§ø ‡§¨‡•ã‡§¶‡•ç‡§ß‡§µ‡•ç‡§Ø‡§Æ‡•ç‡•§", translation: "Karma alone must be understood." },
    { text: "‡§∏‡§∞‡•ç‡§µ‡§¶‡•Ç‡§∞‡•á‡§£ ‡§π‡§Ø‡§Æ‡•ç‡•§", translation: "All distances are transcended." },
    { text: "‡§ï‡§∞‡•ç‡§Æ‡§Ø‡•ã‡§ó‡•ã ‡§Ø‡•ã‡§ó‡§æ‡§§‡•ç ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§†‡§É‡•§", translation: "Karma yoga is superior to renunciation." },
    { text: "‡§∏‡§¶‡§æ ‡§∏‡§Æ‡§ö‡§ø‡§§‡•ç‡§§‡§É‡•§", translation: "Always the mind should be tranquil." },
    { text: "‡§Ü‡§∏‡•ç‡§•‡§ø‡§§‡§É ‡§∏‡•Å‡§ñ‡§Æ‡•ç ‡§Ö‡§∏‡•Å‡§ñ‡§Æ‡•ç‡•§", translation: "Unaffected by pleasure and pain." },
    { text: "‡§® ‡§¶‡•ç‡§µ‡•á‡§∑‡•ç‡§ü‡§ø ‡§® ‡§ï‡§æ‡§ô‡•ç‡§ï‡•ç‡§∑‡§§‡§ø‡•§", translation: "Neither hates nor desires." },
    { text: "‡§®‡§ø‡§∞‡•ç‡§Æ‡§Æ‡§É ‡§®‡§ø‡§∞‡§π‡§ô‡•ç‡§ï‡§æ‡§∞‡§É‡•§", translation: "Free from ego and possession." },
    { text: "‡§∏‡§Æ‡§É ‡§∏‡§∞‡•ç‡§µ‡§§‡•ç‡§∞‡•§", translation: "The same everywhere." },
    { text: "‡§™‡•ç‡§∞‡§ú‡•ç‡§û‡§æ‡§®‡§Ç ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡•§", translation: "Consciousness is Brahman." },
    { text: "‡§Ö‡§π‡§Æ‡•ç ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§æ‡§∏‡•ç‡§Æ‡§ø‡•§", translation: "I am Brahman." },
    { text: "‡§§‡§§‡•ç ‡§§‡•ç‡§µ‡§Æ‡•ç ‡§Ö‡§∏‡§ø‡•§", translation: "Thou art That." },
    { text: "‡§Ö‡§Ø‡§Æ‡•ç ‡§Ü‡§§‡•ç‡§Æ‡§æ ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡•§", translation: "This Self is Brahman." },
    { text: "‡§∏‡•ã‡§Ω‡§π‡§Æ‡•ç‡•§", translation: "I am That." },
    { text: "‡§ï‡§æ‡§Æ ‡§è‡§µ ‡§Ö‡§ó‡•ç‡§∞‡§ú‡§É‡•§", translation: "Desire is born first." },
    { text: "‡§ï‡•ç‡§∞‡•ã‡§ß‡§É ‡§∏‡§∞‡•ç‡§µ‡§µ‡§ø‡§®‡§æ‡§∂‡§®‡§É‡•§", translation: "Anger destroys everything." },
    { text: "‡§≤‡•ã‡§≠‡§É ‡§™‡§æ‡§™‡§∏‡•ç‡§Ø ‡§ú‡§®‡§®‡•Ä‡•§", translation: "Greed is the mother of sin." },
    { text: "‡§Æ‡•ã‡§π‡§É ‡§∏‡§∞‡•ç‡§µ‡§µ‡§ø‡§®‡§æ‡§∂‡§®‡§É‡•§", translation: "Delusion is destructive." },
    { text: "‡§§‡•É‡§∑‡•ç‡§£‡§æ ‡§∏‡§∞‡•ç‡§µ‡§¨‡§®‡•ç‡§ß‡§®‡•Ä‡•§", translation: "Thirst binds all." },
    { text: "‡§ï‡§æ‡§Æ‡§É ‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ø‡§Ø‡§∏‡•ç‡§Ø ‡§ï‡•Ä‡§∞‡•ç‡§§‡§ø‡§É‡•§", translation: "Desire brings fame to warriors." },
    { text: "‡§Ø‡•ã‡§ó‡•Ä ‡§∏‡§∞‡•ç‡§µ‡§§‡•ç‡§∞ ‡§Ø‡•Å‡§ï‡•ç‡§§‡§É‡•§", translation: "A yogi is always connected." },
    { text: "‡§ß‡§∞‡•ç‡§Æ‡•ã ‡§∞‡§ï‡•ç‡§∑‡§§‡§ø ‡§∞‡§ï‡•ç‡§∑‡§ø‡§§‡§É‡•§", translation: "Virtue protects the virtuous." },
    { text: "‡§∏‡§Æ‡§æ ‡§µ‡•á‡§¶‡§æ ‡§®‡§ø‡§ó‡§Æ‡§æ ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø‡§É‡•§", translation: "All Vedas describe the same truth." },
    { text: "‡§è‡§ï‡§Ç ‡§∏‡§§‡•ç ‡§µ‡§ø‡§™‡•ç‡§∞‡§æ ‡§¨‡§π‡•Å‡§ß‡§æ ‡§µ‡§¶‡§®‡•ç‡§§‡§ø‡•§", translation: "Truth is one, the wise call it many ways." },
    { text: "‡§Æ‡•ã‡§ï‡•ç‡§∑‡§æ‡§∞‡•ç‡§•‡§Ç ‡§§‡§™‡•ç‡§§‡§µ‡•ç‡§Ø‡§Æ‡•ç‡•§", translation: "Austerity must be performed for liberation." },
    { text: "‡§§‡§™‡•ã ‡§¶‡§æ‡§®‡§Æ‡•ç ‡§¶‡§Æ‡§É ‡§∂‡§Æ‡§É‡•§", translation: "Austerity, charity, self-control, and tranquility." },
    { text: "‡§∏‡§§‡•ç‡§Ø‡§Ç ‡§µ‡§ö‡§®‡§Ç ‡§™‡•ç‡§∞‡§ø‡§Ø‡§Æ‡•ç‡•§", translation: "Truthful and pleasing words." },
    { text: "‡§Ö‡§π‡§ø‡§Ç‡§∏‡§æ ‡§™‡§∞‡§Æ‡•ã ‡§ß‡§∞‡•ç‡§Æ‡§É‡•§", translation: "Non-violence is the highest dharma." },
    { text: "‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§†‡§æ ‡§ó‡•Å‡§£‡§æ ‡§®‡•É‡§£‡§æ‡§Æ‡•ç‡•§", translation: "Forgiveness is the greatest virtue of humans." },
    { text: "‡§∏‡§Ç‡§§‡•ã‡§∑‡§Ç ‡§™‡§∞‡§Æ‡§Ç ‡§∏‡•Å‡§ñ‡§Æ‡•ç‡•§", translation: "Contentment is supreme happiness." },
    { text: "‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ ‡§µ‡§ø‡§¶‡§ø‡§§‡§µ‡§§‡•ç‡§§‡§∞‡§Æ‡•ç‡•§", translation: "Knowledge surpasses everything." },
    { text: "‡§à‡§∂‡•ç‡§µ‡§∞‡§É ‡§∏‡§∞‡•ç‡§µ‡§≠‡•Ç‡§§‡§æ‡§®‡§æ‡§Æ‡•ç‡•§", translation: "God dwells in all beings." },
    { text: "‡§µ‡•à‡§∞‡§æ‡§ó‡•ç‡§Ø‡§Ç ‡§™‡§∞‡§Æ‡§Ç ‡§™‡§¶‡§Æ‡•ç‡•§", translation: "Detachment is the supreme state." },
    { text: "‡§Ø‡•ã‡§ó‡§É ‡§µ‡§ø‡§Ø‡•ã‡§ó‡§É ‡§∞‡§æ‡§ó‡§æ‡§§‡•ç‡•§", translation: "Yoga is separation from attachment." },
    { text: "‡§≠‡§ï‡•ç‡§§‡§ø‡§É ‡§™‡§∞‡§Æ‡§æ ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§É‡•§", translation: "Devotion is the highest wisdom." },
    { text: "‡§®‡§æ‡§∞‡§æ‡§Ø‡§£‡§É ‡§™‡§∞‡•ã ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§æ‡•§", translation: "Narayana is the supreme Brahman." },
    { text: "‡§µ‡§æ‡§∏‡•Å‡§¶‡•á‡§µ‡§É ‡§∏‡§∞‡•ç‡§µ‡§Æ‡§ø‡§¶‡§Æ‡•ç‡•§", translation: "Vasudeva is all this." }
];

const funFacts = [
    "The Indian Constitution is the longest written constitution in the world with 448 articles and 25 parts.",
    "It took 2 years, 11 months, and 18 days to draft the Indian Constitution.",
    "The original Constitution was handwritten in both Hindi and English by calligraphers.",
    "Dr. B.R. Ambedkar is the Father of the Indian Constitution and chaired the Drafting Committee.",
    "The Constitution has been amended 104+ times since its adoption.",
    "The BNS 2023 replaced the 161-year-old Indian Penal Code (IPC 1860).",
    "BNSS came into force on July 1, 2024, replacing CrPC 1973.",
    "There are 2.18 crore pending cases in Indian district and high courts.",
    "The Preamble of the Constitution is non-justiciable but its spirit guides interpretation.",
    "Fundamental Rights are enforceable by courts but Directive Principles are not.",
    "The 42nd Amendment is called the 'Mini Constitution' due to major changes.",
    "India has a dual citizenship structure - no dual citizenship allowed.",
    "The judiciary exam requires about 5,000 hours of focused preparation.",
    "A Civil Judge candidate has only 15 minutes to write a 10-mark answer in Mains.",
    "The Constitution draws from constitutions of 60+ countries - it's a 'bag of borrowings'.",
    "There are 22 parts in the original Constitution, now expanded to 25 parts.",
    "The Constitution originally had 8 Schedules, now there are 12 schedules.",
    "Article 370 gave special status to Jammu &amp; Kashmir (abrogated in 2019).",
    "The emergency provisions can give extensive powers to the central government.",
    "The 26th January is celebrated as Republic Day commemorating Constitution's adoption.",
    "Dr. Ambedkar could speak 9 languages fluently.",
    "The Constitution has approximately 145,000 words, making it massive.",
    "Lok Sabha has 545 members, Rajya Sabha has 250 members.",
    "The President of India is the chief executive authority.",
    "The Prime Minister leads the Government of India as head of Council of Ministers.",
    "Federal structure balances power between Centre and States.",
    "The Constitution provides for 3 types of emergency - War, Internal Disturbance, Financial.",
    "Impeachment of President requires 2/3 majority in both houses.",
    "Removal of PM requires loss of confidence vote in Lok Sabha.",
    "Judicial review power is inherent to Indian courts.",
    "The Constitution is both flexible and rigid - it can be amended but with procedures.",
    "Some amendments require simple majority, others require 2/3 supermajority.",
    "Fundamental Duties were introduced by the 42nd Amendment in 1976.",
    "Citizens have the right to move courts for protection of rights.",
    "The Constitution provides secular governance - no state religion.",
    "India practices Universal Adult Franchise - all citizens 18+ can vote.",
    "The Constituent Assembly consisted of 299 members.",
    "Only 284 members signed the final Constitution.",
    "The Constitution protects Scheduled Castes and Scheduled Tribes through special provisions.",
    "OBC reservations are constitutional but not in Tier-1 services initially.",
    "The Constitution's Preamble begins with 'We the people of India'.",
    "The Directive Principles are inspired by the Irish Constitution.",
    "The Basic Structure Doctrine ensures core principles cannot be amended.",
    "The Supreme Court established the Basic Structure Doctrine in 1973.",
    "Contempt of court is punishable to protect judicial independence.",
    "The Constitution provides for Public Interest Litigation (PIL).",
    "The Right to Information became a Fundamental Right (via Supreme Court).",
    "The Constitution recognizes environmental rights through Supreme Court interpretation.",
    "Judicial independence is a core feature of the Indian Constitution.",
    "The Constitution provides for judicial accountability while maintaining independence.",
    "Judges cannot practice law after retirement - ensures independence.",
    "The Indian legal system is a mixture of English common law, Islamic law, and customary Hindu law.",
    "India has a single integrated judicial system with the Supreme Court at the apex.",
    "The Supreme Court of India was established on January 26, 1950.",
    "BNS 2023 came into effect on July 1, 2024, replacing IPC 1860.",
    "The Chief Justice of India is the head of the Indian judiciary.",
    "High Courts in India have the power of superintendence over subordinate courts.",
    "Article 32 provides the right to constitutional remedies.",
    "Article 226 empowers High Courts to issue writs.",
    "The Supreme Court has original, appellate, and advisory jurisdiction.",
    "India follows the adversarial system of justice.",
    "The doctrine of precedent (stare decisis) is followed in Indian courts.",
    "Supreme Court judgments are binding on all courts in India.",
    "The President appoints judges of the Supreme Court and High Courts.",
    "Judges of the Supreme Court retire at age 65.",
    "High Court judges retire at age 62.",
    "The collegium system decides judicial appointments in India.",
    "Article 124 deals with the establishment and constitution of the Supreme Court.",
    "The Supreme Court can have a maximum of 34 judges including the Chief Justice.",
    "Article 143 empowers the President to seek advisory opinion from the Supreme Court.",
    "Judicial activism has been a significant feature of Indian judiciary.",
    "The Supreme Court building was designed by Chief Architect Ganesh Bhikaji Deolalikar.",
    "Lady justice statue at the Supreme Court holds scales without a blindfold.",
    "The first Chief Justice of India was Justice Harilal Jekisundas Kania.",
    "Justice Fathima Beevi was the first woman judge of the Supreme Court (1989).",
    "Justice M. Fathima Beevi was also the first woman Chief Justice of a State High Court.",
    "The National Judicial Appointments Commission (NJAC) was struck down by the Supreme Court.",
    "Article 141 states that the law declared by the Supreme Court is binding.",
    "Kesavananda Bharati case (1973) established the Basic Structure Doctrine.",
    "Maneka Gandhi case (1978) expanded the interpretation of Article 21.",
    "Right to privacy was declared a fundamental right in 2017 (Justice K.S. Puttaswamy case).",
    "The Vishaka Guidelines (1997) dealt with sexual harassment at workplace.",
    "Section 377 was partially struck down in Navtej Singh Johar case (2018).",
    "Triple Talaq was declared unconstitutional in Shayara Bano case (2017).",
    "The Ayodhya land dispute was resolved by the Supreme Court in 2019.",
    "Article 21 guarantees the right to life and personal liberty.",
    "Article 14 provides equality before law.",
    "Article 19 guarantees six fundamental freedoms.",
    "Article 20 provides protection against conviction for offences.",
    "Article 22 deals with protection against arrest and detention.",
    "Article 23 prohibits traffic in human beings and forced labor.",
    "Article 24 prohibits employment of children in factories.",
    "Article 25 guarantees freedom of conscience and religion.",
    "Article 26 provides freedom to manage religious affairs.",
    "Article 29 protects interests of minorities.",
    "Article 30 gives minorities the right to establish educational institutions.",
    "The Constitution Day is celebrated on November 26 every year.",
    "B.N. Rau was the Constitutional Advisor to the Constituent Assembly.",
    "Prem Behari Narain Raizada calligraphed the original Constitution.",
    "The Objective Resolution was moved by Jawaharlal Nehru in 1946.",
    "The Constituent Assembly held 11 sessions over 165 days.",
    "Women members in the Constituent Assembly included Sarojini Naidu and Sucheta Kripalani.",
    "The Constitution was adopted on November 26, 1949.",
    "The Constitution came into force on January 26, 1950.",
    "The National Emblem is taken from the Ashoka Pillar at Sarnath.",
    "Satyameva Jayate (Truth Alone Triumphs) is inscribed below the National Emblem.",
    "The National Flag was adopted on July 22, 1947.",
    "Jana Gana Mana was adopted as the National Anthem on January 24, 1950.",
    "Vande Mataram has equal status with Jana Gana Mana.",
    "The National Song was composed by Bankim Chandra Chatterjee.",
    "Article 1 declares India as a Union of States.",
    "Article 368 deals with the power and procedure to amend the Constitution.",
    "The First Amendment Act (1951) added the Ninth Schedule.",
    "The Ninth Schedule protects certain laws from judicial review.",
    "Article 356 allows President's Rule in states.",
    "Article 360 deals with financial emergency.",
    "Article 352 provides for national emergency.",
    "Emergency has been declared three times in India (1962, 1971, 1975).",
    "The 44th Amendment (1978) restricted the power to declare emergency.",
    "Article 51A lists 11 Fundamental Duties of citizens.",
    "The 86th Amendment (2002) made education a fundamental right.",
    "Article 21A provides free and compulsory education to children aged 6-14.",
    "The 73rd Amendment (1992) gave constitutional status to Panchayati Raj.",
    "The 74th Amendment (1992) provided constitutional status to Urban Local Bodies.",
    "The 101st Amendment (2016) introduced the Goods and Services Tax (GST).",
    "The 103rd Amendment (2019) provided 10% reservation for economically weaker sections.",
    "Article 12 defines the State for the purpose of fundamental rights.",
    "Article 13 declares laws inconsistent with fundamental rights void.",
    "Article 15 prohibits discrimination on grounds of religion, race, caste, sex, or place of birth.",
    "Article 16 provides equality of opportunity in public employment.",
    "Article 17 abolishes untouchability.",
    "Article 18 abolishes titles except military and academic distinctions.",
    "Right to Constitutional Remedies (Article 32) is called the heart of the Constitution by Dr. Ambedkar.",
    "Five types of writs can be issued: Habeas Corpus, Mandamus, Prohibition, Certiorari, Quo Warranto.",
    "Habeas Corpus means 'to have the body' - protects against illegal detention.",
    "Mandamus means 'we command' - orders performance of public duty.",
    "Prohibition prevents lower courts from exceeding jurisdiction.",
    "Certiorari quashes orders of lower courts or tribunals.",
    "Quo Warranto questions a person's right to hold public office.",
    "The Supreme Court has the power to review its own judgments.",
    "Curative petitions can be filed after review petitions are dismissed.",
    "Special Leave Petition (SLP) is filed under Article 136.",
    "PIL (Public Interest Litigation) was pioneered by Justice V.R. Krishna Iyer.",
    "The Doctrine of Eclipse protects pre-constitutional laws inconsistent with fundamental rights.",
    "Doctrine of Severability allows separating valid and invalid parts of a law.",
    "Doctrine of Colorable Legislation prevents indirect violation of constitutional provisions.",
    "The Doctrine of Prospective Overruling applies new interpretations only to future cases.",
    "Article 39A mandates equal justice and free legal aid.",
    "The Legal Services Authority Act was enacted in 1987.",
    "NALSA (National Legal Services Authority) provides free legal aid.",
    "Lok Adalats are alternative dispute resolution forums.",
    "The Arbitration and Conciliation Act, 1996 promotes alternative dispute resolution.",
    "The Limitation Act prescribes time limits for filing suits.",
    "The Indian Evidence Act, 1872 governs admissibility of evidence.",
    "The Code of Civil Procedure (CPC) regulates civil court proceedings.",
    "Order 1 Rule 8 of CPC deals with representative suits.",
    "Order 6 of CPC deals with pleadings.",
    "Order 7 Rule 11 allows rejection of plaints.",
    "The principle of natural justice includes audi alteram partem (hear the other side).",
    "Nemo judex in causa sua means no one should be a judge in their own cause.",
    "The doctrine of res judicata prevents re-litigation of decided matters.",
    "Res sub judice prevents simultaneous proceedings in different courts.",
    "The principle of lis pendens applies to property under litigation.",
    "The doctrine of legitimate expectation protects reasonable expectations from government.",
    "Promissory estoppel prevents going back on promises made by the government.",
    "The doctrine of pleasure governs civil servants' tenure.",
    "Delegated legislation allows executive authorities to make rules under Acts.",
    "Sub-delegation is generally not permitted without express authority.",
    "Administrative tribunals were created by the 42nd Amendment.",
    "Article 323A provides for administrative tribunals.",
    "Article 323B deals with tribunals for other matters.",
    "The Competition Act, 2002 replaced the MRTP Act, 1969.",
    "The Consumer Protection Act, 2019 replaced the 1986 Act.",
    "The Right to Information Act, 2005 promotes transparency.",
    "The Juvenile Justice Act protects children in conflict with law.",
    "The Protection of Children from Sexual Offences Act (POCSO), 2012 protects children.",
    "The Domestic Violence Act, 2005 protects women from domestic abuse.",
    "The Dowry Prohibition Act, 1961 prohibits giving or taking dowry.",
    "The Maternity Benefit Act, 1961 provides maternity leave to women employees.",
    "The Equal Remuneration Act, 1976 provides for equal pay for equal work.",
    "The Sexual Harassment at Workplace Act, 2013 protects against workplace harassment.",
    "The Transgender Persons Act, 2019 protects transgender rights.",
    "The Mental Healthcare Act, 2017 decriminalized suicide.",
    "The Aadhaar Act, 2016 provides legal backing to Aadhaar.",
    "The Insolvency and Bankruptcy Code, 2016 consolidates insolvency laws.",
    "The Benami Transactions Act prohibits benami property transactions.",
    "The Fugitive Economic Offenders Act, 2018 deals with economic offenders who flee India.",
    "The Companies Act, 2013 regulates company law in India.",
    "The Negotiable Instruments Act, 1881 governs cheques, promissory notes, and bills of exchange.",
    "Section 138 of NI Act criminalizes dishonor of cheques.",
    "The Transfer of Property Act, 1882 deals with property transactions.",
    "The Registration Act, 1908 provides for registration of documents.",
    "The Indian Contract Act, 1872 governs contractual obligations.",
    "The Sale of Goods Act, 1930 regulates sale of goods.",
    "The Partnership Act, 1932 governs partnership firms.",
    "The Hindu Marriage Act, 1955 governs Hindu marriages.",
    "The Special Marriage Act, 1954 provides for inter-religious marriages.",
    "The Hindu Succession Act, 1956 deals with inheritance among Hindus.",
    "The 2005 amendment to Hindu Succession Act gave equal rights to daughters.",
    "The Hindu Minority and Guardianship Act, 1956 deals with guardianship of Hindu minors.",
    "The Hindu Adoptions and Maintenance Act, 1956 governs adoption and maintenance.",
    "The Guardians and Wards Act, 1890 deals with guardianship of minors.",
    "The Protection of Women from Domestic Violence Act, 2005 is a civil remedy.",
    "The Indian Succession Act, 1925 governs succession among Christians and Parsis.",
    "The Muslim Personal Law (Shariat) Application Act, 1937 applies Islamic law to Muslims.",
    "The Muslim Women (Protection of Rights on Divorce) Act, 1986 protects divorced Muslim women.",
    "The Places of Worship Act, 1991 prohibits conversion of religious places.",
    "The Religious Institutions Act prevents misuse of religious institutions.",
    "The Indian Trusts Act, 1882 governs private trusts.",
    "The Public Trusts Act regulates public charitable trusts.",
    "The Societies Registration Act, 1860 provides for registration of societies.",
    "The Trade Unions Act, 1926 provides for registration of trade unions.",
    "The Industrial Disputes Act, 1947 regulates industrial disputes.",
    "The Minimum Wages Act, 1948 fixes minimum wages.",
    "The Payment of Wages Act, 1936 regulates payment of wages.",
    "The Employees' Provident Fund Act, 1952 provides for provident fund.",
    "The Employees' State Insurance Act, 1948 provides health insurance.",
    "The Workmen's Compensation Act, 1923 provides compensation for workplace injuries.",
    "The Factories Act, 1948 regulates working conditions in factories.",
    "The Shops and Establishments Act regulates shops and commercial establishments.",
    "The Payment of Bonus Act, 1965 provides for payment of bonus.",
    "The Payment of Gratuity Act, 1972 provides for gratuity payment.",
    "The Contract Labour Act, 1970 regulates contract labor.",
    "The Inter-State Migrant Workers Act, 1979 protects migrant workers.",
    "The Child Labour Act, 1986 prohibits child labor in certain occupations.",
    "The Bonded Labour System (Abolition) Act, 1976 abolishes bonded labor.",
    "The Environment Protection Act, 1986 protects the environment.",
    "The Wildlife Protection Act, 1972 protects wildlife.",
    "The Forest Conservation Act, 1980 conserves forests.",
    "The Water (Prevention and Control of Pollution) Act, 1974 prevents water pollution.",
    "The Air (Prevention and Control of Pollution) Act, 1981 prevents air pollution.",
    "The Motor Vehicles Act, 1988 regulates motor vehicles and road safety.",
    "The Indian Penal Code defines crimes and prescribes punishments.",
    "Section 300 IPC defines murder.",
    "Section 304 IPC deals with culpable homicide not amounting to murder.",
    "Section 302 IPC prescribes punishment for murder.",
    "Section 375 IPC defines rape.",
    "Section 376 IPC prescribes punishment for rape."
];

const subjects = {
    bns: {
        id: "bns",
        name: "BNS (Bharatiya Nyaya Sanhita)",
        defaultName: "BNS (Bharatiya Nyaya Sanhita)",
        editable: false,
        chapters: 20,
        sections: 358,
        parts: [
            "Chapter 1: General Principles",
            "Chapter 2: Of Culpable Homicide",
            "Chapter 3: Of Causing Hurt",
            "Chapter 4: Of Criminal Force",
            "Chapter 5: Of Offences Against Women",
            "Chapter 6: Against Chattels",
            "Chapter 7: Against Public Tranquility",
            "Chapter 8: Against Elections",
            "Chapter 9: Against Public Health",
            "Chapter 10: Offences Relating to Elections",
            "Chapter 11: False Evidence",
            "Chapter 12: Offences Related to Election",
            "Chapter 13: General Exceptions",
            "Chapter 14: Abduction",
            "Chapter 15: Kidnapping",
            "Chapter 16: Wrongful Restraint",
            "Chapter 17: Criminal Intimidation",
            "Chapter 18: Insult and Annoyance",
            "Chapter 19: Defamation",
            "Chapter 20: General Provisions"
        ]
    },
    bnss: {
        id: "bnss",
        name: "BNSS (Bharatiya Nagarik Suraksha Sanhita)",
        defaultName: "BNSS (Bharatiya Nagarik Suraksha Sanhita)",
        editable: false,
        chapters: 39,
        sections: 531,
        parts: [
            "Part 1: Preliminary",
            "Part 2: Information to Police and Commencement of Investigations",
            "Part 3: Inquiry and Investigations",
            "Part 4: General Provisions as to Bail",
            "Part 5: Offences Against Elections",
            "Part 6: Public Order",
            "Part 7: Judicial Authority",
            "Part 8: Preventive Action",
            "Part 9: Adjudication by Magistrates",
            "Part 10: Trials",
            "Part 11: Particular Offences",
            "Part 12: Appeals",
            "Part 13: Revision and Reference",
            "Part 14: Execution and Enforcement",
            "Part 15: Prisoners",
            "Part 16: Application of Code",
            "Part 17: Repeals and Savings",
            "Part 18: Definitions",
            "Part 19: Miscellaneous",
            "Part 20: Additional Provisions (1)",
            "Part 21: Additional Provisions (2)",
            "Part 22: Additional Provisions (3)",
            "Part 23: Additional Provisions (4)",
            "Part 24: Additional Provisions (5)",
            "Part 25: Additional Provisions (6)",
            "Part 26: Additional Provisions (7)",
            "Part 27: Additional Provisions (8)",
            "Part 28: Additional Provisions (9)",
            "Part 29: Additional Provisions (10)",
            "Part 30: Additional Provisions (11)",
            "Part 31: Additional Provisions (12)",
            "Part 32: Additional Provisions (13)",
            "Part 33: Additional Provisions (14)",
            "Part 34: Additional Provisions (15)",
            "Part 35: Additional Provisions (16)",
            "Part 36: Additional Provisions (17)",
            "Part 37: Additional Provisions (18)",
            "Part 38: Additional Provisions (19)",
            "Part 39: Additional Provisions (20)"
        ]
    },
    constitution: {
        id: "constitution",
        name: "Indian Constitution",
        defaultName: "Indian Constitution",
        editable: false,
        chapters: 22,
        sections: 395,
        parts: [
            "Part I: The Union and Its Territory",
            "Part II: Citizenship",
            "Part III: Fundamental Rights",
            "Part IV: Directive Principles of State Policy",
            "Part IVA: Fundamental Duties",
            "Part V: The Union",
            "Part VI: The States",
            "Part VIII: Union Territories",
            "Part IX: The Panchayats",
            "Part IXA: The Municipalities",
            "Part X: Scheduled and Tribal Areas",
            "Part XI: Relations Between Union and States",
            "Part XII: Finance, Property, Contracts and Suits",
            "Part XIII: Trade, Commerce and Intercourse",
            "Part XIV: Services Under the Union and States",
            "Part XIVA: Tribunals",
            "Part XV: Elections",
            "Part XVI: Special Provisions for Certain Classes",
            "Part XVII: Official Languages",
            "Part XVIII: Emergency Provisions",
            "Part XIX: Miscellaneous",
            "Part XX: Amendment of the Constitution"
        ]
    },
    cpc: {
        id: "cpc",
        name: "CPC (Civil Procedure Code)",
        defaultName: "CPC (Civil Procedure Code)",
        editable: false,
        chapters: 11,
        sections: 158,
        parts: [
            "Preliminary Sections",
            "Part I: Suits in General",
            "Part II: Execution",
            "Part III: Incidental Proceedings",
            "Part IV: Suits in Particular Cases",
            "Part V: Special Proceedings",
            "Part VI: Supplemental Proceedings",
            "Part VII: Appeals",
            "Part VIII: Review and Revision",
            "Part IX: Special Provisions Relating to High Courts",
            "Part X: Rules"
        ]
    },
    bsa: {
        id: "bsa",
        name: "BSA (Bharatiya Sakshya Adhiniyam)",
        defaultName: "BSA (Bharatiya Sakshya Adhiniyam)",
        editable: false,
        chapters: 12,
        sections: 170,
        parts: [
            "Chapter 1: Preliminary",
            "Chapter 2: Relevancy of Facts",
            "Chapter 3: Facts Which Need Not Be Proved",
            "Chapter 4: Of Oral Evidence",
            "Chapter 5: Of Documentary Evidence",
            "Chapter 6: Exclusion of Oral Evidence by Documentary Evidence",
            "Chapter 7: Of the Burden of Proof",
            "Chapter 8: Estoppel",
            "Chapter 9: Of Witnesses",
            "Chapter 10: Of Examination of Witnesses",
            "Chapter 11: Of Improper Admission and Rejection of Evidence",
            "Chapter 12: Repeal and Savings"
        ]
    },
    demo1: {
        id: "demo1",
        name: "Demo Subject 1",
        defaultName: "Demo Subject 1",
        editable: true,
        chapters: 0,
        sections: 0,
        parts: []
    },
    demo2: {
        id: "demo2",
        name: "Demo Subject 2",
        defaultName: "Demo Subject 2",
        editable: true,
        chapters: 0,
        sections: 0,
        parts: []
    },
    demo3: {
        id: "demo3",
        name: "Demo Subject 3",
        defaultName: "Demo Subject 3",
        editable: true,
        chapters: 0,
        sections: 0,
        parts: []
    },
    demo4: {
        id: "demo4",
        name: "Demo Subject 4",
        defaultName: "Demo Subject 4",
        editable: true,
        chapters: 0,
        sections: 0,
        parts: []
    },
    demo5: {
        id: "demo5",
        name: "Demo Subject 5",
        defaultName: "Demo Subject 5",
        editable: true,
        chapters: 0,
        sections: 0,
        parts: []
    }
};

// State management
let currentSubject = null;
let studyData = {};
let journalData = {};
let customSubjects = {};
let chapterCounter = {};
let studyStreak = 0;
let bestStreak = 0;
let lastStudyDate = '';
let habits = [];
let habitProgress = {};
let flashcards = [];
let badges = [];
let darkMode = false;
let studyGoals = {daily: 2, weekly: 14, monthly: 60};
let pomodoroSettings = {workTime: 25, breakTime: 5};
let pomodoroTimer = null;
let pomodoroTimeLeft = 0;
let pomodoroActive = false;
let pomodoroIsBreak = false;
let dailyStudyTime = 0;
let studySessions = [];
let subjectNames = {};
let customRevisionTopics = [];
let demoRevisionTasks = [
    {id: 1, name: "Review Constitutional Articles", completed: false, completedDate: null},
    {id: 2, name: "Practice Previous Year Questions", completed: false, completedDate: null},
    {id: 3, name: "Case Law Study", completed: false, completedDate: null},
    {id: 4, name: "Topic Revision - BNS", completed: false, completedDate: null},
    {id: 5, name: "Daily Revision Summary", completed: false, completedDate: null}
];
let lastRevisionResetDate = '';
let currentFunFactIndex = 0;
let quickNotes = [];
let flashcardsData = [];
let currentStudyIndex = 0;
let isFlashcardFlipped = false;
let habitWeeklyData = {};
let successMessages = ['Great!', 'Awesome!', 'Excellent!', 'Perfect!', 'Well Done!', 'Fantastic!', 'Outstanding!', 'Superb!', 'Brilliant!', 'Amazing!'];
let undoHistory = [];
let userSettings = {username: 'Sambhav', email: '', about: '', fontSize: 'normal', timeFormat: '12', dailyGoalHours: 3, pomodoroDuration: 25, breakDuration: 5};
let syllabusData = {};
let syllabusBreakdownVisible = {};

const defaultHabits = [
    "Study for at least 2 hours",
    "Review previous day's topics",
    "Complete assigned chapters",
    "Take practice tests",
    "Write daily notes",
    "Meditate (15 minutes)",
    "Read (15 minutes)"
];

const defaultBadges = [
    {name: "üåü First Day", description: "Complete your first study session", icon: "üåü", unlocked: false},
    {name: "üî• Week Warrior", description: "Maintain 7-day study streak", icon: "üî•", unlocked: false},
    {name: "üèÜ Subject Master", description: "Complete entire subject", icon: "üèÜ", unlocked: false},
    {name: "üí™ Consistent Learner", description: "Study 30 consecutive days", icon: "üí™", unlocked: false},
    {name: "üåô Night Owl", description: "Study after 9 PM", icon: "üåô", unlocked: false},
    {name: "‚è∞ Early Bird", description: "Study before 6 AM", icon: "‚è∞", unlocked: false},
    {name: "üìö Knowledge Seeker", description: "Complete 10 topics", icon: "üìö", unlocked: false},
    {name: "üéØ Goal Crusher", description: "Reach daily goal", icon: "üéØ", unlocked: false},
    {name: "üß† Memory Master", description: "Use flashcards 50+ times", icon: "üß†", unlocked: false},
    {name: "üíé Top Performer", description: "90%+ daily completion", icon: "üíé", unlocked: false},
    {name: "üìñ Book Worm", description: "Read for 15 minutes daily for 30 days", icon: "üìñ", unlocked: false},
    {name: "‚ö° Speed Learner", description: "Complete 5 topics in one day", icon: "‚ö°", unlocked: false},
    {name: "üéì Scholar", description: "Maintain 90% completion for a month", icon: "üéì", unlocked: false},
    {name: "üåÖ Dawn Warrior", description: "Study before 6 AM for 7 consecutive days", icon: "üåÖ", unlocked: false},
    {name: "üåÉ Midnight Scholar", description: "Study after 11 PM for 7 consecutive days", icon: "üåÉ", unlocked: false},
    {name: "üíØ Perfectionist", description: "Score 100% in 5 practice tests", icon: "üíØ", unlocked: false},
    {name: "üîÑ Revision Master", description: "Complete all revision tasks for 14 days", icon: "üîÑ", unlocked: false},
    {name: "üìù Note Taker", description: "Write journal entries for 21 consecutive days", icon: "üìù", unlocked: false},
    {name: "üéØ Focused", description: "Complete 20 Pomodoro sessions", icon: "üéØ", unlocked: false},
    {name: "üèÖ Champion", description: "Unlock all other badges", icon: "üèÖ", unlocked: false}
];

// Context Menu System
function showContextMenu(x, y, items) {
    const menu = document.getElementById('context-menu');
    menu.innerHTML = items.map(item => {
        if (item.separator) {
            return '<div class="context-menu-separator"></div>';
        }
        return `<div class="context-menu-item ${item.danger ? 'danger' : ''}" onclick="${item.action}; hideContextMenu();">${item.icon} ${item.label}</div>`;
    }).join('');
    
    menu.style.left = x + 'px';
    menu.style.top = y + 'px';
    menu.classList.add('active');
}

function hideContextMenu() {
    const menu = document.getElementById('context-menu');
    menu.classList.remove('active');
}

// Click outside to close context menu
document.addEventListener('click', (e) => {
    const menu = document.getElementById('context-menu');
    if (menu && !menu.contains(e.target) && menu.classList.contains('active')) {
        hideContextMenu();
    }
});

// Prevent default context menu
document.addEventListener('contextmenu', (e) => {
    if (e.target.closest('.revision-item') || e.target.closest('.chapter-item') || e.target.closest('.journal-entry')) {
        e.preventDefault();
    }
});

// Initialize app
function initApp() {
    loadData();
    loadSubjectNames();
    if (habits.length === 0) habits = defaultHabits.slice();
    if (badges.length === 0) badges = JSON.parse(JSON.stringify(defaultBadges));
    updateDateTime();
    setInterval(updateDateTime, 1000);
    rotateQuotes();
    autoRotateInterval = setInterval(rotateQuotes, 10000);
    
    // Add CSS for toast animations
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes slideOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100px); }
        }
    `;
    document.head.appendChild(style);
    displayShloka();
    document.getElementById('shloka-section').addEventListener('click', displayShloka);
    rotateFunFacts();
    applyDarkMode();
    updateStreakDisplay();
    updateBadgesDisplay();
    updateDailyStudyDisplay();
    populateSubjectDropdown();
}

// Date/Time functions
function updateDateTime() {
    const now = new Date();
    const options = {
        timeZone: 'Asia/Kolkata',
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: true
    };
    
    // Update attractive clock with 12-hour format
    let hours = now.getHours();
    const ampm = hours >= 12 ? 'PM' : 'AM';
    hours = hours % 12;
    hours = hours ? hours : 12; // 0 becomes 12
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const clockEl = document.getElementById('attractive-clock');
    if (clockEl) {
        clockEl.textContent = `${hours}:${minutes}:${seconds} ${ampm}`;
        clockEl.style.textShadow = `0 0 30px rgba(33, 150, 243, ${0.3 + Math.sin(Date.now() / 1000) * 0.2}), 0 0 60px rgba(156, 39, 176, ${0.2 + Math.cos(Date.now() / 1000) * 0.15})`;
    }
    
    // Update date
    const dateEl = document.getElementById('attractive-date');
    if (dateEl) {
        dateEl.textContent = now.toLocaleDateString('en-IN', {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'});
    }
    
    // Update greeting
    const greetingEl = document.getElementById('greeting-time');
    if (greetingEl) {
        const hour = now.getHours();
        let greeting = '';
        if (hour < 12) greeting = 'üåÖ Good Morning';
        else if (hour < 17) greeting = '‚òÄÔ∏è Good Afternoon';
        else if (hour < 21) greeting = 'üåÜ Good Evening';
        else greeting = 'üåô Good Night';
        greetingEl.textContent = greeting;
    }
}

function getTodayDate() {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}

// Quote rotation with flower burst
let currentQuoteIndex = 0;
let autoRotateInterval = null;

function rotateQuotes() {
    const quoteEl = document.getElementById('quote-text-main');
    const authorEl = document.getElementById('quote-author-main');
    if (!quoteEl) return;
    
    // Fade out
    quoteEl.classList.add('fade-out');
    if (authorEl) authorEl.classList.add('fade-out');
    
    setTimeout(() => {
        const fullQuote = quotes[currentQuoteIndex];
        const parts = fullQuote.split(' - ');
        quoteEl.textContent = parts[0];
        if (authorEl && parts[1]) {
            authorEl.textContent = '‚Äî ' + parts[1];
        }
        
        quoteEl.classList.remove('fade-out');
        quoteEl.classList.add('fade-in');
        if (authorEl) {
            authorEl.classList.remove('fade-out');
            authorEl.classList.add('fade-in');
        }
        
        currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
        
        setTimeout(() => {
            quoteEl.classList.remove('fade-in');
            if (authorEl) authorEl.classList.remove('fade-in');
        }, 800);
    }, 800);
}

function showSuccessToast(message) {
    const container = document.getElementById('success-toasts-container');
    if (!container) return;
    
    const toast = document.createElement('div');
    const colors = ['#4CAF50', '#2196F3', '#FF9800', '#9C27B0', '#E91E63', '#00BCD4'];
    const randomColor = colors[Math.floor(Math.random() * colors.length)];
    
    toast.style.cssText = `
        background: ${randomColor};
        color: white;
        padding: 16px 24px;
        border-radius: 12px;
        font-size: 18px;
        font-weight: 700;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        animation: slideIn 0.3s ease-out, slideOut 0.5s ease-in 2.5s;
        pointer-events: auto;
        font-family: var(--font-family-heading);
    `;
    
    toast.textContent = message || successMessages[Math.floor(Math.random() * successMessages.length)];
    container.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 3000);
}

function createFlowerBurst() {
    // Removed - replaced with success toasts
}

// Shloka display with animation
let currentShlokaIndex = 0;
function displayShloka() {
    const shlokaTextEl = document.getElementById('shloka-text');
    const shlokaTransEl = document.getElementById('shloka-translation');
    
    shlokaTextEl.classList.add('fade-out');
    shlokaTransEl.classList.add('fade-out');
    
    setTimeout(() => {
        const shloka = shlokas[currentShlokaIndex];
        shlokaTextEl.textContent = shloka.text;
        shlokaTransEl.textContent = shloka.translation;
        
        shlokaTextEl.classList.remove('fade-out');
        shlokaTextEl.classList.add('fade-in');
        shlokaTransEl.classList.remove('fade-out');
        shlokaTransEl.classList.add('fade-in');
        
        currentShlokaIndex = (currentShlokaIndex + 1) % shlokas.length;
        
        setTimeout(() => {
            shlokaTextEl.classList.remove('fade-in');
            shlokaTransEl.classList.remove('fade-in');
        }, 800);
    }, 800);
}

// Navigation
function navigateTo(page) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    const pageEl = document.getElementById(page + '-page');
    if (!pageEl) return;
    pageEl.classList.add('active');
    
    if (page === 'chapter-tracking') {
        renderSubjectList();
    } else if (page === 'revision') {
        renderRevisionPage();
    } else if (page === 'analytics') {
        renderAnalytics();
    } else if (page === 'journal') {
        renderJournal();
    } else if (page === 'pomodoro') {
        renderPomodoro();
    } else if (page === 'habits') {
        renderHabits();
    } else if (page === 'flashcards') {
        renderFlashcards();
        renderQuickNotes();
    } else if (page === 'goals') {
        renderGoals();
    } else if (page === 'settings') {
        renderSettings();
    } else if (page === 'syllabus') {
        renderSyllabusPage();
    }
}

// Settings Functions
function renderSettings() {
    document.getElementById('settings-username').value = userSettings.username;
    document.getElementById('settings-email').value = userSettings.email;
    document.getElementById('settings-about').value = userSettings.about;
    document.getElementById('settings-fontsize').value = userSettings.fontSize;
    document.getElementById('settings-timeformat').value = userSettings.timeFormat;
    document.getElementById('settings-daily-goal').value = userSettings.dailyGoalHours;
    document.getElementById('settings-pomodoro').value = userSettings.pomodoroDuration;
    document.getElementById('settings-break').value = userSettings.breakDuration;
}

function saveSettings() {
    userSettings.username = document.getElementById('settings-username').value;
    userSettings.email = document.getElementById('settings-email').value;
    userSettings.about = document.getElementById('settings-about').value;
    userSettings.fontSize = document.getElementById('settings-fontsize').value;
    userSettings.timeFormat = document.getElementById('settings-timeformat').value;
    userSettings.dailyGoalHours = parseInt(document.getElementById('settings-daily-goal').value) || 3;
    userSettings.pomodoroDuration = parseInt(document.getElementById('settings-pomodoro').value) || 25;
    userSettings.breakDuration = parseInt(document.getElementById('settings-break').value) || 5;
    
    pomodoroSettings.workTime = userSettings.pomodoroDuration;
    pomodoroSettings.breakTime = userSettings.breakDuration;
    studyGoals.daily = userSettings.dailyGoalHours;
    
    saveData();
    showSuccessToast('‚úÖ Settings Saved!');
}

function applyFontSize() {
    const size = document.getElementById('settings-fontsize').value;
    if (size === 'small') {
        document.documentElement.style.fontSize = '12px';
    } else if (size === 'large') {
        document.documentElement.style.fontSize = '16px';
    } else {
        document.documentElement.style.fontSize = '14px';
    }
    userSettings.fontSize = size;
    saveData();
}

function exportAllData() {
    const data = {
        studyData,
        journalData,
        studyStreak,
        bestStreak,
        habits,
        habitProgress,
        badges,
        studyGoals,
        studySessions,
        customRevisionTopics,
        quickNotes,
        flashcardsData,
        userSettings
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `sambhav-study-tracker-${getTodayDate()}.json`;
    a.click();
    URL.revokeObjectURL(url);
    showSuccessToast('üì• Data Exported!');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    input.onchange = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = (event) => {
            try {
                const data = JSON.parse(event.target.result);
                studyData = data.studyData || {};
                journalData = data.journalData || {};
                studyStreak = data.studyStreak || 0;
                bestStreak = data.bestStreak || 0;
                habits = data.habits || [];
                habitProgress = data.habitProgress || {};
                badges = data.badges || [];
                studyGoals = data.studyGoals || {daily: 2, weekly: 14, monthly: 60};
                studySessions = data.studySessions || [];
                customRevisionTopics = data.customRevisionTopics || [];
                quickNotes = data.quickNotes || [];
                flashcardsData = data.flashcardsData || [];
                userSettings = data.userSettings || userSettings;
                
                saveData();
                showSuccessToast('üì§ Data Imported!');
                navigateHome();
            } catch (err) {
                alert('‚ö†Ô∏è Error importing data: ' + err.message);
            }
        };
        reader.readAsText(file);
    };
    input.click();
}

function clearAllData() {
    if (!confirm('‚ö†Ô∏è CLEAR ALL DATA\n\nThis will permanently delete:\n‚Ä¢ All study progress\n‚Ä¢ Journal entries\n‚Ä¢ Study sessions\n‚Ä¢ Flashcards\n‚Ä¢ Notes\n‚Ä¢ Syllabus data\n\nSettings will be kept.\n\nAre you sure?')) {
        return;
    }
    
    if (!confirm('‚ö†Ô∏è FINAL WARNING\n\nThis action CANNOT be undone!\n\nType OK in your mind and click OK to proceed.')) {
        return;
    }
    
    studyData = {};
    journalData = {};
    studyStreak = 0;
    bestStreak = 0;
    habitProgress = {};
    studySessions = [];
    customRevisionTopics = [];
    quickNotes = [];
    flashcardsData = [];
    undoHistory = [];
    syllabusData = {};
    syllabusBreakdownVisible = {};
    demoRevisionTasks = [
        {id: 1, name: "Review Constitutional Articles", completed: false, completedDate: null},
        {id: 2, name: "Practice Previous Year Questions", completed: false, completedDate: null},
        {id: 3, name: "Case Law Study", completed: false, completedDate: null},
        {id: 4, name: "Topic Revision - BNS", completed: false, completedDate: null},
        {id: 5, name: "Daily Revision Summary", completed: false, completedDate: null}
    ];
    
    saveData();
    showSuccessToast('üóëÔ∏è All Data Cleared!');
    
    setTimeout(() => {
        alert('‚úÖ All data has been cleared successfully!\n\nYour settings have been preserved.');
        navigateHome();
        window.location.reload();
    }, 500);
}

function factoryReset() {
    if (!confirm('‚ö†Ô∏è FACTORY RESET\n\nThis will DELETE EVERYTHING:\n‚Ä¢ All study data\n‚Ä¢ All settings\n‚Ä¢ All preferences\n‚Ä¢ Everything will be reset to default\n\nAre you absolutely sure?')) {
        return;
    }
    
    const confirmText = prompt('‚ö†Ô∏è FINAL WARNING\n\nType "RESET" (in capitals) to confirm factory reset:');
    
    if (confirmText !== 'RESET') {
        alert('‚ùå Factory reset cancelled. You must type RESET exactly.');
        return;
    }
    
    window.appData = null;
    
    showSuccessToast('üîÑ Factory Reset Complete!');
    
    setTimeout(() => {
        alert('‚úÖ Factory reset successful!\n\nThe app will now reload with default settings.');
        location.reload();
    }, 500);
}

function navigateHome() {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('home-page').classList.add('active');
}

function showSubjectDetail(subjectId) {
    currentSubject = subjectId;
    const subject = subjects[subjectId];
    document.getElementById('subject-title').textContent = subject.name;
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('subject-detail-page').classList.add('active');
    renderChapterList();
    updateSubjectProgress();
}

// Subject list rendering
function renderSubjectList() {
    const container = document.getElementById('subject-list');
    container.innerHTML = '';
    
    const allSubjects = {...subjects, ...customSubjects};
    
    Object.keys(allSubjects).forEach(subjectId => {
        const subject = allSubjects[subjectId];
        const card = document.createElement('div');
        card.className = 'subject-card';
        card.onclick = (e) => {
            if (!e.target.classList.contains('edit-subject-btn') && !e.target.classList.contains('delete-subject-btn')) {
                showSubjectDetail(subjectId);
            }
        };
        
        const completed = getCompletedCount(subjectId);
        const total = getChapterCount(subjectId);
        const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
        
        const isEditable = subject.editable === true;
        
        card.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                <h3 style="flex: 1; margin: 0;">${subject.name}</h3>
                ${isEditable ? '<button class="btn btn-secondary edit-subject-btn" onclick="editSubjectName(event, \''+subjectId+'\')") style="padding: 4px 8px; font-size: 12px;">‚úèÔ∏è Rename</button>' : ''}
            </div>
            <div class="subject-info">${subject.chapters || total} Chapters</div>
            <div class="subject-info">Progress: ${completed}/${total} (${percentage}%)</div>
            <div class="progress-bar-container" style="margin-top: 12px;">
                <div class="progress-bar" style="width: ${percentage}%;"></div>
                <div class="progress-text">${percentage}%</div>
            </div>
        `;
        container.appendChild(card);
    });
}

function getChapterCount(subjectId) {
    if (!studyData[subjectId]) return 0;
    return Object.keys(studyData[subjectId]).length;
}

function startEditingSubjectName(event, subjectId) {
    event.stopPropagation();
    const subject = subjects[subjectId];
    if (!subject || !subject.editable) {
        return;
    }
    
    const h3Element = event.target;
    const currentName = subject.name;
    
    // Create input field
    const input = document.createElement('input');
    input.type = 'text';
    input.value = currentName;
    input.className = 'form-control';
    input.style.cssText = 'width: 100%; padding: 4px 8px; font-size: 18px; font-weight: 600; font-family: var(--font-family-heading); border: 2px solid var(--color-primary);';
    
    // Replace h3 with input
    h3Element.style.display = 'none';
    h3Element.parentNode.insertBefore(input, h3Element);
    input.focus();
    input.select();
    
    // Save function
    const saveEdit = () => {
        const newName = input.value.trim();
        if (newName && newName !== currentName) {
            subjectNames[subjectId] = newName;
            subjects[subjectId].name = newName;
            saveData();
            saveSubjectNames();
            if (currentSubject === subjectId) {
                document.getElementById('subject-title').textContent = newName;
            }
            showSuccessToast('‚úÖ Subject Renamed!');
            createFirecrackers('subject-list');
        }
        renderSubjectList();
    };
    
    // Event listeners
    input.addEventListener('blur', saveEdit);
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            saveEdit();
        } else if (e.key === 'Escape') {
            renderSubjectList();
        }
    });
}

function editSubjectName(event, subjectId) {
    event.stopPropagation();
    startEditingSubjectName(event, subjectId);
}

function loadSubjectNames() {
    if (window.appData && window.appData.subjectNames) {
        subjectNames = window.appData.subjectNames;
        Object.keys(subjectNames).forEach(id => {
            if (subjects[id]) {
                subjects[id].name = subjectNames[id];
            }
        });
    }
}

function rotateFunFacts() {
    const factEl = document.getElementById('fun-fact-text');
    if (!factEl) return;
    
    factEl.classList.add('fade-out');
    setTimeout(() => {
        factEl.textContent = funFacts[currentFunFactIndex];
        factEl.classList.remove('fade-out');
        factEl.classList.add('fade-in');
        currentFunFactIndex = (currentFunFactIndex + 1) % funFacts.length;
        setTimeout(() => factEl.classList.remove('fade-in'), 800);
    }, 800);
}

function rotateQuotesManual() {
    rotateQuotes();
}

function saveSubjectNames() {
    if (!window.appData) window.appData = {};
    window.appData.subjectNames = subjectNames;
}

function editSubjectNameInline(event, subjectId) {
    event.stopPropagation();
    editSubjectName(event, subjectId);
}

// Chapter list rendering
function renderChapterList() {
    const subject = subjects[currentSubject] || customSubjects[currentSubject];
    const container = document.getElementById('chapter-list');
    container.innerHTML = '';
    
    if (!studyData[currentSubject]) {
        studyData[currentSubject] = {};
    }
    
    const chapters = Object.keys(studyData[currentSubject]).sort((a, b) => parseInt(a) - parseInt(b));
    
    if (chapters.length === 0) {
        container.innerHTML = '<div class="empty-state" style="text-align: center; padding: 40px; color: var(--color-text-secondary);">No chapters added yet. Add your first chapter above! üìö</div>';
        return;
    }
    
    chapters.forEach(index => {
        const chapterData = studyData[currentSubject][index];
        
        const item = document.createElement('div');
        item.className = 'chapter-item' + (chapterData.completed ? ' completed' : '');
        item.setAttribute('data-chapter-index', index);
        item.innerHTML = `
            <div class="chapter-input">
                <input type="checkbox" class="chapter-checkbox" 
                    ${chapterData.completed ? 'checked' : ''} 
                    onchange="toggleChapter('${index}')">
                <div class="chapter-number">Ch. ${parseInt(index) + 1}</div>
                <input type="text" class="chapter-name-input" 
                    placeholder="Chapter name (optional)" 
                    value="${chapterData.name || ''}" 
                    onchange="saveChapterName('${index}', this.value)">
                <input type="date" class="chapter-name-input" 
                    style="flex: 0 0 150px;" 
                    value="${chapterData.date || ''}" 
                    onchange="saveChapterDate('${index}', this.value)">
                <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;" onclick="event.stopPropagation(); deleteChapter('${index}')">üóëÔ∏è Delete</button>
            </div>
            <textarea class="chapter-notes" 
                placeholder="Add notes..." 
                onchange="saveChapterNotes('${index}', this.value)">${chapterData.notes || ''}</textarea>
        `;
        container.appendChild(item);
    });
}

function addSingleChapter() {
    if (!studyData[currentSubject]) {
        studyData[currentSubject] = {};
    }
    
    const existingIndices = Object.keys(studyData[currentSubject]).map(k => parseInt(k));
    const nextIndex = existingIndices.length > 0 ? Math.max(...existingIndices) + 1 : 0;
    
    studyData[currentSubject][nextIndex] = {
        completed: false,
        name: '',
        notes: '',
        date: ''
    };
    
    saveData();
    renderChapterList();
}

function addBulkChapters() {
    const num = parseInt(document.getElementById('num-chapters').value);
    if (!num || num < 1) {
        alert('Please enter a valid number of chapters');
        return;
    }
    
    if (!studyData[currentSubject]) {
        studyData[currentSubject] = {};
    }
    
    const existingIndices = Object.keys(studyData[currentSubject]).map(k => parseInt(k));
    const startIndex = existingIndices.length > 0 ? Math.max(...existingIndices) + 1 : 0;
    
    for (let i = 0; i < num; i++) {
        studyData[currentSubject][startIndex + i] = {
            completed: false,
            name: '',
            notes: '',
            date: ''
        };
    }
    
    saveData();
    renderChapterList();
    updateSubjectProgress();
    document.getElementById('num-chapters').value = '';
}

function deleteChapter(index) {
    if (!confirm('‚ö†Ô∏è Are you sure you want to delete this chapter?\n\nThis action cannot be undone!')) {
        return;
    }
    
    // Animate fade out
    const items = document.querySelectorAll('.chapter-item');
    const itemToDelete = items[parseInt(index)];
    if (itemToDelete) {
        itemToDelete.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
        itemToDelete.style.opacity = '0';
        itemToDelete.style.transform = 'translateX(-20px)';
        
        setTimeout(() => {
            delete studyData[currentSubject][index];
            saveData();
            renderChapterList();
            updateSubjectProgress();
            showSuccessToast('‚úÖ Chapter Deleted!');
            createFirecrackers('chapter-list');
        }, 300);
    } else {
        delete studyData[currentSubject][index];
        saveData();
        renderChapterList();
        updateSubjectProgress();
        showSuccessToast('‚úÖ Chapter Deleted!');
        createFirecrackers('chapter-list');
    }
}

function saveChapterName(index, name) {
    if (!studyData[currentSubject][index]) {
        studyData[currentSubject][index] = {};
    }
    studyData[currentSubject][index].name = name;
    saveData();
}

function saveChapterDate(index, date) {
    if (!studyData[currentSubject][index]) {
        studyData[currentSubject][index] = {};
    }
    studyData[currentSubject][index].date = date;
    if (date) {
        studyData[currentSubject][index].dateCovered = date;
    }
    saveData();
}

// Chapter operations
function toggleChapter(index) {
    if (!studyData[currentSubject][index]) {
        studyData[currentSubject][index] = {};
    }
    
    const wasCompleted = studyData[currentSubject][index].completed;
    studyData[currentSubject][index].completed = !wasCompleted;
    
    if (!wasCompleted) {
        if (!studyData[currentSubject][index].date) {
            studyData[currentSubject][index].date = getTodayDate();
        }
        studyData[currentSubject][index].dateCovered = studyData[currentSubject][index].date || getTodayDate();
        updateStudyStreak();
        checkBadges();
        showSuccessToast();
    }
    
    saveData();
    renderChapterList();
    updateSubjectProgress();
    animateProgressBar('subject-progress-bar');
    createFirecrackers('subject-progress-bar');
}

function saveChapterNotes(index, notes) {
    if (!studyData[currentSubject][index]) {
        studyData[currentSubject][index] = {};
    }
    studyData[currentSubject][index].notes = notes;
    saveData();
}

function createFirecrackers(barId) {
    const bar = document.getElementById(barId);
    if (!bar) return;
    
    const colors = ['#FF0000', '#FFA500', '#FFFF00', '#00FF00', '#0000FF', '#FF00FF'];
    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight / 2;
    
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const particle = document.createElement('div');
            particle.className = 'firecracker';
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];
            particle.style.left = centerX + 'px';
            particle.style.top = centerY + 'px';
            
            const angle = Math.random() * Math.PI * 2;
            const distance = 80 + Math.random() * 150;
            const tx = Math.cos(angle) * distance;
            const ty = -Math.abs(Math.sin(angle) * distance) - 50;
            
            particle.style.setProperty('--tx', tx + 'px');
            particle.style.setProperty('--ty', ty + 'px');
            
            document.body.appendChild(particle);
            particle.style.animation = 'explode 2s ease-out forwards';
            
            setTimeout(() => particle.remove(), 2000);
        }, i * 30);
    }
}

// Progress calculation
function getCompletedCount(subjectId) {
    if (!studyData[subjectId]) return 0;
    return Object.values(studyData[subjectId]).filter(c => c.completed).length;
}

function updateSubjectProgress() {
    const subject = subjects[currentSubject] || customSubjects[currentSubject];
    const completed = getCompletedCount(currentSubject);
    const total = getChapterCount(currentSubject);
    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
    
    const bar = document.getElementById('subject-progress-bar');
    const text = document.getElementById('subject-progress-text');
    bar.style.width = percentage + '%';
    text.textContent = percentage + '%';
    
    bar.className = 'progress-bar';
    if (percentage >= 75) {
        bar.classList.add('high');
    } else if (percentage >= 50) {
        bar.classList.add('medium');
    } else {
        bar.classList.add('low');
    }
}

function animateProgressBar(barId) {
    const bar = document.getElementById(barId);
    bar.classList.add('animating');
    setTimeout(() => bar.classList.remove('animating'), 800);
}

// Revision page
function renderRevisionPage() {
    checkAndResetDailyRevisionTasks();
    renderDemoRevisionTasks();
    renderTodayRevision();
    renderAllRevision();
    updateRevisionProgress();
}

function checkAndResetDailyRevisionTasks() {
    const today = getTodayDate();
    if (lastRevisionResetDate !== today) {
        // Save yesterday's completion to history if needed
        if (lastRevisionResetDate) {
            const completed = demoRevisionTasks.filter(t => t.completed).length;
            // You can store history here if needed
        }
        
        // Reset all tasks
        demoRevisionTasks.forEach(task => {
            task.completed = false;
            task.completedDate = null;
        });
        
        lastRevisionResetDate = today;
        saveData();
    }
}

function renderDemoRevisionTasks() {
    const container = document.getElementById('demo-revision-tasks-list');
    if (!container) return;
    
    const completed = demoRevisionTasks.filter(t => t.completed).length;
    const total = demoRevisionTasks.length;
    const percentage = Math.round((completed / total) * 100);
    
    // Update header stats
    const completedEl = document.getElementById('revision-tasks-completed');
    const percentageEl = document.getElementById('revision-tasks-percentage');
    if (completedEl) completedEl.textContent = completed;
    if (percentageEl) percentageEl.textContent = percentage + '%';
    
    // Update progress bar
    const progressBar = document.getElementById('revision-tasks-progress-bar');
    const progressText = document.getElementById('revision-tasks-progress-text');
    if (progressBar) {
        progressBar.style.width = percentage + '%';
        progressBar.className = 'progress-bar';
        if (percentage >= 75) progressBar.classList.add('high');
        else if (percentage >= 50) progressBar.classList.add('medium');
        else progressBar.classList.add('low');
    }
    if (progressText) progressText.textContent = percentage + '%';
    
    // Render tasks with delete functionality
    container.innerHTML = demoRevisionTasks.map((task, index) => {
        const strikethrough = task.completed ? 'text-decoration: line-through; text-decoration-color: #F44336; text-decoration-thickness: 3px; color: var(--color-text-secondary);' : '';
        return `
            <div class="revision-item ${task.completed ? 'completed' : ''}" style="margin-bottom: 12px; display: flex; align-items: center; gap: 12px; padding: 16px; background: ${task.completed ? 'rgba(76, 175, 80, 0.1)' : 'var(--color-surface)'}; border: 2px solid ${task.completed ? 'rgba(76, 175, 80, 0.3)' : 'var(--color-border)'}; border-radius: 12px; transition: all 0.3s ease;">
                <input type="checkbox" class="revision-checkbox" 
                    ${task.completed ? 'checked' : ''}
                    onchange="toggleDemoRevisionTask(${index})"
                    style="width: 24px; height: 24px; cursor: pointer;">
                <div class="revision-content" style="flex: 1;">
                    <span class="task-name" id="task-name-${index}" 
                        ondblclick="editTaskName(${index})"
                        style="font-family: var(--font-family-heading); font-weight: 600; font-size: 16px; cursor: pointer; padding: 5px 10px; border-radius: 4px; transition: background 0.2s; ${strikethrough}" 
                        title="Double-click to edit"
                        onmouseover="this.style.background='rgba(100, 150, 255, 0.1)'"
                        onmouseout="this.style.background='transparent'">
                        ${task.name}
                    </span>
                    <input type="text" class="task-input" id="task-input-${index}" 
                        value="${task.name}"
                        style="display: none; border: 2px solid #2196F3; padding: 5px 8px; border-radius: 4px; font-size: 16px; font-family: var(--font-family-heading); outline: none; width: 100%; box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);">
                    ${task.completed && task.completedDate ? `<div class="revision-date" style="font-size: 12px; color: var(--color-success); margin-top: 4px;">‚úì Completed on ${task.completedDate}</div>` : '<div class="revision-date" style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">üí° Double-click task name to edit</div>'}
                </div>
                <button class="btn btn-secondary" style="padding: 6px 10px; font-size: 11px; background: rgba(244, 67, 54, 0.1); color: var(--color-error); border: 1px solid var(--color-error); flex-shrink: 0; margin-left: 8px;" onclick="event.stopPropagation(); deleteRevisionTask(${index})" title="Delete this task">üóëÔ∏è</button>
            </div>
        `;
    }).join('');
    
    // Show celebration if all completed
    if (completed === total && total > 0 && !window.revisionTasksCelebrated) {
        window.revisionTasksCelebrated = true;
        setTimeout(() => {
            showSuccessToast('üéâ All Tasks Complete!');
            createFirecrackers('revision-tasks-progress-bar');
        }, 300);
    } else if (completed < total) {
        window.revisionTasksCelebrated = false;
    }
}

function toggleDemoRevisionTask(index) {
    const task = demoRevisionTasks[index];
    task.completed = !task.completed;
    task.completedDate = task.completed ? getTodayDate() : null;
    
    saveData();
    renderDemoRevisionTasks();
    
    if (task.completed) {
        showSuccessToast('‚úÖ Task Completed!');
        animateProgressBar('revision-tasks-progress-bar');
    }
}

function editTaskName(taskId) {
    // Hide the text span
    const taskNameEl = document.getElementById(`task-name-${taskId}`);
    const inputField = document.getElementById(`task-input-${taskId}`);
    
    if (!taskNameEl || !inputField) return;
    
    taskNameEl.style.display = 'none';
    inputField.style.display = 'inline-block';
    inputField.focus();
    inputField.select();
    
    // Save on Enter or blur
    inputField.onkeydown = function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            saveTaskName(taskId, inputField.value);
        } else if (e.key === 'Escape') {
            e.preventDefault();
            cancelEdit(taskId);
        }
    };
    
    inputField.onblur = function() {
        saveTaskName(taskId, inputField.value);
    };
}

function saveTaskName(taskId, newName) {
    if (!newName || !newName.trim()) {
        cancelEdit(taskId);
        return;
    }
    
    // Update in data
    demoRevisionTasks[taskId].name = newName.trim();
    
    // Save to storage
    saveData();
    
    // Update UI
    const taskNameEl = document.getElementById(`task-name-${taskId}`);
    const inputField = document.getElementById(`task-input-${taskId}`);
    
    if (taskNameEl) {
        taskNameEl.textContent = newName.trim();
        taskNameEl.style.display = 'inline';
    }
    if (inputField) {
        inputField.style.display = 'none';
    }
    
    // Show success feedback
    showSuccessToast(`‚úÖ Task updated: ${newName.trim()}`);
}

function cancelEdit(taskId) {
    const taskNameEl = document.getElementById(`task-name-${taskId}`);
    const inputField = document.getElementById(`task-input-${taskId}`);
    
    if (taskNameEl) taskNameEl.style.display = 'inline';
    if (inputField) {
        inputField.style.display = 'none';
        inputField.value = demoRevisionTasks[taskId].name;
    }
}

function deleteRevisionTask(index) {
    if (demoRevisionTasks.length <= 1) {
        alert('‚ö†Ô∏è Cannot delete the last task!\n\nYou must have at least one revision task.');
        return;
    }
    
    const task = demoRevisionTasks[index];
    
    if (!confirm(`‚ö†Ô∏è Delete this revision task?\n\n"${task.name}"\n\nThis action cannot be undone!`)) {
        return;
    }
    
    demoRevisionTasks.splice(index, 1);
    saveData();
    renderDemoRevisionTasks();
    showSuccessToast('üóëÔ∏è Task Deleted!');
    createFirecrackers('demo-revision-tasks-list');
}

function resetRevisionTasks() {
    if (!confirm('üîÑ Reset all revision tasks?\n\nThis will uncheck all tasks and clear completion status.')) {
        return;
    }
    
    demoRevisionTasks.forEach(task => {
        task.completed = false;
        task.completedDate = null;
    });
    
    window.revisionTasksCelebrated = false;
    saveData();
    renderDemoRevisionTasks();
    showSuccessToast('üîÑ Tasks Reset!');
}



function renderTodayRevision() {
    const container = document.getElementById('today-revision-list');
    const today = new Date();
    const revisionItems = [];
    
    Object.keys(studyData).forEach(subjectId => {
        Object.keys(studyData[subjectId]).forEach(index => {
            const chapter = studyData[subjectId][index];
            if (chapter.completed && chapter.dateCovered) {
                const coveredDate = new Date(chapter.dateCovered);
                const daysDiff = Math.floor((today - coveredDate) / (1000 * 60 * 60 * 24));
                
                if (daysDiff >= 3 && daysDiff <= 7) {
                    revisionItems.push({
                        subjectId,
                        index,
                        chapter,
                        daysDiff
                    });
                }
            }
        });
    });
    
    if (revisionItems.length === 0) {
        container.innerHTML = '<div class="empty-state">No topics to revise today. Great job staying on track! üéâ</div>';
    } else {
        container.innerHTML = revisionItems.map(item => {
            const subject = subjects[item.subjectId] || customSubjects[item.subjectId];
            const chapterName = item.chapter.name || `Chapter ${parseInt(item.index) + 1}`;
            const revisionKey = `${item.subjectId}-${item.index}`;
            const isRevised = item.chapter.revised || false;
            
            return `
                <div class="revision-item ${isRevised ? 'completed' : ''}">
                    <input type="checkbox" class="revision-checkbox" 
                        ${isRevised ? 'checked' : ''}
                        onchange="toggleRevision('${revisionKey}')">
                    <div class="revision-content">
                        <div class="revision-topic">${subject.name}: ${chapterName}</div>
                        <div class="revision-date">Covered ${item.daysDiff} days ago ‚Ä¢ ${item.chapter.dateCovered}</div>
                    </div>
                </div>
            `;
        }).join('');
    }
}

function renderAllRevision() {
    const container = document.getElementById('all-revision-list');
    const allItems = [];
    
    Object.keys(studyData).forEach(subjectId => {
        Object.keys(studyData[subjectId]).forEach(index => {
            const chapter = studyData[subjectId][index];
            if (chapter.completed) {
                allItems.push({
                    subjectId,
                    index,
                    chapter
                });
            }
        });
    });
    
    if (allItems.length === 0) {
        container.innerHTML = '<div class="empty-state">Start completing chapters to see them here for revision! üìö</div>';
    } else {
        allItems.sort((a, b) => {
            const dateA = new Date(a.chapter.dateCovered || '2000-01-01');
            const dateB = new Date(b.chapter.dateCovered || '2000-01-01');
            return dateB - dateA;
        });
        
        container.innerHTML = allItems.map(item => {
            const subject = subjects[item.subjectId] || customSubjects[item.subjectId];
            const chapterName = item.chapter.name || `Chapter ${parseInt(item.index) + 1}`;
            const revisionKey = `${item.subjectId}-${item.index}`;
            const isRevised = item.chapter.revised || false;
            
            return `
                <div class="revision-item ${isRevised ? 'completed' : ''}">
                    <input type="checkbox" class="revision-checkbox" 
                        ${isRevised ? 'checked' : ''}
                        onchange="toggleRevision('${revisionKey}')">
                    <div class="revision-content">
                        <div class="revision-topic">${subject.name}: ${chapterName}</div>
                        <div class="revision-date">Covered on ${item.chapter.dateCovered || 'Unknown date'}</div>
                    </div>
                </div>
            `;
        }).join('');
    }
}

function toggleRevision(revisionKey) {
    const parts = revisionKey.split('-');
    const index = parts[parts.length - 1];
    const subjectId = parts.slice(0, -1).join('-');
    if (studyData[subjectId] && studyData[subjectId][index]) {
        studyData[subjectId][index].revised = !studyData[subjectId][index].revised;
        saveData();
        renderRevisionPage();
        animateProgressBar('revision-progress-bar');
        createFirecrackers('revision-progress-bar');
    }
}

function updateRevisionProgress() {
    let totalRevision = 0;
    let completedRevision = 0;
    
    Object.keys(studyData).forEach(subjectId => {
        Object.keys(studyData[subjectId]).forEach(index => {
            const chapter = studyData[subjectId][index];
            if (chapter.completed) {
                totalRevision++;
                if (chapter.revised) completedRevision++;
            }
        });
    });
    
    customRevisionTopics.forEach(topic => {
        totalRevision++;
        if (topic.revised) completedRevision++;
    });
    
    const percentage = totalRevision > 0 ? Math.round((completedRevision / totalRevision) * 100) : 0;
    const bar = document.getElementById('revision-progress-bar');
    const text = document.getElementById('revision-progress-text');
    if (bar && text) {
        bar.style.width = percentage + '%';
        text.textContent = percentage + '%';
        bar.className = 'progress-bar';
        if (percentage >= 75) {
            bar.classList.add('high');
        } else if (percentage >= 50) {
            bar.classList.add('medium');
        } else {
            bar.classList.add('low');
        }
    }
}

// Analytics page
function renderAnalytics() {
    renderTodayProgress();
    renderStudyStreak();
    renderTotalCompleted();
    renderMonthlyCalendar();
    renderWeeklyChart();
    renderSubjectPieChart();
    renderEfficiencyRating();
    renderProductiveHours();
}

function renderEfficiencyRating() {
    const container = document.getElementById('efficiency-rating');
    if (!container) return;
    
    const today = getTodayDate();
    let todayMinutes = 0;
    let todayChapters = 0;
    
    studySessions.forEach(session => {
        if (session.date === today) {
            todayMinutes += session.minutes;
        }
    });
    
    Object.keys(studyData).forEach(subjectId => {
        Object.values(studyData[subjectId]).forEach(chapter => {
            if (chapter.completed && chapter.dateCovered === today) {
                todayChapters++;
            }
        });
    });
    
    const efficiency = todayMinutes > 0 ? (todayChapters / (todayMinutes / 60)).toFixed(2) : 0;
    const qualityScore = todayChapters >= 3 ? 'Excellent' : todayChapters >= 1 ? 'Good' : 'Start studying!';
    const color = todayChapters >= 3 ? 'var(--color-success)' : todayChapters >= 1 ? 'var(--color-warning)' : 'var(--color-error)';
    
    container.innerHTML = `
        <div style="text-align: center;">
            <div style="font-size: 48px; font-weight: bold; color: ${color}; margin-bottom: 8px;">${efficiency}</div>
            <div style="font-size: 14px; color: var(--color-text-secondary); margin-bottom: 16px;">Chapters per hour</div>
            <div style="padding: 12px; background: var(--color-secondary); border-radius: 8px; border: 1px solid var(--color-border);">
                <div style="font-weight: bold; color: var(--color-text); margin-bottom: 4px;">Quality Rating: ${qualityScore}</div>
                <div style="font-size: 12px; color: var(--color-text-secondary);">Today: ${todayChapters} chapters in ${(todayMinutes / 60).toFixed(1)} hours</div>
            </div>
        </div>
    `;
}

function renderProductiveHours() {
    const container = document.getElementById('productive-hours');
    if (!container) return;
    
    const hourData = {};
    
    studySessions.forEach(session => {
        const hour = parseInt(session.time.split(':')[0]);
        hourData[hour] = (hourData[hour] || 0) + session.minutes;
    });
    
    const sortedHours = Object.entries(hourData)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 3);
    
    if (sortedHours.length === 0) {
        container.innerHTML = '<div class="empty-state">Start tracking study time to see your most productive hours! ‚è∞</div>';
        return;
    }
    
    container.innerHTML = sortedHours.map((item, index) => {
        const hour = parseInt(item[0]);
        const minutes = item[1];
        const timeStr = `${hour}:00 - ${hour + 1}:00`;
        const medals = ['ü•á', 'ü•à', 'ü•â'];
        return `
            <div style="padding: 12px; background: var(--color-bg-${index + 1}); border-radius: 8px; margin-bottom: 8px; border: 1px solid var(--color-border);">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-weight: bold; color: var(--color-text);">${medals[index]} ${timeStr}</div>
                        <div style="font-size: 12px; color: var(--color-text-secondary);">${(minutes / 60).toFixed(1)} hours studied</div>
                    </div>
                </div>
            </div>
        `;
    }).join('');
}

function renderWeeklyChart() {
    const container = document.getElementById('weekly-visualization');
    if (!container) return;
    
    const weekData = [];
    let totalHours = 0;
    let totalTopics = 0;
    let currentStreak = 0;
    
    for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        const dayName = date.toLocaleDateString('en-IN', {weekday: 'short'});
        
        let minutes = 0;
        let topics = 0;
        
        studySessions.forEach(session => {
            if (session.date === dateStr) {
                minutes += session.minutes;
            }
        });
        
        Object.keys(studyData).forEach(subjectId => {
            Object.values(studyData[subjectId]).forEach(chapter => {
                if (chapter.completed && chapter.dateCovered === dateStr) {
                    topics++;
                }
            });
        });
        
        const hours = minutes / 60;
        totalHours += hours;
        totalTopics += topics;
        if (hours > 0) currentStreak++;
        
        weekData.push({
            day: dayName,
            hours: hours.toFixed(1),
            topics: topics,
            date: dateStr
        });
    }
    
    container.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
            <div style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(147, 51, 234, 0.1) 100%); padding: 20px; border-radius: 12px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 14px; color: var(--color-text-secondary); margin-bottom: 8px; font-family: var(--font-family-heading);">This Week</div>
                <div style="font-size: 36px; font-weight: 700; color: var(--color-primary); font-family: var(--font-family-accent);">${totalHours.toFixed(1)}h</div>
                <div style="font-size: 12px; color: var(--color-text-secondary);">Total Study Time</div>
            </div>
            <div style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%); padding: 20px; border-radius: 12px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 14px; color: var(--color-text-secondary); margin-bottom: 8px; font-family: var(--font-family-heading);">Topics Covered</div>
                <div style="font-size: 36px; font-weight: 700; color: var(--color-success); font-family: var(--font-family-accent);">${totalTopics}</div>
                <div style="font-size: 12px; color: var(--color-text-secondary);">Chapters Completed</div>
            </div>
            <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(249, 115, 22, 0.1) 100%); padding: 20px; border-radius: 12px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 14px; color: var(--color-text-secondary); margin-bottom: 8px; font-family: var(--font-family-heading);">Active Days</div>
                <div style="font-size: 36px; font-weight: 700; color: var(--color-warning); font-family: var(--font-family-accent);">${currentStreak}</div>
                <div style="font-size: 12px; color: var(--color-text-secondary);">Days This Week</div>
            </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px;">
            ${weekData.map(day => {
                const intensity = Math.min(parseFloat(day.hours) / 3, 1);
                const bgColor = intensity > 0 ? `rgba(76, 175, 80, ${0.2 + intensity * 0.6})` : 'var(--color-secondary)';
                return `
                    <div style="background: ${bgColor}; padding: 12px; border-radius: 8px; text-align: center; border: 1px solid var(--color-border); cursor: pointer;" title="${day.date}\n${day.hours}h studied\n${day.topics} topics">
                        <div style="font-size: 12px; font-weight: 600; color: var(--color-text); margin-bottom: 4px; font-family: var(--font-family-heading);">${day.day}</div>
                        <div style="font-size: 18px; font-weight: 700; color: var(--color-success); font-family: var(--font-family-accent);">${day.hours}h</div>
                        <div style="font-size: 11px; color: var(--color-text-secondary);">${day.topics} topics</div>
                    </div>
                `;
            }).join('')}
        </div>
    `;
}

function renderSubjectPieChart() {
    const canvas = document.getElementById('subject-pie-chart');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    const subjectData = {};
    
    studySessions.forEach(session => {
        const subjectName = subjects[session.subject]?.name || session.subject;
        subjectData[subjectName] = (subjectData[subjectName] || 0) + session.minutes;
    });
    
    const labels = Object.keys(subjectData);
    const data = Object.values(subjectData).map(m => m / 60);
    const colors = ['#1FB8CD', '#FFC185', '#B4413C', '#ECEBD5', '#5D878F', '#DB4545', '#D2BA4C', '#964325', '#944454', '#13343B'];
    
    if (window.pieChartInstance) {
        window.pieChartInstance.destroy();
    }
    
    if (labels.length === 0) {
        ctx.font = '16px Arial';
        ctx.fillStyle = '#666';
        ctx.textAlign = 'center';
        ctx.fillText('No study data yet', canvas.width / 2, canvas.height / 2);
        return;
    }
    
    window.pieChartInstance = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: data,
                backgroundColor: colors.slice(0, labels.length),
                borderWidth: 2,
                borderColor: '#fff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
}

function renderTodayProgress() {
    const today = getTodayDate();
    let todayCount = 0;
    
    Object.keys(studyData).forEach(subjectId => {
        Object.keys(studyData[subjectId]).forEach(index => {
            const chapter = studyData[subjectId][index];
            if (chapter.completed && chapter.dateCovered === today) {
                todayCount++;
            }
        });
    });
    
    const totalChapters = Object.keys(subjects).reduce((sum, subjectId) => {
        return sum + subjects[subjectId].parts.length;
    }, 0);
    
    const percentage = totalChapters > 0 ? Math.round((todayCount / totalChapters) * 100) : 0;
    
    document.getElementById('today-progress').textContent = percentage + '%';
    const bar = document.getElementById('today-progress-bar');
    bar.style.width = percentage + '%';
    
    bar.className = 'progress-bar';
    if (percentage >= 75) {
        bar.classList.add('high');
    } else if (percentage >= 50) {
        bar.classList.add('medium');
    } else {
        bar.classList.add('low');
    }
}

function renderStudyStreak() {
    const dates = new Set();
    
    Object.keys(studyData).forEach(subjectId => {
        Object.keys(studyData[subjectId]).forEach(index => {
            const chapter = studyData[subjectId][index];
            if (chapter.completed && chapter.dateCovered) {
                dates.add(chapter.dateCovered);
            }
        });
    });
    
    const sortedDates = Array.from(dates).sort().reverse();
    let streak = 0;
    const today = new Date();
    const todayStr = getTodayDate();
    
    if (dates.has(todayStr)) {
        streak = 1;
        for (let i = 1; i < 365; i++) {
            const checkDate = new Date(today);
            checkDate.setDate(today.getDate() - i);
            const checkStr = checkDate.toISOString().split('T')[0];
            if (dates.has(checkStr)) {
                streak++;
            } else {
                break;
            }
        }
    }
    
    document.getElementById('study-streak').textContent = streak + ' days';
}

function renderTotalCompleted() {
    let total = 0;
    
    Object.keys(studyData).forEach(subjectId => {
        total += getCompletedCount(subjectId);
    });
    
    document.getElementById('total-completed').textContent = total;
}

function renderMonthlyCalendar() {
    const container = document.getElementById('calendar-container');
    const today = new Date();
    const year = today.getFullYear();
    const month = today.getMonth();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    
    const studyMinutes = {};
    Object.keys(studyData).forEach(subjectId => {
        Object.keys(studyData[subjectId]).forEach(index => {
            const chapter = studyData[subjectId][index];
            if (chapter.completed && chapter.dateCovered) {
                const date = new Date(chapter.dateCovered);
                if (date.getMonth() === month && date.getFullYear() === year) {
                    const day = date.getDate();
                    studyMinutes[day] = (studyMinutes[day] || 0) + 30;
                }
            }
        });
    });
    
    studySessions.forEach(session => {
        const date = new Date(session.date);
        if (date.getMonth() === month && date.getFullYear() === year) {
            const day = date.getDate();
            studyMinutes[day] = (studyMinutes[day] || 0) + session.minutes;
        }
    });
    
    container.innerHTML = '';
    for (let day = 1; day <= daysInMonth; day++) {
        const dayDiv = document.createElement('div');
        dayDiv.className = 'calendar-day';
        const minutes = studyMinutes[day] || 0;
        
        if (minutes > 0) {
            dayDiv.classList.add('studied');
            if (minutes >= 180) {
                dayDiv.style.background = 'rgba(76, 175, 80, 0.8)';
            } else if (minutes >= 120) {
                dayDiv.style.background = 'rgba(76, 175, 80, 0.5)';
            } else {
                dayDiv.style.background = 'rgba(76, 175, 80, 0.3)';
            }
        }
        
        if (day === today.getDate() && today.getMonth() === month) dayDiv.classList.add('today');
        dayDiv.textContent = day;
        dayDiv.title = minutes > 0 ? `${(minutes / 60).toFixed(1)} hours` : 'No study';
        container.appendChild(dayDiv);
    }
}

// Journal functions
function renderJournal() {
    const today = getTodayDate();
    document.getElementById('journal-date').textContent = today;
    
    const todayEntry = journalData[today] || '';
    document.getElementById('journal-textarea').value = todayEntry;
    
    updateCharCount();
    renderRecentJournals();
    renderJournalStats();
}

function updateCharCount() {
    const textarea = document.getElementById('journal-textarea');
    const charCount = document.getElementById('char-count');
    if (textarea && charCount) {
        charCount.textContent = textarea.value.length;
    }
}

function renderJournalStats() {
    const statsContainer = document.getElementById('journal-stats');
    if (!statsContainer) return;
    
    const totalEntries = Object.keys(journalData).filter(date => journalData[date].trim() !== '').length;
    const totalWords = Object.values(journalData).reduce((sum, entry) => {
        return sum + entry.trim().split(/\s+/).filter(w => w.length > 0).length;
    }, 0);
    const avgWords = totalEntries > 0 ? Math.round(totalWords / totalEntries) : 0;
    
    const dayFrequency = {};
    Object.keys(journalData).forEach(date => {
        if (journalData[date].trim() !== '') {
            const dayName = new Date(date).toLocaleDateString('en-IN', {weekday: 'long'});
            dayFrequency[dayName] = (dayFrequency[dayName] || 0) + 1;
        }
    });
    
    const mostWrittenDay = Object.keys(dayFrequency).length > 0 
        ? Object.keys(dayFrequency).reduce((a, b) => dayFrequency[a] > dayFrequency[b] ? a : b)
        : 'N/A';
    
    let streak = 0;
    const today = new Date();
    for (let i = 0; i < 365; i++) {
        const checkDate = new Date(today);
        checkDate.setDate(today.getDate() - i);
        const checkStr = checkDate.toISOString().split('T')[0];
        if (journalData[checkStr] && journalData[checkStr].trim() !== '') {
            streak++;
        } else if (i > 0) {
            break;
        }
    }
    
    statsContainer.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
            <div style="background: var(--color-bg-1); padding: 16px; border-radius: 8px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 28px; font-weight: 700; color: var(--color-primary); font-family: var(--font-family-accent);">${totalEntries}</div>
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">Total Entries</div>
            </div>
            <div style="background: var(--color-bg-3); padding: 16px; border-radius: 8px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 28px; font-weight: 700; color: var(--color-success); font-family: var(--font-family-accent);">${avgWords}</div>
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">Avg Words/Entry</div>
            </div>
            <div style="background: var(--color-bg-2); padding: 16px; border-radius: 8px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 18px; font-weight: 700; color: var(--color-warning); font-family: var(--font-family-accent);">${mostWrittenDay}</div>
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">Most Written Day</div>
            </div>
            <div style="background: var(--color-bg-4); padding: 16px; border-radius: 8px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 28px; font-weight: 700; color: var(--color-error); font-family: var(--font-family-accent);">${streak}</div>
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">Day Streak</div>
            </div>
        </div>
    `;
}

function saveJournal() {
    const today = getTodayDate();
    const text = document.getElementById('journal-textarea').value;
    journalData[today] = text;
    saveData();
    renderRecentJournals();
    renderJournalStats();
    showSuccessToast('Journal Saved!');
    createFirecrackers('journal-textarea');
}

function changeJournalFont() {
    const font = document.getElementById('journal-font-select').value;
    const textarea = document.getElementById('journal-textarea');
    textarea.style.fontFamily = font + ', sans-serif';
}

function formatJournalText(format) {
    alert('üí° Tip: Use markdown-style formatting:\n\n**bold** for bold\n*italic* for italic\n_underline_ for underline');
}

function clearJournal() {
    if (confirm('Are you sure you want to clear today\'s journal entry?')) {
        document.getElementById('journal-textarea').value = '';
    }
}

function renderRecentJournals() {
    const container = document.getElementById('recent-journals');
    const entries = Object.keys(journalData)
        .filter(date => journalData[date].trim() !== '')
        .sort()
        .reverse()
        .slice(0, 7);
    
    if (entries.length === 0) {
        container.innerHTML = '<div class="empty-state">No journal entries yet. Start writing! ‚úçÔ∏è</div>';
    } else {
        container.innerHTML = entries.map(date => `
            <div class="journal-entry" style="margin-top: 12px; background: var(--color-bg-1); border-left: 4px solid var(--color-primary); position: relative;">
                <div style="display: flex; justify-content: space-between; align-items: start; gap: 12px;">
                    <div style="flex: 1; cursor: pointer;" onclick="viewJournalEntry('${date}')">
                        <div style="color: var(--color-primary); font-weight: 600; margin-bottom: 8px; font-family: var(--font-family-heading);">${date}</div>
                        <div style="color: var(--color-text-secondary); font-size: 14px; line-height: 1.5;">${journalData[date].substring(0, 120)}${journalData[date].length > 120 ? '...' : ''}</div>
                        <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 8px;">${journalData[date].split(/\s+/).filter(w => w.length > 0).length} words</div>
                    </div>
                    <button class="btn btn-secondary" style="padding: 4px 10px; font-size: 11px; background: var(--color-error); color: white;" onclick="event.stopPropagation(); deleteJournalEntry('${date}')">üóëÔ∏è</button>
                </div>
            </div>
        `).join('');
    }
}

function viewJournalEntry(date) {
    const entry = journalData[date];
    if (entry) {
        alert('üìù Entry from ' + date + ':\n\n' + entry);
    }
}

function deleteJournalEntry(date) {
    if (!confirm('‚ö†Ô∏è Delete journal entry from ' + date + '?\n\nThis action cannot be undone!')) {
        return;
    }
    
    delete journalData[date];
    saveData();
    renderRecentJournals();
    renderJournalStats();
    showSuccessToast('üóëÔ∏è Journal Entry Deleted!');
    createFirecrackers('recent-journals');
}

// Data persistence (in-memory storage only - sandbox restriction)
function saveData() {
    window.appData = {
        studyData: studyData,
        journalData: journalData,
        studyStreak: studyStreak,
        bestStreak: bestStreak,
        lastStudyDate: lastStudyDate,
        habits: habits,
        habitProgress: habitProgress,
        flashcards: flashcards,
        badges: badges,
        darkMode: darkMode,
        studyGoals: studyGoals,
        pomodoroSettings: pomodoroSettings,
        dailyStudyTime: dailyStudyTime,
        studySessions: studySessions,
        subjectNames: subjectNames,
        customRevisionTopics: customRevisionTopics,
        demoRevisionTasks: demoRevisionTasks,
        lastRevisionResetDate: lastRevisionResetDate,
        quickNotes: quickNotes,
        flashcardsData: flashcardsData,
        habitWeeklyData: habitWeeklyData,
        undoHistory: undoHistory,
        userSettings: userSettings,
        syllabusData: syllabusData,
        syllabusBreakdownVisible: syllabusBreakdownVisible
    };
}

function loadData() {
    if (window.appData) {
        studyData = window.appData.studyData || {};
        journalData = window.appData.journalData || {};
        customSubjects = {};
        studyStreak = window.appData.studyStreak || 0;
        bestStreak = window.appData.bestStreak || 0;
        lastStudyDate = window.appData.lastStudyDate || '';
        habits = window.appData.habits || defaultHabits.slice();
        habitProgress = window.appData.habitProgress || {};
        flashcards = window.appData.flashcards || [];
        badges = window.appData.badges || [];
        darkMode = window.appData.darkMode || false;
        studyGoals = window.appData.studyGoals || {daily: 2, weekly: 14, monthly: 60};
        pomodoroSettings = window.appData.pomodoroSettings || {workTime: 25, breakTime: 5};
        dailyStudyTime = window.appData.dailyStudyTime || 0;
        studySessions = window.appData.studySessions || [];
        subjectNames = window.appData.subjectNames || {};
        customRevisionTopics = window.appData.customRevisionTopics || [];
        demoRevisionTasks = window.appData.demoRevisionTasks || [
            {id: 1, name: "Review Constitutional Articles", completed: false, completedDate: null},
            {id: 2, name: "Practice Previous Year Questions", completed: false, completedDate: null},
            {id: 3, name: "Case Law Study", completed: false, completedDate: null},
            {id: 4, name: "Topic Revision - BNS", completed: false, completedDate: null},
            {id: 5, name: "Daily Revision Summary", completed: false, completedDate: null}
        ];
        lastRevisionResetDate = window.appData.lastRevisionResetDate || '';
        quickNotes = window.appData.quickNotes || [];
        flashcardsData = window.appData.flashcardsData || [];
        habitWeeklyData = window.appData.habitWeeklyData || {};
        undoHistory = window.appData.undoHistory || [];
        userSettings = window.appData.userSettings || {username: 'Sambhav', email: '', about: '', fontSize: 'normal', timeFormat: '12', dailyGoalHours: 3, pomodoroDuration: 25, breakDuration: 5};
        syllabusData = window.appData.syllabusData || {};
        syllabusBreakdownVisible = window.appData.syllabusBreakdownVisible || {};
    }
    updateDailyStudyDisplay();
    populateSubjectDropdown();
    updateUndoButton();
}

// Pomodoro functions
function renderPomodoro() {
    document.getElementById('work-time-input').value = pomodoroSettings.workTime;
    document.getElementById('break-time-input').value = pomodoroSettings.breakTime;
    if (!pomodoroActive) {
        pomodoroTimeLeft = pomodoroSettings.workTime * 60;
        updatePomodoroDisplay();
    }
    renderSessionHistory();
}

function renderSessionHistory() {
    const container = document.getElementById('session-history');
    if (!container) return;
    
    const today = getTodayDate();
    const todaySessions = studySessions.filter(s => s.date === today);
    
    if (todaySessions.length === 0) {
        container.innerHTML = '<div class="empty-state">No study sessions today. Start one now! ‚è±Ô∏è</div>';
        return;
    }
    
    container.innerHTML = todaySessions.map((session, globalIndex) => {
        const subjectName = subjects[session.subject]?.name || session.subject;
        const color = session.type === 'pomodoro' ? 'var(--color-bg-1)' : 'var(--color-bg-3)';
        const sessionIndex = studySessions.indexOf(session);
        return `
            <div style="padding: 12px; background: ${color}; border-radius: 8px; margin-bottom: 8px; border: 1px solid var(--color-border);">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="flex: 1;">
                        <div style="font-weight: bold; color: var(--color-text);">${subjectName}</div>
                        <div style="font-size: 12px; color: var(--color-text-secondary);">${session.time} ‚Ä¢ ${session.minutes} minutes</div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="font-size: 20px;">${session.type === 'pomodoro' ? '‚è±Ô∏è' : '‚úèÔ∏è'}</div>
                        <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 11px; background: var(--color-error); color: white;" onclick="deleteStudySession(${sessionIndex})">üóëÔ∏è</button>
                    </div>
                </div>
            </div>
        `;
    }).join('');
}

function deleteStudySession(index) {
    if (!confirm('‚ö†Ô∏è Delete this study session?\n\nThis will reduce your daily study time.')) {
        return;
    }
    
    const session = studySessions[index];
    studySessions.splice(index, 1);
    
    // Update daily study time
    dailyStudyTime = Math.max(0, dailyStudyTime - session.minutes);
    
    saveData();
    renderSessionHistory();
    updateDailyStudyDisplay();
    showSuccessToast('üóëÔ∏è Session Deleted!');
    createFirecrackers('session-history');
}

function updatePomodoroSettings() {
    pomodoroSettings.workTime = parseInt(document.getElementById('work-time-input').value) || 25;
    pomodoroSettings.breakTime = parseInt(document.getElementById('break-time-input').value) || 5;
    saveData();
    if (!pomodoroActive) {
        pomodoroTimeLeft = pomodoroSettings.workTime * 60;
        updatePomodoroDisplay();
    }
}

function startPomodoro() {
    pomodoroActive = true;
    const startBtn = document.getElementById('pomodoro-start');
    const pauseBtn = document.getElementById('pomodoro-pause');
    const statusEl = document.getElementById('pomodoro-status');
    const homeStatusEl = document.getElementById('home-pomodoro-status');
    
    if (startBtn) startBtn.disabled = true;
    if (pauseBtn) pauseBtn.disabled = false;
    
    const statusText = pomodoroIsBreak ? '‚òï Break time!' : 'üìö Focus time!';
    if (statusEl) statusEl.textContent = statusText;
    if (homeStatusEl) homeStatusEl.textContent = statusText;
    
    pomodoroTimer = setInterval(() => {
        pomodoroTimeLeft--;
        updatePomodoroDisplay();
        
        if (pomodoroTimeLeft <= 0) {
            clearInterval(pomodoroTimer);
            pomodoroActive = false;
            
            if (!pomodoroIsBreak) {
                alert('‚è∞ Great work! Time for a break!');
                pomodoroIsBreak = true;
                pomodoroTimeLeft = pomodoroSettings.breakTime * 60;
                const workSession = {
                    date: getTodayDate(),
                    time: new Date().toLocaleTimeString('en-IN', {hour: '2-digit', minute: '2-digit'}),
                    minutes: pomodoroSettings.workTime,
                    subject: 'pomodoro',
                    type: 'pomodoro'
                };
                studySessions.push(workSession);
                dailyStudyTime += pomodoroSettings.workTime;
                saveData();
                updateDailyStudyDisplay();
            } else {
                alert('‚è∞ Break over! Ready for another session?');
                pomodoroIsBreak = false;
                pomodoroTimeLeft = pomodoroSettings.workTime * 60;
            }
            
            const startBtn = document.getElementById('pomodoro-start');
            const pauseBtn = document.getElementById('pomodoro-pause');
            const statusEl = document.getElementById('pomodoro-status');
            const homeStartBtn = document.getElementById('home-pomodoro-start');
            const homePauseBtn = document.getElementById('home-pomodoro-pause');
            const homeStatusEl = document.getElementById('home-pomodoro-status');
            
            if (startBtn) startBtn.disabled = false;
            if (pauseBtn) pauseBtn.disabled = true;
            if (homeStartBtn) homeStartBtn.disabled = false;
            if (homePauseBtn) homePauseBtn.disabled = true;
            
            const statusText = 'Session complete!';
            if (statusEl) statusEl.textContent = statusText;
            if (homeStatusEl) homeStatusEl.textContent = statusText;
            updatePomodoroDisplay();
        }
    }, 1000);
}

function pausePomodoro() {
    clearInterval(pomodoroTimer);
    pomodoroActive = false;
    const startBtn = document.getElementById('pomodoro-start');
    const pauseBtn = document.getElementById('pomodoro-pause');
    const statusEl = document.getElementById('pomodoro-status');
    const homeStatusEl = document.getElementById('home-pomodoro-status');
    
    if (startBtn) startBtn.disabled = false;
    if (pauseBtn) pauseBtn.disabled = true;
    if (statusEl) statusEl.textContent = 'Paused';
    if (homeStatusEl) homeStatusEl.textContent = 'Paused';
}

function resetPomodoro() {
    clearInterval(pomodoroTimer);
    pomodoroActive = false;
    pomodoroIsBreak = false;
    pomodoroTimeLeft = pomodoroSettings.workTime * 60;
    
    const startBtn = document.getElementById('pomodoro-start');
    const pauseBtn = document.getElementById('pomodoro-pause');
    const statusEl = document.getElementById('pomodoro-status');
    const homeStatusEl = document.getElementById('home-pomodoro-status');
    
    if (startBtn) startBtn.disabled = false;
    if (pauseBtn) pauseBtn.disabled = true;
    if (statusEl) statusEl.textContent = 'Ready to focus';
    if (homeStatusEl) homeStatusEl.textContent = 'Ready to focus';
    updatePomodoroDisplay();
}

function updatePomodoroDisplay() {
    const minutes = Math.floor(pomodoroTimeLeft / 60);
    const seconds = pomodoroTimeLeft % 60;
    const timeStr = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    const pomodoroEl = document.getElementById('pomodoro-display');
    const homePomodoroEl = document.getElementById('home-pomodoro-display');
    if (pomodoroEl) pomodoroEl.textContent = timeStr;
    if (homePomodoroEl) homePomodoroEl.textContent = timeStr;
}

function startPomodoroHome() {
    startPomodoro();
    document.getElementById('home-pomodoro-start').disabled = true;
    document.getElementById('home-pomodoro-pause').disabled = false;
}

function pausePomodoroHome() {
    pausePomodoro();
    document.getElementById('home-pomodoro-start').disabled = false;
    document.getElementById('home-pomodoro-pause').disabled = true;
}

function resetPomodoroHome() {
    resetPomodoro();
    document.getElementById('home-pomodoro-start').disabled = false;
    document.getElementById('home-pomodoro-pause').disabled = true;
}

function addManualStudyTime() {
    const minutes = parseInt(document.getElementById('manual-study-minutes').value);
    const subject = document.getElementById('manual-study-subject').value;
    
    if (!minutes || minutes < 1) {
        alert('‚ö†Ô∏è Please enter valid minutes!');
        return;
    }
    
    if (!subject) {
        alert('‚ö†Ô∏è Please select a subject!');
        return;
    }
    
    const session = {
        date: getTodayDate(),
        time: new Date().toLocaleTimeString('en-IN', {hour: '2-digit', minute: '2-digit'}),
        minutes: minutes,
        subject: subject,
        type: 'manual'
    };
    
    // Add to undo history
    undoHistory.push({type: 'study', session: session});
    if (undoHistory.length > 5) undoHistory.shift();
    
    studySessions.push(session);
    dailyStudyTime += minutes;
    saveData();
    updateDailyStudyDisplay();
    updateUndoButton();
    document.getElementById('manual-study-minutes').value = '';
    showSuccessToast('Study Time Added!');
    createFirecrackers('home-pomodoro-section');
}

function quickAdjustStudyTime() {
    const input = document.getElementById('quick-time-adjust').value.trim();
    
    if (!input) {
        alert('‚ö†Ô∏è Please enter a time adjustment!\n\nExamples:\n+50 (add 50 minutes)\n-30 (reduce 30 minutes)\n+2h (add 2 hours)\n-1h (reduce 1 hour)');
        return;
    }
    
    // Parse the input
    let minutes = 0;
    let isNegative = false;
    
    if (input.startsWith('-')) {
        isNegative = true;
    }
    
    // Check if it's hours (ends with 'h' or 'H')
    if (input.toLowerCase().endsWith('h')) {
        const hours = parseFloat(input.replace(/[^0-9.-]/g, ''));
        if (isNaN(hours)) {
            alert('‚ö†Ô∏è Invalid format! Use: +2h or -1h');
            return;
        }
        minutes = Math.abs(hours) * 60;
    } else {
        // It's minutes
        minutes = Math.abs(parseFloat(input.replace(/[^0-9.-]/g, '')));
        if (isNaN(minutes)) {
            alert('‚ö†Ô∏è Invalid format! Use: +50 or -30');
            return;
        }
    }
    
    // Get current total for today
    const today = getTodayDate();
    let currentTotal = 0;
    studySessions.forEach(session => {
        if (session.date === today) {
            currentTotal += session.minutes;
        }
    });
    
    let newTotal;
    let message;
    
    if (isNegative) {
        // Reduce time
        newTotal = Math.max(0, currentTotal - minutes);
        const actualReduced = currentTotal - newTotal;
        
        if (newTotal === 0 && currentTotal > 0) {
            if (!confirm('‚ö†Ô∏è This will reduce your study time to 0 minutes.\n\nCurrent: ' + formatMinutes(currentTotal) + '\nAfter: 0 mins\n\nContinue?')) {
                return;
            }
        }
        
        // Create a negative session to represent reduction
        const session = {
            date: today,
            time: new Date().toLocaleTimeString('en-IN', {hour: '2-digit', minute: '2-digit'}),
            minutes: -actualReduced,
            subject: 'adjustment',
            type: 'adjustment'
        };
        studySessions.push(session);
        message = '‚úÖ Reduced by ' + formatMinutes(actualReduced) + '!\nNew total: ' + formatMinutes(newTotal);
    } else {
        // Add time
        const session = {
            date: today,
            time: new Date().toLocaleTimeString('en-IN', {hour: '2-digit', minute: '2-digit'}),
            minutes: minutes,
            subject: 'adjustment',
            type: 'adjustment'
        };
        studySessions.push(session);
        newTotal = currentTotal + minutes;
        message = '‚úÖ Added ' + formatMinutes(minutes) + '!\nNew total: ' + formatMinutes(newTotal);
    }
    
    saveData();
    updateDailyStudyDisplay();
    document.getElementById('quick-time-adjust').value = '';
    showSuccessToast(isNegative ? 'Time Reduced!' : 'Time Added!');
    
    // Show detailed message
    setTimeout(() => {
        alert(message);
    }, 100);
}

function formatMinutes(minutes) {
    const hrs = Math.floor(Math.abs(minutes) / 60);
    const mins = Math.abs(minutes) % 60;
    if (hrs > 0) {
        return hrs + ' hr' + (hrs !== 1 ? 's' : '') + (mins > 0 ? ' ' + mins + ' min' + (mins !== 1 ? 's' : '') : '');
    }
    return mins + ' min' + (mins !== 1 ? 's' : '');
}

function undoLastStudyEntry() {
    if (undoHistory.length === 0) return;
    
    const lastAction = undoHistory.pop();
    if (lastAction.type === 'study') {
        const index = studySessions.findIndex(s => 
            s.date === lastAction.session.date && 
            s.time === lastAction.session.time && 
            s.minutes === lastAction.session.minutes
        );
        if (index !== -1) {
            studySessions.splice(index, 1);
            dailyStudyTime -= lastAction.session.minutes;
            saveData();
            updateDailyStudyDisplay();
            updateUndoButton();
            showSuccessToast('‚Ü©Ô∏è Entry Undone!');
        }
    }
}

function updateUndoButton() {
    const undoBtn = document.getElementById('undo-study-btn');
    const lastActionDisplay = document.getElementById('last-action-display');
    
    if (undoBtn) {
        undoBtn.disabled = undoHistory.length === 0;
    }
    
    if (lastActionDisplay && undoHistory.length > 0) {
        const lastAction = undoHistory[undoHistory.length - 1];
        if (lastAction.type === 'study') {
            const subjectName = subjects[lastAction.session.subject]?.name || lastAction.session.subject;
            lastActionDisplay.textContent = `Last: +${lastAction.session.minutes} mins ${subjectName} at ${lastAction.session.time}`;
        }
    } else if (lastActionDisplay) {
        lastActionDisplay.textContent = '';
    }
}

function updateDailyStudyDisplay() {
    const today = getTodayDate();
    let todayMinutes = 0;
    
    studySessions.forEach(session => {
        if (session.date === today) {
            todayMinutes += session.minutes;
        }
    });
    
    const hours = Math.floor(todayMinutes / 60);
    const mins = todayMinutes % 60;
    
    const displayEl = document.getElementById('daily-study-display');
    if (displayEl) {
        displayEl.textContent = `${hours} hrs ${mins} mins`;
    }
}

function populateSubjectDropdown() {
    const select = document.getElementById('manual-study-subject');
    if (!select) return;
    
    select.innerHTML = '<option value="">Select Subject</option>';
    Object.keys(subjects).forEach(id => {
        const option = document.createElement('option');
        option.value = id;
        option.textContent = subjects[id].name;
        select.appendChild(option);
    });
}

// Habits functions
function renderHabits() {
    const today = getTodayDate();
    const dateFormatted = new Date(today).toLocaleDateString('en-IN', {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'});
    document.getElementById('habit-date').textContent = dateFormatted;
    
    if (!habitProgress[today]) {
        habitProgress[today] = {};
    }
    
    // Calculate weekly data for 7-day progress
    const weekDays = [];
    const weekData = [];
    for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        const dayName = date.toLocaleDateString('en-IN', {weekday: 'short'});
        weekDays.push(dayName);
        
        const dayProgress = habitProgress[dateStr] || {};
        const completed = Object.values(dayProgress).filter(v => v).length;
        const percentage = habits.length > 0 ? Math.round((completed / habits.length) * 100) : 0;
        weekData.push(percentage);
    }
    
    // Calculate best/worst days
    const dayStats = {};
    Object.keys(habitProgress).forEach(date => {
        const d = new Date(date);
        const dayName = d.toLocaleDateString('en-IN', {weekday: 'long'});
        const completed = Object.values(habitProgress[date]).filter(v => v).length;
        if (!dayStats[dayName]) dayStats[dayName] = {total: 0, count: 0};
        dayStats[dayName].total += completed;
        dayStats[dayName].count++;
    });
    
    let bestDay = 'N/A';
    let worstDay = 'N/A';
    let bestAvg = 0;
    let worstAvg = 999;
    
    Object.keys(dayStats).forEach(day => {
        const avg = dayStats[day].total / dayStats[day].count;
        if (avg > bestAvg) {
            bestAvg = avg;
            bestDay = day;
        }
        if (avg < worstAvg) {
            worstAvg = avg;
            worstDay = day;
        }
    });
    
    const todayCompleted = Object.values(habitProgress[today] || {}).filter(v => v).length;
    const todayPercentage = habits.length > 0 ? Math.round((todayCompleted / habits.length) * 100) : 0;
    
    // Update motivational message
    const motivationalEl = document.getElementById('habit-motivational-message');
    if (motivationalEl) {
        if (todayPercentage === 100) {
            motivationalEl.textContent = 'üéâ Perfect day! All habits completed!';
        } else if (todayPercentage >= 75) {
            motivationalEl.textContent = 'üî• Amazing progress! Keep going!';
        } else if (todayPercentage >= 50) {
            motivationalEl.textContent = 'üí™ Halfway there! You got this!';
        } else if (todayPercentage > 0) {
            motivationalEl.textContent = '‚ú® Great start! Let\'s build momentum!';
        } else {
            motivationalEl.textContent = 'üåü Ready to make today count?';
        }
    }
    
    // Update overall completion display
    const overallEl = document.getElementById('overall-completion-display');
    if (overallEl) {
        overallEl.textContent = todayPercentage + '%';
    }
    
    // Render stats widgets
    const statsContainer = document.getElementById('habits-stats');
    if (statsContainer) {
        const weeklyAvg = weekData.reduce((a, b) => a + b, 0) / weekData.length;
        
        statsContainer.innerHTML = `
            <div style="background: linear-gradient(135deg, rgba(76, 175, 80, 0.2) 0%, rgba(76, 175, 80, 0.05) 100%); padding: 16px; border-radius: 12px; text-align: center; border: 2px solid rgba(76, 175, 80, 0.3);">
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-bottom: 4px; font-weight: 600;">üåü Best Day</div>
                <div style="font-size: 24px; font-weight: 700; color: var(--color-success);">${bestDay}</div>
                <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 4px;">${bestAvg.toFixed(1)} avg habits</div>
            </div>
            <div style="background: linear-gradient(135deg, rgba(244, 67, 54, 0.15) 0%, rgba(244, 67, 54, 0.05) 100%); padding: 16px; border-radius: 12px; text-align: center; border: 2px solid rgba(244, 67, 54, 0.3);">
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-bottom: 4px; font-weight: 600;">üìà Needs Work</div>
                <div style="font-size: 24px; font-weight: 700; color: var(--color-error);">${worstDay}</div>
                <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 4px;">Focus here!</div>
            </div>
            <div style="background: linear-gradient(135deg, rgba(33, 150, 243, 0.2) 0%, rgba(33, 150, 243, 0.05) 100%); padding: 16px; border-radius: 12px; text-align: center; border: 2px solid rgba(33, 150, 243, 0.3);">
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-bottom: 4px; font-weight: 600;">üìä Weekly Avg</div>
                <div style="font-size: 24px; font-weight: 700; color: var(--color-primary);">${weeklyAvg.toFixed(0)}%</div>
                <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 4px;">Last 7 days</div>
            </div>
            <div style="background: linear-gradient(135deg, rgba(255, 193, 7, 0.2) 0%, rgba(255, 193, 7, 0.05) 100%); padding: 16px; border-radius: 12px; text-align: center; border: 2px solid rgba(255, 193, 7, 0.3);">
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-bottom: 4px; font-weight: 600;">üî• Streak</div>
                <div style="font-size: 24px; font-weight: 700; color: var(--color-warning);">${calculateHabitStreak()} days</div>
                <div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 4px;">Keep it up!</div>
            </div>
        `;
    }
    
    // Render habits list with enhanced styling
    const habitIcons = ['üìö', 'üîÑ', '‚úÖ', 'üìù', 'üìì', 'üßò', 'üìñ'];
    const container = document.getElementById('habits-list');
    container.innerHTML = habits.map((habit, index) => {
        const isChecked = habitProgress[today][index] || false;
        const icon = habitIcons[index] || '‚ú®';
        const bgColor = isChecked ? 'linear-gradient(135deg, rgba(76, 175, 80, 0.2) 0%, rgba(76, 175, 80, 0.05) 100%)' : 'var(--color-surface)';
        const borderColor = isChecked ? 'rgba(76, 175, 80, 0.4)' : 'var(--color-border)';
        
        return `
            <div class="revision-item ${isChecked ? 'completed' : ''}" style="margin-bottom: 12px; background: ${bgColor}; border: 2px solid ${borderColor}; transition: all 0.3s ease; cursor: pointer;" onclick="toggleHabitClick(${index})">
                <input type="checkbox" class="revision-checkbox" 
                    ${isChecked ? 'checked' : ''}
                    onchange="event.stopPropagation(); toggleHabit(${index})">
                <div style="font-size: 28px; margin-right: 12px;">${icon}</div>
                <div class="revision-content" style="flex: 1;">
                    <div class="revision-topic" style="font-size: 16px; font-weight: 600;">${habit}</div>
                    ${isChecked ? '<div style="font-size: 12px; color: var(--color-success); margin-top: 4px; font-weight: 600;">‚úì Completed today!</div>' : '<div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">Click to mark complete</div>'}
                </div>
            </div>
        `;
    }).join('');
    
    // Render 7-day chart
    const canvas = document.getElementById('habits-chart');
    if (canvas) {
        const ctx = canvas.getContext('2d');
        if (window.habitsChartInstance) {
            window.habitsChartInstance.destroy();
        }
        window.habitsChartInstance = new Chart(ctx, {
            type: 'line',
            data: {
                labels: weekDays,
                datasets: [{
                    label: 'Completion %',
                    data: weekData,
                    borderColor: '#4CAF50',
                    backgroundColor: 'rgba(76, 175, 80, 0.2)',
                    tension: 0.4,
                    fill: true,
                    borderWidth: 3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: '#4CAF50',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return 'Completion: ' + context.parsed.y + '%';
                            }
                        }
                    }
                }
            }
        });
    }
    
    updateHabitProgress();
}

function toggleHabitClick(index) {
    toggleHabit(index);
}

function calculateHabitStreak() {
    let streak = 0;
    const today = new Date();
    for (let i = 0; i < 365; i++) {
        const checkDate = new Date(today);
        checkDate.setDate(today.getDate() - i);
        const dateStr = checkDate.toISOString().split('T')[0];
        const dayProgress = habitProgress[dateStr] || {};
        const completed = Object.values(dayProgress).filter(v => v).length;
        if (completed > 0) {
            streak++;
        } else if (i > 0) {
            break;
        }
    }
    return streak;
}

function toggleHabit(index) {
    const today = getTodayDate();
    if (!habitProgress[today]) habitProgress[today] = {};
    const wasChecked = habitProgress[today][index];
    habitProgress[today][index] = !habitProgress[today][index];
    
    if (habitProgress[today][index]) {
        showSuccessToast('‚úÖ Habit Completed!');
        createFirecrackers('habits-list');
    }
    
    saveData();
    renderHabits();
    
    // Check if all habits completed
    const completed = Object.values(habitProgress[today]).filter(v => v).length;
    if (completed === habits.length && !wasChecked) {
        setTimeout(() => {
            showSuccessToast('üéâ All Habits Complete!');
            createFirecrackers('habit-progress-bar');
        }, 500);
    }
}

function updateHabitProgress() {
    const today = getTodayDate();
    const completed = Object.values(habitProgress[today] || {}).filter(v => v).length;
    const total = habits.length;
    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
    
    const bar = document.getElementById('habit-progress-bar');
    bar.style.width = percentage + '%';
    document.getElementById('habit-progress-text').textContent = percentage + '%';
    
    bar.className = 'progress-bar';
    if (percentage >= 75) {
        bar.classList.add('high');
    } else if (percentage >= 50) {
        bar.classList.add('medium');
    } else {
        bar.classList.add('low');
    }
    
    if (percentage === 100) {
        createFirecrackers('habit-progress-bar');
    }
}

// Flashcards functions
function createFlashcard() {
    const front = document.getElementById('flashcard-front').value.trim();
    const back = document.getElementById('flashcard-back').value.trim();
    const category = document.getElementById('flashcard-category').value;
    const color = document.getElementById('flashcard-color').value;
    
    if (!front || !back) {
        alert('‚ö†Ô∏è Please fill both front and back of the flashcard!');
        return;
    }
    
    const newCard = {
        id: Date.now().toString(),
        front: front,
        back: back,
        category: category,
        color: color,
        date: getTodayDate()
    };
    
    flashcardsData.push(newCard);
    saveData();
    document.getElementById('flashcard-front').value = '';
    document.getElementById('flashcard-back').value = '';
    renderFlashcards();
    showSuccessToast('Flashcard Created!');
}

function renderFlashcards() {
    const container = document.getElementById('flashcards-display');
    
    // Populate category dropdown
    const categorySelect = document.getElementById('flashcard-category');
    if (categorySelect && categorySelect.options.length === 0) {
        categorySelect.innerHTML = '<option value="General">General</option>';
        Object.keys(subjects).forEach(id => {
            const option = document.createElement('option');
            option.value = id;
            option.textContent = subjects[id].name;
            categorySelect.appendChild(option);
        });
    }
    
    if (flashcardsData.length === 0) {
        container.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;">No flashcards yet. Create your first one! üé¥</div>';
        return;
    }
    
    container.innerHTML = flashcardsData.map((card, index) => `
        <div style="background: ${card.color}; border-radius: 12px; padding: 16px; min-height: 180px; display: flex; flex-direction: column; cursor: pointer; transition: transform 0.3s ease; border: 2px solid rgba(0,0,0,0.1);" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
            <div style="flex: 1;">
                <div style="font-size: 11px; color: rgba(0,0,0,0.5); margin-bottom: 8px; font-weight: 600;">${card.category}</div>
                <div style="font-weight: 700; color: rgba(0,0,0,0.9); margin-bottom: 12px; font-size: 16px;">${card.front}</div>
                <div style="color: rgba(0,0,0,0.7); font-size: 13px; line-height: 1.4;">${card.back}</div>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(0,0,0,0.1);">
                <div style="font-size: 10px; color: rgba(0,0,0,0.5);">${card.date}</div>
                <button class="btn btn-secondary" style="padding: 4px 10px; font-size: 11px; background: rgba(0,0,0,0.1);" onclick="event.stopPropagation(); deleteFlashcardData(${index})">üóëÔ∏è Delete</button>
            </div>
        </div>
    `).join('');
}

function deleteFlashcardData(index) {
    if (!confirm('‚ö†Ô∏è Delete this flashcard?\n\nThis action cannot be undone!')) {
        return;
    }
    
    flashcardsData.splice(index, 1);
    saveData();
    renderFlashcards();
    showSuccessToast('üóëÔ∏è Flashcard Deleted!');
    createFirecrackers('flashcards-display');
}

function studyModeFlashcards() {
    if (flashcardsData.length === 0) {
        alert('‚ö†Ô∏è Create some flashcards first!');
        return;
    }
    currentStudyIndex = 0;
    isFlashcardFlipped = false;
    showFlashcardModal();
}

function showFlashcardModal() {
    const modal = document.getElementById('flashcard-study-modal');
    modal.classList.add('active');
    displayCurrentFlashcard();
}

function closeStudyMode() {
    const modal = document.getElementById('flashcard-study-modal');
    modal.classList.remove('active');
}

function displayCurrentFlashcard() {
    if (flashcardsData.length === 0) return;
    
    const card = flashcardsData[currentStudyIndex];
    const display = document.getElementById('flashcard-display');
    const text = document.getElementById('flashcard-text');
    const counter = document.getElementById('flashcard-counter');
    
    display.style.background = card.color;
    text.textContent = isFlashcardFlipped ? card.back : card.front;
    counter.textContent = `${currentStudyIndex + 1}/${flashcardsData.length}`;
    
    display.style.transform = 'scale(1)';
}

function flipFlashcard() {
    isFlashcardFlipped = !isFlashcardFlipped;
    const display = document.getElementById('flashcard-display');
    display.style.transform = 'scale(0.95)';
    setTimeout(() => {
        displayCurrentFlashcard();
    }, 150);
}

function nextFlashcard() {
    currentStudyIndex = (currentStudyIndex + 1) % flashcardsData.length;
    isFlashcardFlipped = false;
    displayCurrentFlashcard();
}

function previousFlashcard() {
    currentStudyIndex = (currentStudyIndex - 1 + flashcardsData.length) % flashcardsData.length;
    isFlashcardFlipped = false;
    displayCurrentFlashcard();
}

function addQuickNote() {
    const title = document.getElementById('note-title').value.trim();
    const content = document.getElementById('note-content').value.trim();
    const color = document.getElementById('note-color').value;
    
    if (!title || !content) {
        alert('‚ö†Ô∏è Please enter both title and content!');
        return;
    }
    
    quickNotes.unshift({
        title: title,
        content: content,
        color: color,
        date: getTodayDate(),
        pinned: false
    });
    
    saveData();
    document.getElementById('note-title').value = '';
    document.getElementById('note-content').value = '';
    renderQuickNotes();
    showSuccessToast('Note Saved!');
}

function renderQuickNotes() {
    const container = document.getElementById('quick-notes-list');
    
    if (quickNotes.length === 0) {
        container.innerHTML = '<div class="empty-state">No quick notes yet. Create your first one! üìù</div>';
        return;
    }
    
    container.innerHTML = quickNotes.map((note, index) => `
        <div class="journal-entry" style="background: ${note.color}; margin-bottom: 12px; ${note.pinned ? 'border: 2px solid var(--color-primary);' : ''}">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div style="flex: 1;">
                    ${note.pinned ? '<div style="color: var(--color-primary); font-size: 12px; font-weight: 600; margin-bottom: 4px;">üìå Pinned</div>' : ''}
                    <div style="font-weight: bold; color: var(--color-text); margin-bottom: 8px;">${note.title}</div>
                    <div style="color: var(--color-text-secondary); font-size: 14px; line-height: 1.5;">${note.content}</div>
                    <div style="color: var(--color-text-secondary); font-size: 12px; margin-top: 8px;">${note.date}</div>
                </div>
                <div style="display: flex; gap: 4px;">
                    <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" onclick="togglePinNote(${index})">${note.pinned ? 'üìå' : 'üìç'}</button>
                    <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" onclick="deleteQuickNote(${index})">üóëÔ∏è</button>
                </div>
            </div>
        </div>
    `).join('');
}

function togglePinNote(index) {
    quickNotes[index].pinned = !quickNotes[index].pinned;
    quickNotes.sort((a, b) => (b.pinned ? 1 : 0) - (a.pinned ? 1 : 0));
    saveData();
    renderQuickNotes();
}

function deleteQuickNote(index) {
    if (!confirm('‚ö†Ô∏è Delete this note?\n\nThis action cannot be undone!')) {
        return;
    }
    
    quickNotes.splice(index, 1);
    saveData();
    renderQuickNotes();
    showSuccessToast('üóëÔ∏è Note Deleted!');
    createFirecrackers('quick-notes-list');
}



// Goals functions
function renderGoals() {
    document.getElementById('daily-goal').value = studyGoals.daily;
    document.getElementById('weekly-goal').value = studyGoals.weekly;
    document.getElementById('monthly-goal').value = studyGoals.monthly;
    updateGoalsDisplay();
    renderWeeklyReport();
}

function updateGoals() {
    studyGoals.daily = parseInt(document.getElementById('daily-goal').value) || 2;
    studyGoals.weekly = parseInt(document.getElementById('weekly-goal').value) || 14;
    studyGoals.monthly = parseInt(document.getElementById('monthly-goal').value) || 60;
    saveData();
    updateGoalsDisplay();
}

function setGoalTemplate(level) {
    if (level === 'beginner') {
        studyGoals = {daily: 2, weekly: 14, monthly: 60};
    } else if (level === 'intermediate') {
        studyGoals = {daily: 4, weekly: 28, monthly: 120};
    } else if (level === 'advanced') {
        studyGoals = {daily: 6, weekly: 42, monthly: 180};
    }
    document.getElementById('daily-goal').value = studyGoals.daily;
    document.getElementById('weekly-goal').value = studyGoals.weekly;
    document.getElementById('monthly-goal').value = studyGoals.monthly;
    saveData();
    updateGoalsDisplay();
    showSuccessToast('Goal Template Set!');
}

function updateGoalsDisplay() {
    const today = getTodayDate();
    let todayHours = 0;
    let weekHours = 0;
    let monthHours = 0;
    
    // Calculate today's hours
    studySessions.forEach(session => {
        if (session.date === today) {
            todayHours += session.minutes / 60;
        }
    });
    
    // Calculate week's hours
    for (let i = 0; i < 7; i++) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        studySessions.forEach(session => {
            if (session.date === dateStr) {
                weekHours += session.minutes / 60;
            }
        });
    }
    
    // Calculate month's hours
    for (let i = 0; i < 30; i++) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        studySessions.forEach(session => {
            if (session.date === dateStr) {
                monthHours += session.minutes / 60;
            }
        });
    }
    
    // Daily goal
    const dailyPercentage = Math.min(100, Math.round((todayHours / studyGoals.daily) * 100));
    document.getElementById('daily-progress-display').textContent = dailyPercentage + '%';
    const dailyBar = document.getElementById('daily-goal-bar');
    dailyBar.style.width = dailyPercentage + '%';
    dailyBar.className = 'progress-bar';
    if (dailyPercentage >= 100) dailyBar.classList.add('high');
    else if (dailyPercentage >= 75) dailyBar.classList.add('medium');
    else dailyBar.classList.add('low');
    
    const dailyMotivational = document.getElementById('daily-motivational');
    if (dailyMotivational) {
        if (dailyPercentage >= 100) dailyMotivational.textContent = 'üéâ Goal crushed! Amazing work!';
        else if (dailyPercentage >= 75) dailyMotivational.textContent = 'üî• Almost there! Keep going!';
        else if (dailyPercentage >= 50) dailyMotivational.textContent = 'üí™ Halfway there! You can do it!';
        else dailyMotivational.textContent = '‚ú® Let\'s get started today!';
    }
    
    // Weekly goal
    const weeklyPercentage = Math.min(100, Math.round((weekHours / studyGoals.weekly) * 100));
    document.getElementById('weekly-progress-display').textContent = weeklyPercentage + '%';
    const weeklyBar = document.getElementById('weekly-goal-bar');
    weeklyBar.style.width = weeklyPercentage + '%';
    weeklyBar.className = 'progress-bar';
    if (weeklyPercentage >= 100) weeklyBar.classList.add('high');
    else if (weeklyPercentage >= 75) weeklyBar.classList.add('medium');
    else weeklyBar.classList.add('low');
    
    const weeklyCountdown = document.getElementById('weekly-countdown');
    if (weeklyCountdown) {
        const remaining = Math.max(0, studyGoals.weekly - weekHours);
        weeklyCountdown.textContent = `${remaining.toFixed(1)} hours remaining this week`;
    }
    
    // Monthly goal
    const monthlyPercentage = Math.min(100, Math.round((monthHours / studyGoals.monthly) * 100));
    document.getElementById('monthly-progress-display').textContent = monthlyPercentage + '%';
    const monthlyBar = document.getElementById('monthly-goal-bar');
    monthlyBar.style.width = monthlyPercentage + '%';
    monthlyBar.className = 'progress-bar';
    if (monthlyPercentage >= 100) monthlyBar.classList.add('high');
    else if (monthlyPercentage >= 75) monthlyBar.classList.add('medium');
    else monthlyBar.classList.add('low');
    
    const monthlyStreak = document.getElementById('monthly-streak');
    if (monthlyStreak) {
        const daysStudied = new Set(studySessions.map(s => s.date)).size;
        monthlyStreak.textContent = `üìÖ ${daysStudied} days studied this month`;
    }
    
    // Render goal achievement chart
    renderGoalsLineChart();
    
    // Check for goal completion alerts
    if (dailyPercentage >= 100 && !window.dailyGoalAlerted) {
        window.dailyGoalAlerted = true;
        setTimeout(() => {
            showSuccessToast('üèÜ Daily Goal Achieved!');
            createFirecrackers('daily-goal-bar');
        }, 500);
    }
}

function renderGoalsLineChart() {
    const canvas = document.getElementById('goals-line-chart');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    
    // Prepare data for last 7 days
    const days = [];
    const dailyData = [];
    
    for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        const dayName = date.toLocaleDateString('en-IN', {weekday: 'short'});
        days.push(dayName);
        
        let dayHours = 0;
        studySessions.forEach(session => {
            if (session.date === dateStr) {
                dayHours += session.minutes / 60;
            }
        });
        dailyData.push(dayHours.toFixed(1));
    }
    
    if (window.goalsLineChartInstance) {
        window.goalsLineChartInstance.destroy();
    }
    
    window.goalsLineChartInstance = new Chart(ctx, {
        type: 'line',
        data: {
            labels: days,
            datasets: [{
                label: 'Daily Hours',
                data: dailyData,
                borderColor: '#2196F3',
                backgroundColor: 'rgba(33, 150, 243, 0.1)',
                tension: 0.4,
                fill: true,
                borderWidth: 3
            }, {
                label: 'Daily Goal',
                data: Array(7).fill(studyGoals.daily),
                borderColor: '#4CAF50',
                borderDash: [5, 5],
                borderWidth: 2,
                pointRadius: 0,
                fill: false
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    position: 'top'
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

function renderWeeklyReport() {
    const today = new Date();
    let totalChapters = 0;
    let subjects = new Set();
    
    for (let i = 0; i < 7; i++) {
        const date = new Date(today);
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        
        Object.keys(studyData).forEach(subjectId => {
            Object.values(studyData[subjectId]).forEach(chapter => {
                if (chapter.completed && chapter.dateCovered === dateStr) {
                    totalChapters++;
                    subjects.add(subjectId);
                }
            });
        });
    }
    
    const report = `
        <div style="padding: 12px; background: var(--color-secondary); border-radius: 8px;">
            <div style="margin-bottom: 8px;"><strong>üìä This Week Summary:</strong></div>
            <div style="margin-bottom: 4px;">‚Ä¢ Total Chapters Completed: ${totalChapters}</div>
            <div style="margin-bottom: 4px;">‚Ä¢ Subjects Studied: ${subjects.size}</div>
            <div style="margin-bottom: 4px;">‚Ä¢ Current Streak: ${studyStreak} days</div>
            <div style="margin-bottom: 4px;">‚Ä¢ Estimated Study Time: ${(totalChapters * 0.5).toFixed(1)} hours</div>
        </div>
    `;
    
    document.getElementById('weekly-report').innerHTML = report;
}

function downloadWeeklyReport() {
    const today = new Date();
    let report = 'WEEKLY STUDY REPORT\n';
    report += '===================\n\n';
    report += `Date: ${today.toLocaleDateString('en-IN')}\n\n`;
    
    let totalChapters = 0;
    const subjectProgress = {};
    
    for (let i = 0; i < 7; i++) {
        const date = new Date(today);
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        
        Object.keys(studyData).forEach(subjectId => {
            Object.values(studyData[subjectId]).forEach(chapter => {
                if (chapter.completed && chapter.dateCovered === dateStr) {
                    totalChapters++;
                    subjectProgress[subjectId] = (subjectProgress[subjectId] || 0) + 1;
                }
            });
        });
    }
    
    report += `Total Chapters: ${totalChapters}\n`;
    report += `Study Streak: ${studyStreak} days\n`;
    report += `Estimated Hours: ${(totalChapters * 0.5).toFixed(1)}\n\n`;
    report += 'Subject-wise Progress:\n';
    
    Object.keys(subjectProgress).forEach(subjectId => {
        const subject = subjects[subjectId] || customSubjects[subjectId];
        report += `- ${subject.name}: ${subjectProgress[subjectId]} chapters\n`;
    });
    
    const blob = new Blob([report], {type: 'text/plain'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `study-report-${getTodayDate()}.txt`;
    a.click();
    URL.revokeObjectURL(url);
}

// Streak functions
function updateStudyStreak() {
    const today = getTodayDate();
    
    if (lastStudyDate !== today) {
        const yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);
        const yesterdayStr = yesterday.toISOString().split('T')[0];
        
        if (lastStudyDate === yesterdayStr) {
            studyStreak++;
        } else if (lastStudyDate !== '') {
            studyStreak = 1;
        } else {
            studyStreak = 1;
        }
        
        lastStudyDate = today;
        if (studyStreak > bestStreak) {
            bestStreak = studyStreak;
        }
        saveData();
        updateStreakDisplay();
    }
}

function updateStreakDisplay() {
    const homeStreak = document.getElementById('home-streak-display');
    const homeBest = document.getElementById('home-best-streak');
    if (homeStreak) homeStreak.textContent = studyStreak + ' days';
    if (homeBest) homeBest.textContent = bestStreak;
}

// Badge functions
function checkBadges() {
    let updated = false;
    
    if (!badges[0].unlocked && getTotalCompletedChapters() > 0) {
        badges[0].unlocked = true;
        updated = true;
        setTimeout(() => alert('üéâ Badge Unlocked: ' + badges[0].name + '!'), 500);
    }
    
    if (!badges[1].unlocked && studyStreak >= 7) {
        badges[1].unlocked = true;
        updated = true;
        setTimeout(() => alert('üéâ Badge Unlocked: ' + badges[1].name + '!'), 500);
    }
    
    if (!badges[3].unlocked && studyStreak >= 30) {
        badges[3].unlocked = true;
        updated = true;
        setTimeout(() => alert('üéâ Badge Unlocked: ' + badges[3].name + '!'), 500);
    }
    
    Object.keys(studyData).forEach(subjectId => {
        const subject = subjects[subjectId] || customSubjects[subjectId];
        if (subject && !badges[2].unlocked) {
            const completed = getCompletedCount(subjectId);
            const total = subject.chapters || getChapterCount(subjectId);
            if (completed >= total && total > 0) {
                badges[2].unlocked = true;
                updated = true;
                setTimeout(() => alert('üéâ Badge Unlocked: ' + badges[2].name + '!'), 500);
            }
        }
    });
    
    const hour = new Date().getHours();
    if (!badges[4].unlocked && hour >= 21) {
        const today = getTodayDate();
        Object.keys(studyData).forEach(subjectId => {
            Object.values(studyData[subjectId]).forEach(chapter => {
                if (chapter.completed && chapter.dateCovered === today) {
                    badges[4].unlocked = true;
                    updated = true;
                }
            });
        });
    }
    
    if (!badges[5].unlocked && hour < 6 && hour >= 0) {
        const today = getTodayDate();
        Object.keys(studyData).forEach(subjectId => {
            Object.values(studyData[subjectId]).forEach(chapter => {
                if (chapter.completed && chapter.dateCovered === today) {
                    badges[5].unlocked = true;
                    updated = true;
                }
            });
        });
    }
    
    if (!badges[6].unlocked && getTotalCompletedChapters() >= 10) {
        badges[6].unlocked = true;
        updated = true;
    }
    
    const today = getTodayDate();
    let todayMinutes = 0;
    studySessions.forEach(session => {
        if (session.date === today) todayMinutes += session.minutes;
    });
    const todayHours = todayMinutes / 60;
    if (!badges[7].unlocked && todayHours >= studyGoals.daily) {
        badges[7].unlocked = true;
        updated = true;
    }
    
    if (!badges[8].unlocked && flashcards.length >= 50) {
        badges[8].unlocked = true;
        updated = true;
    }
    
    const todayCompleted = Object.keys(habitProgress[today] || {}).filter(k => habitProgress[today][k]).length;
    const todayPercentage = habits.length > 0 ? (todayCompleted / habits.length) * 100 : 0;
    if (!badges[9].unlocked && todayPercentage >= 90) {
        badges[9].unlocked = true;
        updated = true;
    }
    
    // Badge 10: Book Worm - Read for 15 minutes daily for 30 days
    if (!badges[10].unlocked) {
        let consecutiveDays = 0;
        for (let i = 0; i < 30; i++) {
            const checkDate = new Date();
            checkDate.setDate(checkDate.getDate() - i);
            const dateStr = checkDate.toISOString().split('T')[0];
            let dayMinutes = 0;
            studySessions.forEach(session => {
                if (session.date === dateStr) dayMinutes += session.minutes;
            });
            if (dayMinutes >= 15) consecutiveDays++;
            else break;
        }
        if (consecutiveDays >= 30) {
            badges[10].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 11: Speed Learner - Complete 5 topics in one day
    if (!badges[11].unlocked) {
        let todayTopics = 0;
        Object.keys(studyData).forEach(subjectId => {
            Object.values(studyData[subjectId]).forEach(chapter => {
                if (chapter.completed && chapter.dateCovered === today) {
                    todayTopics++;
                }
            });
        });
        if (todayTopics >= 5) {
            badges[11].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 12: Scholar - Maintain 90% completion for a month
    if (!badges[12].unlocked) {
        let monthStreak = 0;
        for (let i = 0; i < 30; i++) {
            const checkDate = new Date();
            checkDate.setDate(checkDate.getDate() - i);
            const dateStr = checkDate.toISOString().split('T')[0];
            const dayCompleted = Object.keys(habitProgress[dateStr] || {}).filter(k => habitProgress[dateStr][k]).length;
            const dayPercentage = habits.length > 0 ? (dayCompleted / habits.length) * 100 : 0;
            if (dayPercentage >= 90) monthStreak++;
        }
        if (monthStreak >= 30) {
            badges[12].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 13: Dawn Warrior - Study before 6 AM for 7 consecutive days
    if (!badges[13].unlocked && hour < 6 && hour >= 0) {
        let dawnStreak = 0;
        for (let i = 0; i < 7; i++) {
            const checkDate = new Date();
            checkDate.setDate(checkDate.getDate() - i);
            const dateStr = checkDate.toISOString().split('T')[0];
            const hasEarlyStudy = studySessions.some(s => s.date === dateStr && parseInt(s.time.split(':')[0]) < 6);
            if (hasEarlyStudy) dawnStreak++;
            else break;
        }
        if (dawnStreak >= 7) {
            badges[13].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 14: Midnight Scholar - Study after 11 PM for 7 consecutive days
    if (!badges[14].unlocked && hour >= 23) {
        let midnightStreak = 0;
        for (let i = 0; i < 7; i++) {
            const checkDate = new Date();
            checkDate.setDate(checkDate.getDate() - i);
            const dateStr = checkDate.toISOString().split('T')[0];
            const hasLateStudy = studySessions.some(s => s.date === dateStr && parseInt(s.time.split(':')[0]) >= 23);
            if (hasLateStudy) midnightStreak++;
            else break;
        }
        if (midnightStreak >= 7) {
            badges[14].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 16: Revision Master - Complete all revision tasks for 14 days
    if (!badges[16].unlocked) {
        let revisionStreak = 0;
        for (let i = 0; i < 14; i++) {
            const checkDate = new Date();
            checkDate.setDate(checkDate.getDate() - i);
            const dateStr = checkDate.toISOString().split('T')[0];
            if (habitProgress[dateStr]) {
                const completed = Object.values(habitProgress[dateStr]).filter(v => v).length;
                if (completed === habits.length) revisionStreak++;
            }
        }
        if (revisionStreak >= 14) {
            badges[16].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 17: Note Taker - Write journal entries for 21 consecutive days
    if (!badges[17].unlocked) {
        let journalStreak = 0;
        for (let i = 0; i < 21; i++) {
            const checkDate = new Date();
            checkDate.setDate(checkDate.getDate() - i);
            const dateStr = checkDate.toISOString().split('T')[0];
            if (journalData[dateStr] && journalData[dateStr].trim() !== '') {
                journalStreak++;
            } else break;
        }
        if (journalStreak >= 21) {
            badges[17].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 18: Focused - Complete 20 Pomodoro sessions
    if (!badges[18].unlocked) {
        const pomodoroCount = studySessions.filter(s => s.type === 'pomodoro').length;
        if (pomodoroCount >= 20) {
            badges[18].unlocked = true;
            updated = true;
        }
    }
    
    // Badge 19: Champion - Unlock all other badges
    if (!badges[19].unlocked) {
        const unlockedCount = badges.slice(0, 19).filter(b => b.unlocked).length;
        if (unlockedCount === 19) {
            badges[19].unlocked = true;
            updated = true;
            setTimeout(() => alert('üéâüèÜ CHAMPION BADGE UNLOCKED! You\'ve achieved everything! üèÜüéâ'), 500);
        }
    }
    
    if (updated) {
        saveData();
        updateBadgesDisplay();
    }
}

function getTotalCompletedChapters() {
    let total = 0;
    Object.keys(studyData).forEach(subjectId => {
        total += getCompletedCount(subjectId);
    });
    return total;
}

function updateBadgesDisplay() {
    const container = document.getElementById('home-badges-display');
    if (!container) return;
    
    container.innerHTML = badges.map(badge => `
        <div style="text-align: center; padding: 12px; background: ${badge.unlocked ? 'var(--color-bg-3)' : 'var(--color-secondary)'}; border-radius: 8px; border: 1px solid var(--color-border); ${badge.unlocked ? '' : 'opacity: 0.4;'}">
            <div style="font-size: 32px; margin-bottom: 4px;">${badge.icon}</div>
            <div style="font-size: 12px; font-weight: bold; color: var(--color-text);">${badge.name}</div>
            <div style="font-size: 10px; color: var(--color-text-secondary); margin-top: 4px;">${badge.description}</div>
        </div>
    `).join('');
}

// Dark mode functions
function toggleDarkMode() {
    darkMode = !darkMode;
    saveData();
    applyDarkMode();
}

function applyDarkMode() {
    if (darkMode) {
        document.body.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)';
        document.documentElement.style.setProperty('--color-background', '#1a1a2e');
        document.documentElement.style.setProperty('--color-surface', '#16213e');
        document.documentElement.style.setProperty('--color-text', '#e8e8e8');
        document.documentElement.style.setProperty('--color-text-secondary', '#a8a8a8');
        document.documentElement.style.setProperty('--color-border', 'rgba(255, 255, 255, 0.2)');
        document.documentElement.style.setProperty('--color-card-border', 'rgba(255, 255, 255, 0.1)');
        document.documentElement.style.setProperty('--color-secondary', 'rgba(255, 255, 255, 0.05)');
    } else {
        document.body.style.background = 'linear-gradient(135deg, #E3F2FD 0%, #F3E5F5 100%)';
        document.documentElement.style.setProperty('--color-background', '#E3F2FD');
        document.documentElement.style.setProperty('--color-surface', '#FFFFFF');
        document.documentElement.style.setProperty('--color-text', '#333333');
        document.documentElement.style.setProperty('--color-text-secondary', '#666666');
        document.documentElement.style.setProperty('--color-border', 'rgba(33, 150, 243, 0.3)');
        document.documentElement.style.setProperty('--color-card-border', 'rgba(0, 0, 0, 0.1)');
        document.documentElement.style.setProperty('--color-secondary', '#F0F8FF');
    }
}

// Syllabus Tracker Functions
function renderSyllabusPage() {
    populateSyllabusSubjectDropdown();
    renderSyllabusDisplay();
}

function populateSyllabusSubjectDropdown() {
    const select = document.getElementById('syllabus-subject-select');
    if (!select) return;
    
    select.innerHTML = '<option value="">Select Subject</option>';
    Object.keys(subjects).forEach(id => {
        const option = document.createElement('option');
        option.value = id;
        option.textContent = subjects[id].name;
        select.appendChild(option);
    });
}

function addSyllabus() {
    const subjectId = document.getElementById('syllabus-subject-select').value;
    const topicsText = document.getElementById('syllabus-topics-input').value.trim();
    
    if (!subjectId) {
        alert('‚ö†Ô∏è Please select a subject!');
        return;
    }
    
    if (!topicsText) {
        alert('‚ö†Ô∏è Please enter topics in the format shown!');
        return;
    }
    
    // Parse topics
    const lines = topicsText.split('\n').filter(line => line.trim() !== '');
    const topics = [];
    
    lines.forEach(line => {
        const match = line.match(/^Topic\s*\d+\s*:\s*(.+)$/i);
        if (match) {
            topics.push({
                id: Date.now() + Math.random(),
                name: match[1].trim(),
                completed: false,
                completedDate: null
            });
        } else if (line.includes(':')) {
            const parts = line.split(':');
            topics.push({
                id: Date.now() + Math.random(),
                name: parts[1].trim(),
                completed: false,
                completedDate: null
            });
        }
    });
    
    if (topics.length === 0) {
        alert('‚ö†Ô∏è No valid topics found! Use format:\nTopic 1: Your topic name');
        return;
    }
    
    // Add to existing or create new
    if (!syllabusData[subjectId]) {
        syllabusData[subjectId] = [];
    }
    
    syllabusData[subjectId] = syllabusData[subjectId].concat(topics);
    
    saveData();
    document.getElementById('syllabus-topics-input').value = '';
    renderSyllabusDisplay();
    showSuccessToast(`‚úÖ ${topics.length} Topics Added!`);
    createFirecrackers('syllabus-display-container');
}

function renderSyllabusDisplay() {
    const container = document.getElementById('syllabus-display-container');
    if (!container) return;
    
    const subjectsWithSyllabus = Object.keys(syllabusData).filter(id => syllabusData[id] && syllabusData[id].length > 0);
    
    if (subjectsWithSyllabus.length === 0) {
        container.innerHTML = '<div class="empty-state">No syllabus added yet. Add your first syllabus above! üìö</div>';
        return;
    }
    
    container.innerHTML = subjectsWithSyllabus.map(subjectId => {
        const subject = subjects[subjectId];
        const topics = syllabusData[subjectId];
        const completed = topics.filter(t => t.completed).length;
        const total = topics.length;
        const percentage = Math.round((completed / total) * 100);
        
        const showBreakdown = syllabusBreakdownVisible[subjectId] || false;
        
        return `
            <div class="analytics-card" style="margin-bottom: 20px; background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, rgba(6, 182, 212, 0.05) 100%);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h3 style="margin: 0; color: var(--color-primary); font-size: 20px;">${subject.name}</h3>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-secondary" onclick="toggleBreakdown('${subjectId}')" style="padding: 6px 12px; font-size: 12px;">üìä ${showBreakdown ? 'Hide' : 'Show'} Breakdown</button>
                        <button class="btn btn-secondary" onclick="editSyllabus('${subjectId}')" style="padding: 6px 12px; font-size: 12px;">‚úèÔ∏è Edit</button>
                        <button class="btn btn-secondary" onclick="deleteSyllabus('${subjectId}')" style="padding: 6px 12px; font-size: 12px; background: var(--color-error); color: white;">üóëÔ∏è Delete</button>
                    </div>
                </div>
                
                <div style="margin-bottom: 16px;">
                    <div style="font-size: 14px; color: var(--color-text-secondary); margin-bottom: 8px;">${completed} of ${total} Topics Completed (${percentage}%)</div>
                    <div class="progress-bar-container" style="height: 32px;">
                        <div class="progress-bar ${percentage >= 75 ? 'high' : percentage >= 50 ? 'medium' : 'low'}" id="syllabus-bar-${subjectId}" style="width: ${percentage}%;"></div>
                        <div class="progress-text">${percentage}%</div>
                    </div>
                </div>
                
                ${showBreakdown ? renderBreakdownView(subjectId, topics, completed, total, percentage) : ''}
                
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 16px; margin-top: 16px;" id="syllabus-topics-${subjectId}">
                    ${topics.map((topic, index) => renderSyllabusTopic(subjectId, topic, index)).join('')}
                </div>
            </div>
        `;
    }).join('');
}

function renderBreakdownView(subjectId, topics, completed, total, percentage) {
    const pending = total - completed;
    const lastUpdated = topics.filter(t => t.completedDate).sort((a, b) => new Date(b.completedDate) - new Date(a.completedDate))[0];
    const lastDate = lastUpdated ? lastUpdated.completedDate : 'N/A';
    
    return `
        <div style="background: var(--color-bg-1); padding: 20px; border-radius: 12px; margin-bottom: 16px; border: 2px solid var(--color-primary);">
            <h4 style="color: var(--color-primary); margin-bottom: 16px; font-size: 18px;">üìä Detailed Breakdown</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
                <div style="text-align: center; padding: 16px; background: var(--color-surface); border-radius: 8px; border: 1px solid var(--color-border);">
                    <div style="font-size: 32px; font-weight: 700; color: var(--color-primary);">${total}</div>
                    <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">Total Topics</div>
                </div>
                <div style="text-align: center; padding: 16px; background: var(--color-surface); border-radius: 8px; border: 1px solid var(--color-border);">
                    <div style="font-size: 32px; font-weight: 700; color: var(--color-success);">${completed}</div>
                    <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">‚úÖ Completed</div>
                </div>
                <div style="text-align: center; padding: 16px; background: var(--color-surface); border-radius: 8px; border: 1px solid var(--color-border);">
                    <div style="font-size: 32px; font-weight: 700; color: var(--color-error);">${pending}</div>
                    <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">‚è≥ Pending</div>
                </div>
                <div style="text-align: center; padding: 16px; background: var(--color-surface); border-radius: 8px; border: 1px solid var(--color-border);">
                    <div style="font-size: 32px; font-weight: 700; color: ${percentage >= 75 ? 'var(--color-success)' : percentage >= 50 ? 'var(--color-warning)' : 'var(--color-error)'}">${percentage}%</div>
                    <div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">üìà Progress</div>
                </div>
            </div>
            <div style="margin-top: 16px; padding: 12px; background: var(--color-surface); border-radius: 8px; text-align: center; border: 1px solid var(--color-border);">
                <div style="font-size: 12px; color: var(--color-text-secondary);">üìÖ Last Updated</div>
                <div style="font-size: 16px; font-weight: 600; color: var(--color-text); margin-top: 4px;">${lastDate}</div>
            </div>
        </div>
    `;
}

function renderSyllabusTopic(subjectId, topic, index) {
    const strikethrough = topic.completed ? 'text-decoration: line-through; text-decoration-color: #F44336; text-decoration-thickness: 3px; color: var(--color-text-secondary);' : '';
    const bgColor = topic.completed ? 'rgba(76, 175, 80, 0.1)' : 'var(--color-surface)';
    const borderColor = topic.completed ? 'rgba(76, 175, 80, 0.3)' : 'var(--color-border)';
    
    return `
        <div class="syllabus-topic-card" style="background: ${bgColor}; border: 2px solid ${borderColor}; border-radius: 12px; padding: 16px; transition: all 0.3s ease; position: relative; overflow: hidden;">
            <div style="display: flex; align-items: start; gap: 12px;">
                <div style="flex-shrink: 0; width: 32px; height: 32px; background: ${topic.completed ? 'var(--color-success)' : 'var(--color-secondary)'}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; color: ${topic.completed ? 'white' : 'var(--color-text)'}; border: 2px solid ${topic.completed ? 'var(--color-success)' : 'var(--color-border)'}; cursor: pointer;" onclick="toggleSyllabusTopic('${subjectId}', ${index})" title="Click to toggle completion">${index + 1}</div>
                <div style="flex: 1; cursor: pointer;" onclick="toggleSyllabusTopic('${subjectId}', ${index})">
                    <div style="font-weight: 600; font-size: 15px; line-height: 1.5; ${strikethrough}">${topic.name}</div>
                    ${topic.completed ? `<div style="font-size: 11px; color: var(--color-success); margin-top: 6px; font-weight: 600;">‚úì Completed on ${topic.completedDate}</div>` : '<div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 6px;">Click to mark complete</div>'}
                </div>
                <button class="remove-topic-btn" onclick="event.stopPropagation(); removeSyllabusTopic('${subjectId}', ${index})" style="background: none; border: none; color: #ff4444; font-size: 20px; cursor: pointer; padding: 4px 8px; transition: all 0.2s ease; flex-shrink: 0; line-height: 1; font-weight: bold;" onmouseover="this.style.color='#cc0000'; this.style.transform='scale(1.2)'" onmouseout="this.style.color='#ff4444'; this.style.transform='scale(1)'" title="Remove this topic">‚úñÔ∏è</button>
            </div>
        </div>
    `;
}

function toggleSyllabusTopic(subjectId, index) {
    const topic = syllabusData[subjectId][index];
    topic.completed = !topic.completed;
    topic.completedDate = topic.completed ? getTodayDate() : null;
    
    saveData();
    renderSyllabusDisplay();
    
    if (topic.completed) {
        showSuccessToast('‚úÖ Topic Completed!');
        animateProgressBar('syllabus-bar-' + subjectId);
        
        // Check if all completed
        const allCompleted = syllabusData[subjectId].every(t => t.completed);
        if (allCompleted) {
            setTimeout(() => {
                showSuccessToast('üéâ All Topics Complete!');
                createFirecrackers('syllabus-bar-' + subjectId);
            }, 500);
        }
    }
}

function closeDeleteModal() {
    const modal = document.getElementById('delete-confirmation-modal');
    if (modal) modal.classList.remove('active');
}

function createSparkleAnimation(element) {
    const rect = element.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    
    const colors = ['#FFD700', '#FFA500', '#FF69B4', '#00CED1', '#9370DB'];
    
    for (let i = 0; i < 12; i++) {
        setTimeout(() => {
            const sparkle = document.createElement('div');
            sparkle.style.cssText = `
                position: fixed;
                width: 8px;
                height: 8px;
                background: ${colors[Math.floor(Math.random() * colors.length)]};
                border-radius: 50%;
                pointer-events: none;
                z-index: 10000;
                left: ${centerX}px;
                top: ${centerY}px;
            `;
            
            const angle = (Math.PI * 2 * i) / 12;
            const distance = 50 + Math.random() * 50;
            const tx = Math.cos(angle) * distance;
            const ty = Math.sin(angle) * distance;
            
            sparkle.style.setProperty('--tx', tx + 'px');
            sparkle.style.setProperty('--ty', ty + 'px');
            
            document.body.appendChild(sparkle);
            sparkle.style.animation = 'explode 1s ease-out forwards';
            
            setTimeout(() => sparkle.remove(), 1000);
        }, i * 30);
    }
}

function toggleBreakdown(subjectId) {
    syllabusBreakdownVisible[subjectId] = !syllabusBreakdownVisible[subjectId];
    saveData();
    renderSyllabusDisplay();
}

function editSyllabus(subjectId) {
    const subject = subjects[subjectId];
    const topics = syllabusData[subjectId];
    
    const currentTopics = topics.map((t, i) => `Topic ${i + 1}: ${t.name}`).join('\n');
    const newTopicsText = prompt(`‚úèÔ∏è Edit topics for ${subject.name}:\n\nCurrent topics will be shown below. You can:\n‚Ä¢ Edit existing topics\n‚Ä¢ Add new topics at the end\n‚Ä¢ Remove topics by deleting lines\n\nFormat: Topic 1: Your topic name`, currentTopics);
    
    if (newTopicsText === null) return;
    
    const lines = newTopicsText.split('\n').filter(line => line.trim() !== '');
    const newTopics = [];
    
    lines.forEach((line, idx) => {
        const match = line.match(/^Topic\s*\d+\s*:\s*(.+)$/i);
        if (match) {
            const oldTopic = topics[idx];
            newTopics.push({
                id: oldTopic?.id || (Date.now() + Math.random()),
                name: match[1].trim(),
                completed: oldTopic?.completed || false,
                completedDate: oldTopic?.completedDate || null
            });
        } else if (line.includes(':')) {
            const parts = line.split(':');
            const oldTopic = topics[idx];
            newTopics.push({
                id: oldTopic?.id || (Date.now() + Math.random()),
                name: parts[1].trim(),
                completed: oldTopic?.completed || false,
                completedDate: oldTopic?.completedDate || null
            });
        }
    });
    
    if (newTopics.length === 0) {
        alert('‚ö†Ô∏è No valid topics found!');
        return;
    }
    
    syllabusData[subjectId] = newTopics;
    saveData();
    renderSyllabusDisplay();
    showSuccessToast('‚úÖ Syllabus Updated!');
}

function deleteSyllabus(subjectId) {
    const subject = subjects[subjectId];
    const topicCount = syllabusData[subjectId].length;
    
    if (!confirm(`‚ö†Ô∏è Delete ALL syllabus topics for ${subject.name}?\n\nThis will remove all ${topicCount} topics permanently!`)) {
        return;
    }
    
    if (!confirm('‚ö†Ô∏è FINAL WARNING: This action cannot be undone!\n\nAre you absolutely sure?')) {
        return;
    }
    
    delete syllabusData[subjectId];
    delete syllabusBreakdownVisible[subjectId];
    saveData();
    renderSyllabusDisplay();
    showSuccessToast('üóëÔ∏è Syllabus Deleted!');
    createFirecrackers('syllabus-display-container');
}

function removeSyllabusTopic(subjectId, index) {
    const subject = subjects[subjectId];
    const topic = syllabusData[subjectId][index];
    
    // Animate fade out
    const card = event.target.closest('.syllabus-topic-card');
    if (card) {
        card.style.opacity = '0';
        card.style.transform = 'scale(0.8)';
    }
    
    setTimeout(() => {
        // Remove topic from array
        syllabusData[subjectId].splice(index, 1);
        
        // If no topics left, remove the subject entry
        if (syllabusData[subjectId].length === 0) {
            delete syllabusData[subjectId];
            delete syllabusBreakdownVisible[subjectId];
        }
        
        // Save and re-render
        saveData();
        renderSyllabusDisplay();
        showSuccessToast('‚úÖ Topic Removed!');
    }, 300);
}

// Start the app
initApp();

// Show delete functions status on load
setTimeout(() => {
    const deleteFeatures = [
        '‚úÖ Chapter Delete - Working',
        '‚úÖ Syllabus Topic Delete - Working',
        '‚úÖ Syllabus Subject Delete - Working',
        '‚úÖ Quick Note Delete - Working',
        '‚úÖ Flashcard Delete - Working',
        '‚úÖ Journal Entry Delete - Working',
        '‚úÖ Study Session Delete - Working',
        '‚úÖ Clear All Data - Working',
        '‚úÖ Factory Reset - Working'
    ];
    
    console.log('%cüöÄ DELETE OPERATIONS STATUS', 'font-size: 20px; font-weight: bold; color: #4CAF50;');
    console.log('%c========================================', 'color: #2196F3;');
    deleteFeatures.forEach(feature => {
        console.log('%c' + feature, 'color: #4CAF50; font-size: 14px;');
    });
    console.log('%c========================================', 'color: #2196F3;');
    console.log('%cAll delete operations are functional!', 'font-size: 16px; font-weight: bold; color: #FF9800;');
    console.log('%cTest each function by:', 'color: #666; font-size: 12px;');
    console.log('%c1. Adding items to each section', 'color: #666; font-size: 12px;');
    console.log('%c2. Clicking the delete button', 'color: #666; font-size: 12px;');
    console.log('%c3. Confirming the deletion', 'color: #666; font-size: 12px;');
    console.log('%c4. Verifying the item is removed', 'color: #666; font-size: 12px;');
}, 1000);
    </script>


<!-- AUTO-BACKUP FEATURE - ADDITION ONLY -->
<script>
// Auto-backup enhancement - runs silently in background
(function() {
    'use strict';

    // Auto-save backup to localStorage when data changes
    const originalSaveData = window.saveData;
    if (typeof originalSaveData === 'function') {
        window.saveData = function() {
            // Call original saveData first
            originalSaveData.apply(this, arguments);

            // Then save backup to localStorage
            try {
                const backupData = {
                    studyData, journalData, studyStreak, bestStreak, lastStudyDate,
                    habits, habitProgress, flashcards, badges, darkMode,
                    studyGoals, pomodoroSettings, dailyStudyTime, studySessions,
                    subjectNames, customRevisionTopics, demoRevisionTasks, lastRevisionResetDate,
                    quickNotes, flashcardsData, habitWeeklyData, undoHistory,
                    userSettings, syllabusData, syllabusBreakdownVisible, customSubjects,
                    _backupDate: new Date().toISOString()
                };
                localStorage.setItem('study-tracker-auto-backup', JSON.stringify(backupData));
                console.log('‚úÖ Auto-backup saved');
            } catch (e) {
                console.warn('Auto-backup failed:', e);
            }
        };
    }

    // Auto-restore backup on page load (if within 7 days)
    function autoRestore() {
        try {
            const backup = localStorage.getItem('study-tracker-auto-backup');
            if (!backup) return;

            const data = JSON.parse(backup);
            const backupDate = new Date(data._backupDate);
            const now = new Date();
            const daysDiff = (now - backupDate) / (1000 * 60 * 60 * 24);

            // Only restore if backup is less than 7 days old
            if (daysDiff > 7) {
                console.log('Auto-backup too old, skipping');
                return;
            }

            // Restore all data
            if (data.studyData) studyData = data.studyData;
            if (data.journalData) journalData = data.journalData;
            if (data.studyStreak !== undefined) studyStreak = data.studyStreak;
            if (data.bestStreak !== undefined) bestStreak = data.bestStreak;
            if (data.lastStudyDate) lastStudyDate = data.lastStudyDate;
            if (data.habits) habits = data.habits;
            if (data.habitProgress) habitProgress = data.habitProgress;
            if (data.flashcards) flashcards = data.flashcards;
            if (data.badges) badges = data.badges;
            if (data.darkMode !== undefined) darkMode = data.darkMode;
            if (data.studyGoals) studyGoals = data.studyGoals;
            if (data.pomodoroSettings) pomodoroSettings = data.pomodoroSettings;
            if (data.dailyStudyTime) dailyStudyTime = data.dailyStudyTime;
            if (data.studySessions) studySessions = data.studySessions;
            if (data.subjectNames) subjectNames = data.subjectNames;
            if (data.customRevisionTopics) customRevisionTopics = data.customRevisionTopics;
            if (data.demoRevisionTasks) demoRevisionTasks = data.demoRevisionTasks;
            if (data.lastRevisionResetDate) lastRevisionResetDate = data.lastRevisionResetDate;
            if (data.quickNotes) quickNotes = data.quickNotes;
            if (data.flashcardsData) flashcardsData = data.flashcardsData;
            if (data.habitWeeklyData) habitWeeklyData = data.habitWeeklyData;
            if (data.undoHistory) undoHistory = data.undoHistory;
            if (data.userSettings) userSettings = data.userSettings;
            if (data.syllabusData) syllabusData = data.syllabusData;
            if (data.syllabusBreakdownVisible !== undefined) syllabusBreakdownVisible = data.syllabusBreakdownVisible;
            if (data.customSubjects) customSubjects = data.customSubjects;

            console.log('‚úÖ Auto-backup restored from', backupDate.toLocaleDateString());
        } catch (e) {
            console.warn('Auto-restore failed:', e);
        }
    }

        // Run auto-restore after a short delay to let page initialize
setTimeout(() => {
    autoRestore();
    // Immediately apply restored subject names to subjects for display
    if (subjectNames) {
        Object.keys(subjectNames).forEach(id => {
            if (subjects[id]) {
                subjects[id].name = subjectNames[id];
            }
        });
        // Optional: message for debugging
        console.log('‚úÖ Subject names applied:', Object.keys(subjectNames).length, 'subjects');
    }
}, 1000);

console.log('‚úÖ Auto-backup feature loaded');

})();

</script>
<!-- END AUTO-BACKUP FEATURE -->

</body>
</html>